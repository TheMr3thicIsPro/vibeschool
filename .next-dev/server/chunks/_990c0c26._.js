module.exports=[17374,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={ActionDidNotRevalidate:function(){return o},ActionDidRevalidateDynamicOnly:function(){return i},ActionDidRevalidateStaticAndDynamic:function(){return n}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let o=0,n=1,i=2},30240,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={MutableRequestCookiesAdapter:function(){return h},ReadonlyRequestCookiesError:function(){return l},RequestCookiesAdapter:function(){return d},appendMutableCookies:function(){return f},areCookiesMutableInCurrentPhase:function(){return b},createCookiesWithMutableAccessCheck:function(){return g},getModifiedCookieValues:function(){return p},responseCookiesToRequestCookies:function(){return M}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let o=e.r(472),n=e.r(30759),i=e.r(56704),c=e.r(17374);class l extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#options")}static callable(){throw new l}}class d{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return l.callable;default:return n.ReflectAdapter.get(e,t,r)}}})}}let u=Symbol.for("next.mutated.cookies");function p(e){let t=e[u];return t&&Array.isArray(t)&&0!==t.length?t:[]}function f(e,t){let r=p(t);if(0===r.length)return!1;let s=new o.ResponseCookies(e),a=s.getAll();for(let e of r)s.set(e);for(let e of a)s.set(e);return!0}class h{static wrap(e,t){let r=new o.ResponseCookies(new Headers);for(let t of e.getAll())r.set(t);let s=[],a=new Set,l=()=>{let e=i.workAsyncStorage.getStore();if(e&&(e.pathWasRevalidated=c.ActionDidRevalidateStaticAndDynamic),s=r.getAll().filter(e=>a.has(e.name)),t){let e=[];for(let t of s){let r=new o.ResponseCookies(new Headers);r.set(t),e.push(r.toString())}t(e)}},d=new Proxy(r,{get(e,t,r){switch(t){case u:return s;case"delete":return function(...t){a.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.delete(...t),d}finally{l()}};case"set":return function(...t){a.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t),d}finally{l()}};default:return n.ReflectAdapter.get(e,t,r)}}});return d}}function g(e){let t=new Proxy(e.mutableCookies,{get(r,s,a){switch(s){case"delete":return function(...s){return m(e,"cookies().delete"),r.delete(...s),t};case"set":return function(...s){return m(e,"cookies().set"),r.set(...s),t};default:return n.ReflectAdapter.get(r,s,a)}}});return t}function b(e){return"action"===e.phase}function m(e,t){if(!b(e))throw new l}function M(e){let t=new o.RequestCookies(new Headers);for(let r of e.getAll())t.set(r);return t}},13884,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return c}});let s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(void 0);if(r&&r.has(e))return r.get(e);var s={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var i=o?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(s,n,i):s[n]=e[n]}return s.default=e,r&&r.set(e,s),s}(e.r(47540));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}let o={current:null},n="function"==typeof s.cache?s.cache:e=>e,i=console.warn;function c(e){return function(...t){i(e(...t))}}n(e=>{try{i(o.current)}finally{o.current=null}})},7460,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"cookies",{enumerable:!0,get:function(){return f}});let s=e.r(30240),a=e.r(472),o=e.r(56704),n=e.r(32319),i=e.r(68665),c=e.r(97573),l=e.r(4642),d=e.r(13884),u=e.r(43824),p=e.r(76414);function f(){let e="cookies",t=o.workAsyncStorage.getStore(),r=n.workUnitAsyncStorage.getStore();if(t){if(r&&"after"===r.phase&&!(0,u.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`cookies()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E843",enumerable:!1,configurable:!0});if(t.forceStatic)return g(s.RequestCookiesAdapter.seal(new a.RequestCookies(new Headers({}))));if(t.dynamicShouldError)throw Object.defineProperty(new c.StaticGenBailoutError(`Route ${t.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`cookies()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E849",enumerable:!1,configurable:!0});if(r)switch(r.type){case"cache":let o=Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E831",enumerable:!1,configurable:!0});throw Error.captureStackTrace(o,f),t.invalidDynamicUsageError??=o,o;case"unstable-cache":throw Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E846",enumerable:!1,configurable:!0});case"prerender":var d=t,b=r;let n=h.get(b);if(n)return n;let m=(0,l.makeHangingPromise)(b.renderSignal,d.route,"`cookies()`");return h.set(b,m),m;case"prerender-client":let M="`cookies`";throw Object.defineProperty(new p.InvariantError(`${M} must not be used within a Client Component. Next.js should be preventing ${M} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,i.postponeWithTracking)(t.route,e,r.dynamicTracking);case"prerender-legacy":return(0,i.throwToInterruptStaticGeneration)(e,t,r);case"prerender-runtime":return(0,i.delayUntilRuntimeStage)(r,g(r.cookies));case"private-cache":return g(r.cookies);case"request":return(0,i.trackDynamicDataInDynamicRender)(r),g((0,s.areCookiesMutableInCurrentPhase)(r)?r.userspaceMutableCookies:r.cookies)}}(0,n.throwForMissingRequestStore)(e)}e.r(18185);let h=new WeakMap;function g(e){let t=h.get(e);if(t)return t;let r=Promise.resolve(e);return h.set(e,r),r}(0,d.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`cookies()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E830",enumerable:!1,configurable:!0})})},36052,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={HeadersAdapter:function(){return i},ReadonlyHeadersError:function(){return n}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let o=e.r(30759);class n extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new n}}class i extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,s){if("symbol"==typeof r)return o.ReflectAdapter.get(t,r,s);let a=r.toLowerCase(),n=Object.keys(e).find(e=>e.toLowerCase()===a);if(void 0!==n)return o.ReflectAdapter.get(t,n,s)},set(t,r,s,a){if("symbol"==typeof r)return o.ReflectAdapter.set(t,r,s,a);let n=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===n);return o.ReflectAdapter.set(t,i??r,s,a)},has(t,r){if("symbol"==typeof r)return o.ReflectAdapter.has(t,r);let s=r.toLowerCase(),a=Object.keys(e).find(e=>e.toLowerCase()===s);return void 0!==a&&o.ReflectAdapter.has(t,a)},deleteProperty(t,r){if("symbol"==typeof r)return o.ReflectAdapter.deleteProperty(t,r);let s=r.toLowerCase(),a=Object.keys(e).find(e=>e.toLowerCase()===s);return void 0===a||o.ReflectAdapter.deleteProperty(t,a)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return n.callable;default:return o.ReflectAdapter.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new i(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,s]of this.entries())e.call(t,s,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}},19971,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"headers",{enumerable:!0,get:function(){return p}});let s=e.r(36052),a=e.r(56704),o=e.r(32319),n=e.r(68665),i=e.r(97573),c=e.r(4642),l=e.r(13884),d=e.r(43824),u=e.r(76414);function p(){let e="headers",t=a.workAsyncStorage.getStore(),r=o.workUnitAsyncStorage.getStore();if(t){if(r&&"after"===r.phase&&!(0,d.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`headers()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E839",enumerable:!1,configurable:!0});if(t.forceStatic)return h(s.HeadersAdapter.seal(new Headers({})));if(r)switch(r.type){case"cache":{let e=Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E833",enumerable:!1,configurable:!0});throw Error.captureStackTrace(e,p),t.invalidDynamicUsageError??=e,e}case"unstable-cache":throw Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E838",enumerable:!1,configurable:!0})}if(t.dynamicShouldError)throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${t.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`headers()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E828",enumerable:!1,configurable:!0});if(r)switch(r.type){case"prerender":var l=t,g=r;let a=f.get(g);if(a)return a;let o=(0,c.makeHangingPromise)(g.renderSignal,l.route,"`headers()`");return f.set(g,o),o;case"prerender-client":let b="`headers`";throw Object.defineProperty(new u.InvariantError(`${b} must not be used within a client component. Next.js should be preventing ${b} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,n.postponeWithTracking)(t.route,e,r.dynamicTracking);case"prerender-legacy":return(0,n.throwToInterruptStaticGeneration)(e,t,r);case"prerender-runtime":return(0,n.delayUntilRuntimeStage)(r,h(r.headers));case"private-cache":return h(r.headers);case"request":return(0,n.trackDynamicDataInDynamicRender)(r),h(r.headers)}}(0,o.throwForMissingRequestStore)(e)}e.r(18185);let f=new WeakMap;function h(e){let t=f.get(e);if(t)return t;let r=Promise.resolve(e);return f.set(e,r),r}(0,l.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`headers()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E836",enumerable:!1,configurable:!0})})},21423,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"draftMode",{enumerable:!0,get:function(){return d}});let s=e.r(32319),a=e.r(56704),o=e.r(68665),n=e.r(13884),i=e.r(97573),c=e.r(65252),l=e.r(76414);function d(){let e=a.workAsyncStorage.getStore(),t=s.workUnitAsyncStorage.getStore();switch((!e||!t)&&(0,s.throwForMissingRequestStore)("draftMode"),t.type){case"prerender-runtime":return(0,o.delayUntilRuntimeStage)(t,u(t.draftMode,e));case"request":return u(t.draftMode,e);case"cache":case"private-cache":case"unstable-cache":let r=(0,s.getDraftModeProviderForCacheScope)(e,t);if(r)return u(r,e);case"prerender":case"prerender-client":case"prerender-ppr":case"prerender-legacy":return u(null,e);default:return t}}function u(e,t){let r=f.get(e??p);return r||Promise.resolve(new h(e))}e.r(30759);let p={},f=new WeakMap;class h{constructor(e){this._provider=e}get isEnabled(){return null!==this._provider&&this._provider.isEnabled}enable(){g("draftMode().enable()",this.enable),null!==this._provider&&this._provider.enable()}disable(){g("draftMode().disable()",this.disable),null!==this._provider&&this._provider.disable()}}function g(e,t){let r=a.workAsyncStorage.getStore(),n=s.workUnitAsyncStorage.getStore();if(r){if((null==n?void 0:n.phase)==="after")throw Object.defineProperty(Error(`Route ${r.route} used "${e}" inside \`after()\`. The enabled status of \`draftMode()\` can be read inside \`after()\` but you cannot enable or disable \`draftMode()\`. See more info here: https://nextjs.org/docs/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E845",enumerable:!1,configurable:!0});if(r.dynamicShouldError)throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${r.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(n)switch(n.type){case"cache":case"private-cache":{let s=Object.defineProperty(Error(`Route ${r.route} used "${e}" inside "use cache". The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E829",enumerable:!1,configurable:!0});throw Error.captureStackTrace(s,t),r.invalidDynamicUsageError??=s,s}case"unstable-cache":throw Object.defineProperty(Error(`Route ${r.route} used "${e}" inside a function cached with \`unstable_cache()\`. The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E844",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":{let t=Object.defineProperty(Error(`Route ${r.route} used ${e} without first calling \`await connection()\`. See more info here: https://nextjs.org/docs/messages/next-prerender-sync-headers`),"__NEXT_ERROR_CODE",{value:"E126",enumerable:!1,configurable:!0});return(0,o.abortAndThrowOnSynchronousRequestDataAccess)(r.route,e,t,n)}case"prerender-client":let s="`draftMode`";throw Object.defineProperty(new l.InvariantError(`${s} must not be used within a Client Component. Next.js should be preventing ${s} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,o.postponeWithTracking)(r.route,e,n.dynamicTracking);case"prerender-legacy":n.revalidate=0;let a=Object.defineProperty(new c.DynamicServerError(`Route ${r.route} couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw r.dynamicUsageDescription=e,r.dynamicUsageStack=a.stack,a;case"request":(0,o.trackDynamicDataInDynamicRender)(n)}}}(0,n.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`draftMode()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E835",enumerable:!1,configurable:!0})})},93458,(e,t,r)=>{t.exports.cookies=e.r(7460).cookies,t.exports.headers=e.r(19971).headers,t.exports.draftMode=e.r(21423).draftMode},4739,(e,t,r)=>{"use strict";let s;Object.defineProperty(r,"__esModule",{value:!0}),r.parseCookie=u,r.parse=u,r.stringifyCookie=function(e,t){let r=t?.encode||encodeURIComponent,s=[];for(let t of Object.keys(e)){let n=e[t];if(void 0===n)continue;if(!a.test(t))throw TypeError(`cookie name is invalid: ${t}`);let i=r(n);if(!o.test(i))throw TypeError(`cookie val is invalid: ${n}`);s.push(`${t}=${i}`)}return s.join("; ")},r.stringifySetCookie=p,r.serialize=p,r.parseSetCookie=function(e,t){let r=t?.decode||b,s=e.length,a=f(e,0,s),o=h(e,0,a),n=-1===o?{name:"",value:r(g(e,0,a))}:{name:g(e,0,o),value:r(g(e,o+1,a))},i=a+1;for(;i<s;){let t=f(e,i,s),r=h(e,i,t),a=-1===r?g(e,i,t):g(e,i,r),o=-1===r?void 0:g(e,r+1,t);switch(a.toLowerCase()){case"httponly":n.httpOnly=!0;break;case"secure":n.secure=!0;break;case"partitioned":n.partitioned=!0;break;case"domain":n.domain=o;break;case"path":n.path=o;break;case"max-age":o&&c.test(o)&&(n.maxAge=Number(o));break;case"expires":if(!o)break;let l=new Date(o);Number.isFinite(l.valueOf())&&(n.expires=l);break;case"priority":if(!o)break;let d=o.toLowerCase();("low"===d||"medium"===d||"high"===d)&&(n.priority=d);break;case"samesite":if(!o)break;let u=o.toLowerCase();("lax"===u||"strict"===u||"none"===u)&&(n.sameSite=u)}i=t+1}return n},r.stringifySetCookie=p,r.serialize=p;let a=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,o=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,c=/^-?\d+$/,l=Object.prototype.toString,d=((s=function(){}).prototype=Object.create(null),s);function u(e,t){let r=new d,s=e.length;if(s<2)return r;let a=t?.decode||b,o=0;do{let t=h(e,o,s);if(-1===t)break;let n=f(e,o,s);if(t>n){o=e.lastIndexOf(";",t-1)+1;continue}let i=g(e,o,t);void 0===r[i]&&(r[i]=a(g(e,t+1,n))),o=n+1}while(o<s)return r}function p(e,t,r){let s="object"==typeof e?e:{...r,name:e,value:String(t)},c=("object"==typeof t?t:r)?.encode||encodeURIComponent;if(!a.test(s.name))throw TypeError(`argument name is invalid: ${s.name}`);let d=s.value?c(s.value):"";if(!o.test(d))throw TypeError(`argument val is invalid: ${s.value}`);let u=s.name+"="+d;if(void 0!==s.maxAge){if(!Number.isInteger(s.maxAge))throw TypeError(`option maxAge is invalid: ${s.maxAge}`);u+="; Max-Age="+s.maxAge}if(s.domain){if(!n.test(s.domain))throw TypeError(`option domain is invalid: ${s.domain}`);u+="; Domain="+s.domain}if(s.path){if(!i.test(s.path))throw TypeError(`option path is invalid: ${s.path}`);u+="; Path="+s.path}if(s.expires){var p;if(p=s.expires,"[object Date]"!==l.call(p)||!Number.isFinite(s.expires.valueOf()))throw TypeError(`option expires is invalid: ${s.expires}`);u+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(u+="; HttpOnly"),s.secure&&(u+="; Secure"),s.partitioned&&(u+="; Partitioned"),s.priority)switch("string"==typeof s.priority?s.priority.toLowerCase():void 0){case"low":u+="; Priority=Low";break;case"medium":u+="; Priority=Medium";break;case"high":u+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${s.priority}`)}if(s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:case"strict":u+="; SameSite=Strict";break;case"lax":u+="; SameSite=Lax";break;case"none":u+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${s.sameSite}`)}return u}function f(e,t,r){let s=e.indexOf(";",t);return -1===s?r:s}function h(e,t,r){let s=e.indexOf("=",t);return s<r?s:-1}function g(e,t,r){let s=t,a=r;do{let t=e.charCodeAt(s);if(32!==t&&9!==t)break}while(++s<a)for(;a>s;){let t=e.charCodeAt(a-1);if(32!==t&&9!==t)break;a--}return e.slice(s,a)}function b(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},42395,(e,t,r)=>{},93948,92984,e=>{"use strict";class t{storageKey="vibeschool-community-data";DEBUG_COMMUNITY="true"===process.env.DEBUG_COMMUNITY;constructor(){this.initStorage()}initStorage(){}getData(){return{profiles:[],friendRequests:[],friends:[],conversations:[],conversationMembers:[],messages:[],blocks:[],reports:[],typingIndicators:{}}}setData(e){}async getProfile(e){let t=this.getData().profiles.find(t=>t.id===e)||null;return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] getProfile",{userId:e,profile:t?"found":"not found"}),t}async updateProfile(e,t){let r=this.getData(),s=r.profiles.findIndex(t=>t.id===e);if(-1!==s)r.profiles[s]={...r.profiles[s],...t,last_seen_at:new Date().toISOString()};else{let s={id:e,username:t.username||"",display_name:t.display_name||"",avatar_url:t.avatar_url,role:t.role||"student",created_at:new Date().toISOString(),last_seen_at:new Date().toISOString(),is_online:!1};r.profiles.push(s)}return this.setData(r),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] updateProfile",{userId:e,data:t}),r.profiles.find(t=>t.id===e)}async searchProfiles(e){let t=this.getData(),r=e.toLowerCase(),s=t.profiles.filter(e=>e.username.toLowerCase().includes(r)||e.display_name.toLowerCase().includes(r));return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] searchProfiles",{query:e,results:s.length}),s}async createFriendRequest(e,t){let r=this.getData(),s={id:crypto.randomUUID(),requester_id:e,addressee_id:t,status:"pending",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return r.friendRequests.push(s),this.setData(r),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] createFriendRequest",{requesterId:e,addresseeId:t,requestId:s.id}),s}async updateFriendRequest(e,t){let r=this.getData(),s=r.friendRequests.findIndex(t=>t.id===e);if(-1!==s){if(r.friendRequests[s].status=t,r.friendRequests[s].updated_at=new Date().toISOString(),"accepted"===t){let e=r.friendRequests[s],t={user_id:e.requester_id,friend_id:e.addressee_id,created_at:new Date().toISOString()},a={user_id:e.addressee_id,friend_id:e.requester_id,created_at:new Date().toISOString()};r.friends.push(t,a)}return this.setData(r),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] updateFriendRequest",{requestId:e,status:t}),r.friendRequests[s]}throw Error("Friend request not found")}async getFriendRequests(e){let t=this.getData().friendRequests.filter(t=>t.addressee_id===e||t.requester_id===e);return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] getFriendRequests",{userId:e,count:t.length}),t}async getFriends(e){let t=this.getData().friends.filter(t=>t.user_id===e);return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] getFriends",{userId:e,count:t.length}),t}async unfriend(e,t){let r=this.getData();r.friends=r.friends.filter(r=>r.user_id!==e||r.friend_id!==t||r.user_id!==t||r.friend_id!==e),this.setData(r),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] unfriend",{userId:e,friendId:t})}async createConversation(e,t,r,s){let a=this.getData(),o={id:crypto.randomUUID(),is_group:e,title:r||(e?"Group Chat":void 0),created_by:t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};a.conversations.push(o);let n={conversation_id:o.id,user_id:t,role:"owner",joined_at:new Date().toISOString()};if(a.conversationMembers.push(n),s){for(let e of s)if(e!==t){let t={conversation_id:o.id,user_id:e,role:"member",joined_at:new Date().toISOString()};a.conversationMembers.push(t)}}return this.setData(a),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] createConversation",{isGroup:e,createdBy:t,title:r,userIds:s,conversationId:o.id}),o}async getConversations(e){let t=this.getData(),r=t.conversationMembers.filter(t=>t.user_id===e).map(e=>e.conversation_id),s=t.conversations.filter(e=>r.includes(e.id));return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] getConversations",{userId:e,count:s.length}),s}async getConversation(e){let t=this.getData().conversations.find(t=>t.id===e)||null;return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] getConversation",{conversationId:e,found:!!t}),t}async addConversationMember(e,t,r="member"){let s=this.getData();if(!s.conversationMembers.find(r=>r.conversation_id===e&&r.user_id===t)){let a={conversation_id:e,user_id:t,role:r,joined_at:new Date().toISOString()};s.conversationMembers.push(a),this.setData(s),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] addConversationMember",{conversationId:e,userId:t,role:r})}}async removeConversationMember(e,t){let r=this.getData();r.conversationMembers=r.conversationMembers.filter(r=>r.conversation_id!==e||r.user_id!==t),this.setData(r),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] removeConversationMember",{conversationId:e,userId:t})}async updateConversation(e,t){let r=this.getData(),s=r.conversations.findIndex(t=>t.id===e);-1!==s&&(r.conversations[s]={...r.conversations[s],...t,updated_at:new Date().toISOString()},this.setData(r),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] updateConversation",{conversationId:e,data:t}))}async createMessage(e){let t=this.getData(),r={...e,id:crypto.randomUUID(),created_at:new Date().toISOString()};return t.messages.push(r),this.setData(t),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] createMessage",{conversationId:e.conversation_id,senderId:e.sender_id,messageId:r.id}),r}async getMessages(e,t=0,r=50){let s=this.getData().messages.filter(t=>t.conversation_id===e&&!t.deleted_at).sort((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()).slice(t,t+r);return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] getMessages",{conversationId:e,offset:t,limit:r,count:s.length}),s}async updateMessage(e,t){let r=this.getData(),s=r.messages.findIndex(t=>t.id===e);if(-1!==s)return r.messages[s].body=t,r.messages[s].edited_at=new Date().toISOString(),this.setData(r),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] updateMessage",{messageId:e,body:t}),r.messages[s];throw Error("Message not found")}async deleteMessage(e){let t=this.getData(),r=t.messages.findIndex(t=>t.id===e);-1!==r&&(t.messages[r].deleted_at=new Date().toISOString(),this.setData(t),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] deleteMessage",{messageId:e}))}async blockUser(e,t){let r=this.getData();if(!r.blocks.find(r=>r.blocker_id===e&&r.blocked_id===t)){let s={blocker_id:e,blocked_id:t,created_at:new Date().toISOString()};r.blocks.push(s),this.setData(r),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] blockUser",{blockerId:e,blockedId:t})}}async unblockUser(e,t){let r=this.getData();r.blocks=r.blocks.filter(r=>r.blocker_id!==e||r.blocked_id!==t),this.setData(r),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] unblockUser",{blockerId:e,blockedId:t})}async isBlocked(e,t){let r=this.getData().blocks.some(r=>r.blocker_id===e&&r.blocked_id===t);return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] isBlocked",{blockerId:e,blockedId:t,isBlocked:r}),r}async reportUser(e,t,r){let s=this.getData(),a={id:crypto.randomUUID(),reporter_id:e,reported_user_id:t,reason:r,created_at:new Date().toISOString()};return s.reports.push(a),this.setData(s),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] reportUser",{reporterId:e,reportedUserId:t,reason:r}),a}async reportMessage(e,t,r){let s=this.getData(),a={id:crypto.randomUUID(),reporter_id:e,message_id:t,reason:r,created_at:new Date().toISOString()};return s.reports.push(a),this.setData(s),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] reportMessage",{reporterId:e,messageId:t,reason:r}),a}setTypingStatus(e,t,r){this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] setTypingStatus",{conversationId:e,userId:t,isTyping:r});let s=this.getData(),a=Date.now(),o=s.typingIndicators[e]||[];if(r){let e=o.findIndex(e=>e.userId===t);e>=0?o[e].timestamp=a:o.push({userId:t,timestamp:a})}else{let e=o.findIndex(e=>e.userId===t);e>=0&&o.splice(e,1)}s.typingIndicators[e]=o,this.setData(s)}async getTypingUsers(e){let t=this.getData(),r=Date.now()-5e3,s=(t.typingIndicators[e]||[]).filter(e=>e.timestamp>r);t.typingIndicators[e]=s,this.setData(t);let a=s.map(e=>e.userId);return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] getTypingUsers",{conversationId:e,userIds:a}),a}async markAsRead(e,t,r){let s=this.getData(),a=s.conversationMembers.findIndex(r=>r.conversation_id===e&&r.user_id===t);-1!==a&&(s.conversationMembers[a].last_read_at=r,this.setData(s),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] markAsRead",{conversationId:e,userId:t,lastReadAt:r}))}async getUnreadCount(e,t){let r=this.getData(),s=r.conversationMembers.find(r=>r.conversation_id===e&&r.user_id===t),a=new Date(s?.last_read_at?s.last_read_at:0),o=r.messages.filter(r=>r.conversation_id===e&&new Date(r.created_at)>a&&r.sender_id!==t).length;return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][LocalDB] getUnreadCount",{conversationId:e,userId:t,unreadCount:o}),o}}var r=e.i(24389);class s{supabase;DEBUG_COMMUNITY="true"===process.env.DEBUG_COMMUNITY;constructor(){this.supabase=(0,r.createClient)("https://toorbxzuursbcykjujhh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRvb3JieHp1dXJzYmN5a2p1amhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2OTI0NDQsImV4cCI6MjA4MzI2ODQ0NH0.ciBMNKhEpYDQP1g-JjlP_1amlDPccc4YJbJ4LNiOwX8")}async getProfile(e){let{data:t,error:r}=await this.supabase.from("profiles").select("*").eq("id",e).single();return r?(this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] getProfile error",r),null):(this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] getProfile",{userId:e,profile:t?"found":"not found"}),t)}async updateProfile(e,t){let{data:r,error:s}=await this.supabase.from("profiles").update({...t,last_seen_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] updateProfile error",s),s;return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] updateProfile",{userId:e,data:t}),r}async searchProfiles(e){let{data:t,error:r}=await this.supabase.from("profiles").select("*").or(`username.ilike.%${e}%,display_name.ilike.%${e}%`);return r?(this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] searchProfiles error",r),[]):(this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] searchProfiles",{query:e,results:t?.length||0}),t)}async createFriendRequest(e,t){let r={id:crypto.randomUUID(),requester_id:e,addressee_id:t,status:"pending",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:s,error:a}=await this.supabase.from("friend_requests").insert([r]).select().single();if(a)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] createFriendRequest error",a),a;return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] createFriendRequest",{requesterId:e,addresseeId:t,requestId:s.id}),s}async updateFriendRequest(e,t){let{data:r,error:s}=await this.supabase.from("friend_requests").update({status:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] updateFriendRequest error",s),s;if("accepted"===t&&r){let e={user_id:r.requester_id,friend_id:r.addressee_id,created_at:new Date().toISOString()},t={user_id:r.addressee_id,friend_id:r.requester_id,created_at:new Date().toISOString()};await this.supabase.from("friends").insert([e,t])}return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] updateFriendRequest",{requestId:e,status:t}),r}async getFriendRequests(e){let{data:t,error:r}=await this.supabase.from("friend_requests").select("*").or(`requester_id.eq.${e},addressee_id.eq.${e}`);return r?(this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] getFriendRequests error",r),[]):(this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] getFriendRequests",{userId:e,count:t?.length||0}),t)}async getFriends(e){let{data:t,error:r}=await this.supabase.from("friends").select("*").eq("user_id",e);return r?(this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] getFriends error",r),[]):(this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] getFriends",{userId:e,count:t?.length||0}),t)}async unfriend(e,t){await this.supabase.from("friends").delete().or(`(user_id.eq.${e},friend_id.eq.${t}),(user_id.eq.${t},friend_id.eq.${e})`),this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] unfriend",{userId:e,friendId:t})}async createConversation(e,t,r,s){let a={id:crypto.randomUUID(),is_group:e,title:r||(e?"Group Chat":void 0),created_by:t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:o,error:n}=await this.supabase.from("conversations").insert([a]).select().single();if(n)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] createConversation error",n),n;if(await this.supabase.from("conversation_members").insert([{conversation_id:o.id,user_id:t,role:"owner",joined_at:new Date().toISOString()}]),s)for(let e of s)e!==t&&await this.supabase.from("conversation_members").insert([{conversation_id:o.id,user_id:e,role:"member",joined_at:new Date().toISOString()}]);return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] createConversation",{isGroup:e,createdBy:t,title:r,userIds:s,conversationId:o.id}),o}async getConversations(e){let{data:t,error:r}=await this.supabase.from("conversation_members").select("conversation_id").eq("user_id",e);if(r)return this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] getConversations error",r),[];let s=t.map(e=>e.conversation_id),{data:a,error:o}=await this.supabase.from("conversations").select("*").in("id",s);return o?(this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] getConversations error fetching conversations",o),[]):(this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] getConversations",{userId:e,count:a?.length||0}),a)}async getConversation(e){let{data:t,error:r}=await this.supabase.from("conversations").select("*").eq("id",e).single();return r?(this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] getConversation error",r),null):(this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] getConversation",{conversationId:e,found:!!t}),t)}async addConversationMember(e,t,r="member"){let{error:s}=await this.supabase.from("conversation_members").insert([{conversation_id:e,user_id:t,role:r,joined_at:new Date().toISOString()}]);if(s)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] addConversationMember error",s),s;this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] addConversationMember",{conversationId:e,userId:t,role:r})}async removeConversationMember(e,t){let{error:r}=await this.supabase.from("conversation_members").delete().match({conversation_id:e,user_id:t});if(r)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] removeConversationMember error",r),r;this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] removeConversationMember",{conversationId:e,userId:t})}async updateConversation(e,t){let{error:r}=await this.supabase.from("conversations").update({...t,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] updateConversation error",r),r;this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] updateConversation",{conversationId:e,data:t})}async createMessage(e){let t={...e,id:crypto.randomUUID(),created_at:new Date().toISOString()},{data:r,error:s}=await this.supabase.from("messages").insert([t]).select().single();if(s)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] createMessage error",s),s;return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] createMessage",{conversationId:e.conversation_id,senderId:e.sender_id,messageId:r.id}),r}async getMessages(e,t=0,r=50){let{data:s,error:a}=await this.supabase.from("messages").select("*").eq("conversation_id",e).is("deleted_at",null).order("created_at",{ascending:!0}).range(t,t+r-1);return a?(this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] getMessages error",a),[]):(this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] getMessages",{conversationId:e,offset:t,limit:r,count:s?.length||0}),s)}async updateMessage(e,t){let{data:r,error:s}=await this.supabase.from("messages").update({body:t,edited_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] updateMessage error",s),s;return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] updateMessage",{messageId:e,body:t}),r}async deleteMessage(e){let{error:t}=await this.supabase.from("messages").update({deleted_at:new Date().toISOString()}).eq("id",e);if(t)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] deleteMessage error",t),t;this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] deleteMessage",{messageId:e})}async blockUser(e,t){let r={blocker_id:e,blocked_id:t,created_at:new Date().toISOString()},{error:s}=await this.supabase.from("blocks").insert([r]);if(s)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] blockUser error",s),s;this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] blockUser",{blockerId:e,blockedId:t})}async unblockUser(e,t){let{error:r}=await this.supabase.from("blocks").delete().match({blocker_id:e,blocked_id:t});if(r)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] unblockUser error",r),r;this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] unblockUser",{blockerId:e,blockedId:t})}async isBlocked(e,t){let{data:r,error:s}=await this.supabase.from("blocks").select("id").match({blocker_id:e,blocked_id:t}).single();if(s&&"PGRST116"!==s.code)return this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] isBlocked error",s),!1;let a=!!r;return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] isBlocked",{blockerId:e,blockedId:t,isBlocked:a}),a}async reportUser(e,t,r){let s={id:crypto.randomUUID(),reporter_id:e,reported_user_id:t,reason:r,created_at:new Date().toISOString()},{data:a,error:o}=await this.supabase.from("reports").insert([s]).select().single();if(o)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] reportUser error",o),o;return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] reportUser",{reporterId:e,reportedUserId:t,reason:r}),a}async reportMessage(e,t,r){let s={id:crypto.randomUUID(),reporter_id:e,message_id:t,reason:r,created_at:new Date().toISOString()},{data:a,error:o}=await this.supabase.from("reports").insert([s]).select().single();if(o)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] reportMessage error",o),o;return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] reportMessage",{reporterId:e,messageId:t,reason:r}),a}setTypingStatus(e,t,r){this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] setTypingStatus",{conversationId:e,userId:t,isTyping:r})}async getTypingUsers(e){return this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] getTypingUsers",{conversationId:e}),[]}async markAsRead(e,t,r){let{error:s}=await this.supabase.from("conversation_members").update({last_read_at:r}).match({conversation_id:e,user_id:t});if(s)throw this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] markAsRead error",s),s;this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] markAsRead",{conversationId:e,userId:t,lastReadAt:r})}async getUnreadCount(e,t){let{data:r,error:s}=await this.supabase.from("conversation_members").select("last_read_at").match({conversation_id:e,user_id:t}).single();if(s)return this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] getUnreadCount error getting member",s),0;let a=new Date(r?.last_read_at?r.last_read_at:0),{count:o,error:n}=await this.supabase.from("messages").select("*",{count:"exact",head:!0}).eq("conversation_id",e).gt("created_at",a.toISOString()).neq("sender_id",t).is("deleted_at",null);return n?(this.DEBUG_COMMUNITY&&console.error("[COMMUNITY][SupabaseDB] getUnreadCount error getting count",n),0):(this.DEBUG_COMMUNITY&&console.log("[COMMUNITY][SupabaseDB] getUnreadCount",{conversationId:e,userId:t,unreadCount:o}),o||0)}}let a=null,o=async()=>{if(a)return a;let e="true"===process.env.DEBUG_COMMUNITY;try{if((await fetch("https://toorbxzuursbcykjujhh.supabase.co/auth/v1/health")).ok)return e&&console.log("[COMMUNITY] Using SupabaseDB backend"),a=new s}catch(t){e&&console.log("[COMMUNITY] Supabase not reachable, using LocalDB backend")}return e&&console.log("[COMMUNITY] Using LocalDB backend"),a=new t};e.s(["getCommunityDB",0,o],93948);var n=e.i(93458),i=e.i(4739);i.parse,i.serialize;let c={path:"/",sameSite:"lax",httpOnly:!1,maxAge:3456e4},l=/^(.*)[.](0|[1-9][0-9]*)$/;function d(e,t){if(e===t)return!0;let r=e.match(l);return!!r&&r[1]===t}function u(e,t,r){let s=r??3180,a=encodeURIComponent(t);if(a.length<=s)return[{name:e,value:t}];let o=[];for(;a.length>0;){let e=a.slice(0,s),t=e.lastIndexOf("%");t>s-3&&(e=e.slice(0,t));let r="";for(;e.length>0;)try{r=decodeURIComponent(e);break}catch(t){if(t instanceof URIError&&"%"===e.at(-3)&&e.length>3)e=e.slice(0,e.length-3);else throw t}o.push(r),a=a.slice(e.length)}return o.map((t,r)=>({name:`${e}.${r}`,value:t}))}async function p(e,t){let r=await t(e);if(r)return r;let s=[];for(let r=0;;r++){let a=`${e}.${r}`,o=await t(a);if(!o)break;s.push(o)}return s.length>0?s.join(""):null}let f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),h=" 	\n\r=".split(""),g=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<h.length;t+=1)e[h[t].charCodeAt(0)]=-2;for(let t=0;t<f.length;t+=1)e[f[t].charCodeAt(0)]=t;return e})();function b(e){let t=[],r=0,s=0;if(function(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){let t=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127)return t(e);if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(s,t)}}(e,e=>{for(r=r<<8|e,s+=8;s>=6;){let e=r>>s-6&63;t.push(f[e]),s-=6}}),s>0)for(r<<=6-s,s=6;s>=6;){let e=r>>s-6&63;t.push(f[e]),s-=6}return t.join("")}function m(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},s={utf8seq:0,codepoint:0},a=0,o=0;for(let t=0;t<e.length;t+=1){let n=g[e.charCodeAt(t)];if(n>-1)for(a=a<<6|n,o+=6;o>=8;)(function(e,t,r){if(0===t.utf8seq){if(e<=127)return r(e);for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}})(a>>o-8&255,s,r),o-=8;else if(-2===n)continue;else throw Error(`Invalid Base64-URL character "${e.at(t)}" at position ${t}`)}return t.join("")}let M="base64-";async function _({getAll:e,setAll:t,setItems:r,removedItems:s},a){let o=a.cookieEncoding,n=a.cookieOptions??null,i=await e([...r?Object.keys(r):[],...s?Object.keys(s):[]]),l=i?.map(({name:e})=>e)||[],p=Object.keys(s).flatMap(e=>l.filter(t=>d(t,e))),f=Object.keys(r).flatMap(e=>{let t=new Set(l.filter(t=>d(t,e))),s=r[e];"base64url"===o&&(s=M+b(s));let a=u(e,s);return a.forEach(e=>{t.delete(e.name)}),p.push(...t),a}),h={...c,...n,maxAge:0},g={...c,...n,maxAge:c.maxAge};delete h.name,delete g.name,await t([...p.map(e=>({name:e,value:"",options:h})),...f.map(({name:e,value:t})=>({name:e,value:t,options:g}))])}if(e.i(42395),"undefined"!=typeof process&&process.env?.npm_package_name){let e=process.env.npm_package_name;["@supabase/auth-helpers-nextjs","@supabase/auth-helpers-react","@supabase/auth-helpers-remix","@supabase/auth-helpers-sveltekit"].includes(e)&&console.warn(`
╔════════════════════════════════════════════════════════════════════════════╗
║ ⚠️  IMPORTANT: Package Consolidation Notice                                ║
║                                                                            ║
║ The ${e.padEnd(35)} package name is deprecated.  ║
║                                                                            ║
║ You are now using @supabase/ssr - a unified solution for all frameworks.  ║
║                                                                            ║
║ The auth-helpers packages have been consolidated into @supabase/ssr       ║
║ to provide better maintenance and consistent APIs across frameworks.      ║
║                                                                            ║
║ Please update your package.json to use @supabase/ssr directly:            ║
║   npm uninstall ${e.padEnd(42)} ║
║   npm install @supabase/ssr                                               ║
║                                                                            ║
║ For more information, visit:                                              ║
║ https://supabase.com/docs/guides/auth/server-side                         ║
╚════════════════════════════════════════════════════════════════════════════╝
    `)}async function y(e){console.log("[FRIENDREQ] getUserId called"),console.log("[FRIENDREQ] Supabase enabled, checking session");try{let e=await (0,n.cookies)(),t=function(e,t,s){if(!e||!t)throw Error(`Your project's URL and Key are required to create a Supabase client!

Check your Supabase project's API settings to find these values

https://supabase.com/dashboard/project/_/settings/api`);let{storage:a,getAll:o,setAll:n,setItems:l,removedItems:f}=function(e,t){let r,s,a=e.cookies??null,o=e.cookieEncoding,n={},l={};if(a)if("get"in a){let e=async e=>{let t=e.flatMap(e=>[e,...Array.from({length:5}).map((t,r)=>`${e}.${r}`)]),r=[];for(let e=0;e<t.length;e+=1){let s=await a.get(t[e]);(s||"string"==typeof s)&&r.push({name:t[e],value:s})}return r};if(r=async t=>await e(t),"set"in a&&"remove"in a)s=async e=>{for(let t=0;t<e.length;t+=1){let{name:r,value:s,options:o}=e[t];s?await a.set(r,s,o):await a.remove(r,o)}};else if(t)s=async()=>{console.warn("@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in a)if(r=async()=>await a.getAll(),"setAll"in a)s=a.setAll;else if(t)s=async()=>{console.warn("@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)");else throw Error(`@supabase/ssr: ${t?"createServerClient":"createBrowserClient"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).`);else if(t||1)if(t)throw Error("@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)");else r=()=>[],s=()=>{throw Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")};else r=()=>{let e;return e=(0,i.parse)(document.cookie),Object.keys(e).map(t=>({name:t,value:e[t]??""}))},s=e=>{e.forEach(({name:e,value:t,options:r})=>{document.cookie=(0,i.serialize)(e,t,r)})};return t?{getAll:r,setAll:s,setItems:n,removedItems:l,storage:{isServer:!0,getItem:async e=>{if("string"==typeof n[e])return n[e];if(l[e])return null;let t=await r([e]),s=await p(e,async e=>{let r=t?.find(({name:t})=>t===e)||null;return r?r.value:null});if(!s)return null;let a=s;return"string"==typeof s&&s.startsWith(M)&&(a=m(s.substring(M.length))),a},setItem:async(t,a)=>{t.endsWith("-code-verifier")&&await _({getAll:r,setAll:s,setItems:{[t]:a},removedItems:{}},{cookieOptions:e?.cookieOptions??null,cookieEncoding:o}),n[t]=a,delete l[t]},removeItem:async e=>{delete n[e],l[e]=!0}}}:{getAll:r,setAll:s,setItems:n,removedItems:l,storage:{isServer:!1,getItem:async e=>{let t=await r([e]),s=await p(e,async e=>{let r=t?.find(({name:t})=>t===e)||null;return r?r.value:null});if(!s)return null;let a=s;return s.startsWith(M)&&(a=m(s.substring(M.length))),a},setItem:async(t,a)=>{let n=await r([t]),i=new Set((n?.map(({name:e})=>e)||[]).filter(e=>d(e,t))),l=a;"base64url"===o&&(l=M+b(a));let p=u(t,l);p.forEach(({name:e})=>{i.delete(e)});let f={...c,...e?.cookieOptions,maxAge:0},h={...c,...e?.cookieOptions,maxAge:c.maxAge};delete f.name,delete h.name;let g=[...[...i].map(e=>({name:e,value:"",options:f})),...p.map(({name:e,value:t})=>({name:e,value:t,options:h}))];g.length>0&&await s(g)},removeItem:async t=>{let a=await r([t]),o=(a?.map(({name:e})=>e)||[]).filter(e=>d(e,t)),n={...c,...e?.cookieOptions,maxAge:0};delete n.name,o.length>0&&await s(o.map(e=>({name:e,value:"",options:n})))}}}}({...s,cookieEncoding:s?.cookieEncoding??"base64url"},!0),h=(0,r.createClient)(e,t,{...s,global:{...s?.global,headers:{...s?.global?.headers,"X-Client-Info":"supabase-ssr/0.8.0 createServerClient"}},auth:{...s?.cookieOptions?.name?{storageKey:s.cookieOptions.name}:null,...s?.auth,flowType:"pkce",autoRefreshToken:!1,detectSessionInUrl:!1,persistSession:!0,storage:a,...s?.cookies&&"encode"in s.cookies&&"tokens-only"===s.cookies.encode?{userStorage:s?.auth?.userStorage??function(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}()}:null}});return h.auth.onAuthStateChange(async e=>{(Object.keys(l).length>0||Object.keys(f).length>0)&&("SIGNED_IN"===e||"TOKEN_REFRESHED"===e||"USER_UPDATED"===e||"PASSWORD_RECOVERY"===e||"SIGNED_OUT"===e||"MFA_CHALLENGE_VERIFIED"===e)&&await _({getAll:o,setAll:n,setItems:l,removedItems:f},{cookieOptions:s?.cookieOptions??null,cookieEncoding:s?.cookieEncoding??"base64url"})}),h}("https://toorbxzuursbcykjujhh.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRvb3JieHp1dXJzYmN5a2p1amhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2OTI0NDQsImV4cCI6MjA4MzI2ODQ0NH0.ciBMNKhEpYDQP1g-JjlP_1amlDPccc4YJbJ4LNiOwX8",{cookies:{get:t=>e.get(t)?.value}}),{data:{session:s},error:a}=await t.auth.getSession();if(a)return console.log("[FRIENDREQ] Supabase session error:",a.message),null;if(!s?.user)return console.log("[FRIENDREQ] No Supabase session user found"),null;return console.log("[FRIENDREQ] Found Supabase user:",s.user.id),s.user.id}catch(e){return console.log("[FRIENDREQ] Supabase auth error:",e),null}}e.s(["getUserId",()=>y],92984)}];

//# sourceMappingURL=_990c0c26._.js.map