{"version":3,"sources":["../../../node_modules/next/src/shared/lib/action-revalidation-kind.ts","../../../node_modules/next/src/server/web/spec-extension/adapters/request-cookies.ts","../../../node_modules/next/src/server/create-deduped-by-callsite-server-error-logger.ts","../../../node_modules/next/src/server/request/cookies.ts","../../../node_modules/next/src/server/web/spec-extension/adapters/headers.ts","../../../node_modules/next/src/server/request/headers.ts","../../../node_modules/next/src/server/request/draft-mode.ts","../../../node_modules/next/headers.js","../../../node_modules/cookie/src/index.ts","../../../node_modules/%40supabase/ssr/dist/module/types.js","../../../src/lib/auth/getUserFromRequest.ts","../../../node_modules/%40supabase/ssr/src/utils/chunker.ts","../../../node_modules/%40supabase/ssr/src/cookies.ts","../../../node_modules/%40supabase/ssr/src/createBrowserClient.ts","../../../node_modules/%40supabase/ssr/src/createServerClient.ts","../../../node_modules/%40supabase/ssr/src/utils/helpers.ts","../../../node_modules/%40supabase/ssr/src/utils/index.ts","../../../node_modules/%40supabase/ssr/src/version.ts","../../../node_modules/%40supabase/ssr/src/utils/constants.ts","../../../node_modules/%40supabase/ssr/src/index.ts","../../../src/community/db/SupabaseDB.ts","../../../src/community/db/index.ts","../../../node_modules/%40supabase/ssr/src/utils/base64url.ts","../../../src/community/db/LocalDB.ts"],"sourcesContent":["export type ActionRevalidationKind = 0 | 1 | 2\n\nexport const ActionDidNotRevalidate = 0\nexport const ActionDidRevalidateStaticAndDynamic = 1\nexport const ActionDidRevalidateDynamicOnly = 2\n","import { RequestCookies } from '../cookies'\n\nimport { ResponseCookies } from '../cookies'\nimport { ReflectAdapter } from './reflect'\nimport { workAsyncStorage } from '../../../app-render/work-async-storage.external'\nimport type { RequestStore } from '../../../app-render/work-unit-async-storage.external'\nimport { ActionDidRevalidateStaticAndDynamic } from '../../../../shared/lib/action-revalidation-kind'\n\n/**\n * @internal\n */\nexport class ReadonlyRequestCookiesError extends Error {\n  constructor() {\n    super(\n      'Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#options'\n    )\n  }\n\n  public static callable() {\n    throw new ReadonlyRequestCookiesError()\n  }\n}\n\n// We use this to type some APIs but we don't construct instances directly\nexport type { ResponseCookies }\n\n// The `cookies()` API is a mix of request and response cookies. For `.get()` methods,\n// we want to return the request cookie if it exists. For mutative methods like `.set()`,\n// we want to return the response cookie.\nexport type ReadonlyRequestCookies = Omit<\n  RequestCookies,\n  'set' | 'clear' | 'delete'\n> &\n  Pick<ResponseCookies, 'set' | 'delete'>\n\nexport class RequestCookiesAdapter {\n  public static seal(cookies: RequestCookies): ReadonlyRequestCookies {\n    return new Proxy(cookies as any, {\n      get(target, prop, receiver) {\n        switch (prop) {\n          case 'clear':\n          case 'delete':\n          case 'set':\n            return ReadonlyRequestCookiesError.callable\n          default:\n            return ReflectAdapter.get(target, prop, receiver)\n        }\n      },\n    })\n  }\n}\n\nconst SYMBOL_MODIFY_COOKIE_VALUES = Symbol.for('next.mutated.cookies')\n\nexport function getModifiedCookieValues(\n  cookies: ResponseCookies\n): ResponseCookie[] {\n  const modified: ResponseCookie[] | undefined = (cookies as unknown as any)[\n    SYMBOL_MODIFY_COOKIE_VALUES\n  ]\n  if (!modified || !Array.isArray(modified) || modified.length === 0) {\n    return []\n  }\n\n  return modified\n}\n\ntype SetCookieArgs =\n  | [key: string, value: string, cookie?: Partial<ResponseCookie>]\n  | [options: ResponseCookie]\n\nexport function appendMutableCookies(\n  headers: Headers,\n  mutableCookies: ResponseCookies\n): boolean {\n  const modifiedCookieValues = getModifiedCookieValues(mutableCookies)\n  if (modifiedCookieValues.length === 0) {\n    return false\n  }\n\n  // Return a new response that extends the response with\n  // the modified cookies as fallbacks. `res` cookies\n  // will still take precedence.\n  const resCookies = new ResponseCookies(headers)\n  const returnedCookies = resCookies.getAll()\n\n  // Set the modified cookies as fallbacks.\n  for (const cookie of modifiedCookieValues) {\n    resCookies.set(cookie)\n  }\n\n  // Set the original cookies as the final values.\n  for (const cookie of returnedCookies) {\n    resCookies.set(cookie)\n  }\n\n  return true\n}\n\ntype ResponseCookie = NonNullable<\n  ReturnType<InstanceType<typeof ResponseCookies>['get']>\n>\n\nexport class MutableRequestCookiesAdapter {\n  public static wrap(\n    cookies: RequestCookies,\n    onUpdateCookies?: (cookies: string[]) => void\n  ): ResponseCookies {\n    const responseCookies = new ResponseCookies(new Headers())\n    for (const cookie of cookies.getAll()) {\n      responseCookies.set(cookie)\n    }\n\n    let modifiedValues: ResponseCookie[] = []\n    const modifiedCookies = new Set<string>()\n    const updateResponseCookies = () => {\n      // TODO-APP: change method of getting workStore\n      const workStore = workAsyncStorage.getStore()\n      if (workStore) {\n        workStore.pathWasRevalidated = ActionDidRevalidateStaticAndDynamic\n      }\n\n      const allCookies = responseCookies.getAll()\n      modifiedValues = allCookies.filter((c) => modifiedCookies.has(c.name))\n      if (onUpdateCookies) {\n        const serializedCookies: string[] = []\n        for (const cookie of modifiedValues) {\n          const tempCookies = new ResponseCookies(new Headers())\n          tempCookies.set(cookie)\n          serializedCookies.push(tempCookies.toString())\n        }\n\n        onUpdateCookies(serializedCookies)\n      }\n    }\n\n    const wrappedCookies = new Proxy(responseCookies, {\n      get(target, prop, receiver) {\n        switch (prop) {\n          // A special symbol to get the modified cookie values\n          case SYMBOL_MODIFY_COOKIE_VALUES:\n            return modifiedValues\n\n          // TODO: Throw error if trying to set a cookie after the response\n          // headers have been set.\n          case 'delete':\n            return function (...args: [string] | [ResponseCookie]) {\n              modifiedCookies.add(\n                typeof args[0] === 'string' ? args[0] : args[0].name\n              )\n              try {\n                target.delete(...args)\n                return wrappedCookies\n              } finally {\n                updateResponseCookies()\n              }\n            }\n          case 'set':\n            return function (...args: SetCookieArgs) {\n              modifiedCookies.add(\n                typeof args[0] === 'string' ? args[0] : args[0].name\n              )\n              try {\n                target.set(...args)\n                return wrappedCookies\n              } finally {\n                updateResponseCookies()\n              }\n            }\n\n          default:\n            return ReflectAdapter.get(target, prop, receiver)\n        }\n      },\n    })\n\n    return wrappedCookies\n  }\n}\n\nexport function createCookiesWithMutableAccessCheck(\n  requestStore: RequestStore\n): ResponseCookies {\n  const wrappedCookies = new Proxy(requestStore.mutableCookies, {\n    get(target, prop, receiver) {\n      switch (prop) {\n        case 'delete':\n          return function (...args: [string] | [ResponseCookie]) {\n            ensureCookiesAreStillMutable(requestStore, 'cookies().delete')\n            target.delete(...args)\n            return wrappedCookies\n          }\n        case 'set':\n          return function (...args: SetCookieArgs) {\n            ensureCookiesAreStillMutable(requestStore, 'cookies().set')\n            target.set(...args)\n            return wrappedCookies\n          }\n\n        default:\n          return ReflectAdapter.get(target, prop, receiver)\n      }\n    },\n  })\n  return wrappedCookies\n}\n\nexport function areCookiesMutableInCurrentPhase(requestStore: RequestStore) {\n  return requestStore.phase === 'action'\n}\n\n/** Ensure that cookies() starts throwing on mutation\n * if we changed phases and can no longer mutate.\n *\n * This can happen when going:\n *   'render' -> 'after'\n *   'action' -> 'render'\n * */\nfunction ensureCookiesAreStillMutable(\n  requestStore: RequestStore,\n  _callingExpression: string\n) {\n  if (!areCookiesMutableInCurrentPhase(requestStore)) {\n    // TODO: maybe we can give a more precise error message based on callingExpression?\n    throw new ReadonlyRequestCookiesError()\n  }\n}\n\nexport function responseCookiesToRequestCookies(\n  responseCookies: ResponseCookies\n): RequestCookies {\n  const requestCookies = new RequestCookies(new Headers())\n  for (const cookie of responseCookies.getAll()) {\n    requestCookies.set(cookie)\n  }\n  return requestCookies\n}\n","import * as React from 'react'\n\nconst errorRef: { current: null | Error } = { current: null }\n\n// React.cache is currently only available in canary/experimental React channels.\nconst cache =\n  typeof React.cache === 'function'\n    ? React.cache\n    : (fn: (key: unknown) => void) => fn\n\n// When Cache Components is enabled, we record these as errors so that they\n// are captured by the dev overlay as it's more critical to fix these\n// when enabled.\nconst logErrorOrWarn = process.env.__NEXT_CACHE_COMPONENTS\n  ? console.error\n  : console.warn\n\n// We don't want to dedupe across requests.\n// The developer might've just attempted to fix the warning so we should warn again if it still happens.\nconst flushCurrentErrorIfNew = cache(\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars -- cache key\n  (key: unknown) => {\n    try {\n      logErrorOrWarn(errorRef.current)\n    } finally {\n      errorRef.current = null\n    }\n  }\n)\n\n/**\n * Creates a function that logs an error message that is deduped by the userland\n * callsite.\n * This requires no indirection between the call of this function and the userland\n * callsite i.e. there's only a single library frame above this.\n * Do not use on the Client where sourcemaps and ignore listing might be enabled.\n * Only use that for warnings need a fix independent of the callstack.\n *\n * @param getMessage\n * @returns\n */\nexport function createDedupedByCallsiteServerErrorLoggerDev<Args extends any[]>(\n  getMessage: (...args: Args) => Error\n) {\n  return function logDedupedError(...args: Args) {\n    const message = getMessage(...args)\n\n    if (process.env.NODE_ENV !== 'production') {\n      const callStackFrames = new Error().stack?.split('\\n')\n      if (callStackFrames === undefined || callStackFrames.length < 4) {\n        logErrorOrWarn(message)\n      } else {\n        // Error:\n        //   logDedupedError\n        //   asyncApiBeingAccessedSynchronously\n        //   <userland callsite>\n        // TODO: This breaks if sourcemaps with ignore lists are enabled.\n        const key = callStackFrames[4]\n        errorRef.current = message\n        flushCurrentErrorIfNew(key)\n      }\n    } else {\n      logErrorOrWarn(message)\n    }\n  }\n}\n","import {\n  type ReadonlyRequestCookies,\n  areCookiesMutableInCurrentPhase,\n  RequestCookiesAdapter,\n} from '../web/spec-extension/adapters/request-cookies'\nimport { RequestCookies } from '../web/spec-extension/cookies'\nimport {\n  workAsyncStorage,\n  type WorkStore,\n} from '../app-render/work-async-storage.external'\nimport {\n  throwForMissingRequestStore,\n  workUnitAsyncStorage,\n  type PrerenderStoreModern,\n  type RequestStore,\n} from '../app-render/work-unit-async-storage.external'\nimport {\n  delayUntilRuntimeStage,\n  postponeWithTracking,\n  throwToInterruptStaticGeneration,\n  trackDynamicDataInDynamicRender,\n} from '../app-render/dynamic-rendering'\nimport { StaticGenBailoutError } from '../../client/components/static-generation-bailout'\nimport {\n  makeDevtoolsIOAwarePromise,\n  makeHangingPromise,\n} from '../dynamic-rendering-utils'\nimport { createDedupedByCallsiteServerErrorLoggerDev } from '../create-deduped-by-callsite-server-error-logger'\nimport { isRequestAPICallableInsideAfter } from './utils'\nimport { InvariantError } from '../../shared/lib/invariant-error'\nimport { RenderStage } from '../app-render/staged-rendering'\n\nexport function cookies(): Promise<ReadonlyRequestCookies> {\n  const callingExpression = 'cookies'\n  const workStore = workAsyncStorage.getStore()\n  const workUnitStore = workUnitAsyncStorage.getStore()\n\n  if (workStore) {\n    if (\n      workUnitStore &&\n      workUnitStore.phase === 'after' &&\n      !isRequestAPICallableInsideAfter()\n    ) {\n      throw new Error(\n        // TODO(after): clarify that this only applies to pages?\n        `Route ${workStore.route} used \\`cookies()\\` inside \\`after()\\`. This is not supported. If you need this data inside an \\`after()\\` callback, use \\`cookies()\\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`\n      )\n    }\n\n    if (workStore.forceStatic) {\n      // When using forceStatic we override all other logic and always just return an empty\n      // cookies object without tracking\n      const underlyingCookies = createEmptyCookies()\n      return makeUntrackedCookies(underlyingCookies)\n    }\n\n    if (workStore.dynamicShouldError) {\n      throw new StaticGenBailoutError(\n        `Route ${workStore.route} with \\`dynamic = \"error\"\\` couldn't be rendered statically because it used \\`cookies()\\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`\n      )\n    }\n\n    if (workUnitStore) {\n      switch (workUnitStore.type) {\n        case 'cache':\n          const error = new Error(\n            `Route ${workStore.route} used \\`cookies()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`cookies()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`\n          )\n          Error.captureStackTrace(error, cookies)\n          workStore.invalidDynamicUsageError ??= error\n          throw error\n        case 'unstable-cache':\n          throw new Error(\n            `Route ${workStore.route} used \\`cookies()\\` inside a function cached with \\`unstable_cache()\\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`cookies()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`\n          )\n        case 'prerender':\n          return makeHangingCookies(workStore, workUnitStore)\n        case 'prerender-client':\n          const exportName = '`cookies`'\n          throw new InvariantError(\n            `${exportName} must not be used within a Client Component. Next.js should be preventing ${exportName} from being included in Client Components statically, but did not in this case.`\n          )\n        case 'prerender-ppr':\n          // We need track dynamic access here eagerly to keep continuity with\n          // how cookies has worked in PPR without cacheComponents.\n          return postponeWithTracking(\n            workStore.route,\n            callingExpression,\n            workUnitStore.dynamicTracking\n          )\n        case 'prerender-legacy':\n          // We track dynamic access here so we don't need to wrap the cookies\n          // in individual property access tracking.\n          return throwToInterruptStaticGeneration(\n            callingExpression,\n            workStore,\n            workUnitStore\n          )\n        case 'prerender-runtime':\n          return delayUntilRuntimeStage(\n            workUnitStore,\n            makeUntrackedCookies(workUnitStore.cookies)\n          )\n        case 'private-cache':\n          // Private caches are delayed until the runtime stage in use-cache-wrapper,\n          // so we don't need an additional delay here.\n          return makeUntrackedCookies(workUnitStore.cookies)\n        case 'request':\n          trackDynamicDataInDynamicRender(workUnitStore)\n\n          let underlyingCookies: ReadonlyRequestCookies\n\n          if (areCookiesMutableInCurrentPhase(workUnitStore)) {\n            // We can't conditionally return different types here based on the context.\n            // To avoid confusion, we always return the readonly type here.\n            underlyingCookies =\n              workUnitStore.userspaceMutableCookies as unknown as ReadonlyRequestCookies\n          } else {\n            underlyingCookies = workUnitStore.cookies\n          }\n\n          if (process.env.NODE_ENV === 'development') {\n            // Semantically we only need the dev tracking when running in `next dev`\n            // but since you would never use next dev with production NODE_ENV we use this\n            // as a proxy so we can statically exclude this code from production builds.\n            return makeUntrackedCookiesWithDevWarnings(\n              workUnitStore,\n              underlyingCookies,\n              workStore?.route\n            )\n          } else {\n            return makeUntrackedCookies(underlyingCookies)\n          }\n        default:\n          workUnitStore satisfies never\n      }\n    }\n  }\n\n  // If we end up here, there was no work store or work unit store present.\n  throwForMissingRequestStore(callingExpression)\n}\n\nfunction createEmptyCookies(): ReadonlyRequestCookies {\n  return RequestCookiesAdapter.seal(new RequestCookies(new Headers({})))\n}\n\ninterface CacheLifetime {}\nconst CachedCookies = new WeakMap<\n  CacheLifetime,\n  Promise<ReadonlyRequestCookies>\n>()\n\nfunction makeHangingCookies(\n  workStore: WorkStore,\n  prerenderStore: PrerenderStoreModern\n): Promise<ReadonlyRequestCookies> {\n  const cachedPromise = CachedCookies.get(prerenderStore)\n  if (cachedPromise) {\n    return cachedPromise\n  }\n\n  const promise = makeHangingPromise<ReadonlyRequestCookies>(\n    prerenderStore.renderSignal,\n    workStore.route,\n    '`cookies()`'\n  )\n  CachedCookies.set(prerenderStore, promise)\n\n  return promise\n}\n\nfunction makeUntrackedCookies(\n  underlyingCookies: ReadonlyRequestCookies\n): Promise<ReadonlyRequestCookies> {\n  const cachedCookies = CachedCookies.get(underlyingCookies)\n  if (cachedCookies) {\n    return cachedCookies\n  }\n\n  const promise = Promise.resolve(underlyingCookies)\n  CachedCookies.set(underlyingCookies, promise)\n\n  return promise\n}\n\nfunction makeUntrackedCookiesWithDevWarnings(\n  requestStore: RequestStore,\n  underlyingCookies: ReadonlyRequestCookies,\n  route?: string\n): Promise<ReadonlyRequestCookies> {\n  if (requestStore.asyncApiPromises) {\n    let promise: Promise<ReadonlyRequestCookies>\n    if (underlyingCookies === requestStore.mutableCookies) {\n      promise = requestStore.asyncApiPromises.mutableCookies\n    } else if (underlyingCookies === requestStore.cookies) {\n      promise = requestStore.asyncApiPromises.cookies\n    } else {\n      throw new InvariantError(\n        'Received an underlying cookies object that does not match either `cookies` or `mutableCookies`'\n      )\n    }\n    return instrumentCookiesPromiseWithDevWarnings(promise, route)\n  }\n\n  const cachedCookies = CachedCookies.get(underlyingCookies)\n  if (cachedCookies) {\n    return cachedCookies\n  }\n\n  const promise = makeDevtoolsIOAwarePromise(\n    underlyingCookies,\n    requestStore,\n    RenderStage.Runtime\n  )\n\n  const proxiedPromise = instrumentCookiesPromiseWithDevWarnings(promise, route)\n\n  CachedCookies.set(underlyingCookies, proxiedPromise)\n\n  return proxiedPromise\n}\n\nconst warnForSyncAccess = createDedupedByCallsiteServerErrorLoggerDev(\n  createCookiesAccessError\n)\n\nfunction instrumentCookiesPromiseWithDevWarnings(\n  promise: Promise<ReadonlyRequestCookies>,\n  route: string | undefined\n) {\n  Object.defineProperties(promise, {\n    [Symbol.iterator]: replaceableWarningDescriptorForSymbolIterator(\n      promise,\n      route\n    ),\n    size: replaceableWarningDescriptor(promise, 'size', route),\n    get: replaceableWarningDescriptor(promise, 'get', route),\n    getAll: replaceableWarningDescriptor(promise, 'getAll', route),\n    has: replaceableWarningDescriptor(promise, 'has', route),\n    set: replaceableWarningDescriptor(promise, 'set', route),\n    delete: replaceableWarningDescriptor(promise, 'delete', route),\n    clear: replaceableWarningDescriptor(promise, 'clear', route),\n    toString: replaceableWarningDescriptor(promise, 'toString', route),\n  })\n  return promise\n}\n\nfunction replaceableWarningDescriptor(\n  target: unknown,\n  prop: string,\n  route: string | undefined\n) {\n  return {\n    enumerable: false,\n    get() {\n      warnForSyncAccess(route, `\\`cookies().${prop}\\``)\n      return undefined\n    },\n    set(value: unknown) {\n      Object.defineProperty(target, prop, {\n        value,\n        writable: true,\n        configurable: true,\n      })\n    },\n    configurable: true,\n  }\n}\n\nfunction replaceableWarningDescriptorForSymbolIterator(\n  target: unknown,\n  route: string | undefined\n) {\n  return {\n    enumerable: false,\n    get() {\n      warnForSyncAccess(route, '`...cookies()` or similar iteration')\n      return undefined\n    },\n    set(value: unknown) {\n      Object.defineProperty(target, Symbol.iterator, {\n        value,\n        writable: true,\n        enumerable: true,\n        configurable: true,\n      })\n    },\n    configurable: true,\n  }\n}\n\nfunction createCookiesAccessError(\n  route: string | undefined,\n  expression: string\n) {\n  const prefix = route ? `Route \"${route}\" ` : 'This route '\n  return new Error(\n    `${prefix}used ${expression}. ` +\n      `\\`cookies()\\` returns a Promise and must be unwrapped with \\`await\\` or \\`React.use()\\` before accessing its properties. ` +\n      `Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`\n  )\n}\n","import type { IncomingHttpHeaders } from 'http'\n\nimport { ReflectAdapter } from './reflect'\n\n/**\n * @internal\n */\nexport class ReadonlyHeadersError extends Error {\n  constructor() {\n    super(\n      'Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers'\n    )\n  }\n\n  public static callable() {\n    throw new ReadonlyHeadersError()\n  }\n}\n\nexport type ReadonlyHeaders = Headers & {\n  /** @deprecated Method unavailable on `ReadonlyHeaders`. Read more: https://nextjs.org/docs/app/api-reference/functions/headers */\n  append(...args: any[]): void\n  /** @deprecated Method unavailable on `ReadonlyHeaders`. Read more: https://nextjs.org/docs/app/api-reference/functions/headers */\n  set(...args: any[]): void\n  /** @deprecated Method unavailable on `ReadonlyHeaders`. Read more: https://nextjs.org/docs/app/api-reference/functions/headers */\n  delete(...args: any[]): void\n}\nexport class HeadersAdapter extends Headers {\n  private readonly headers: IncomingHttpHeaders\n\n  constructor(headers: IncomingHttpHeaders) {\n    // We've already overridden the methods that would be called, so we're just\n    // calling the super constructor to ensure that the instanceof check works.\n    super()\n\n    this.headers = new Proxy(headers, {\n      get(target, prop, receiver) {\n        // Because this is just an object, we expect that all \"get\" operations\n        // are for properties. If it's a \"get\" for a symbol, we'll just return\n        // the symbol.\n        if (typeof prop === 'symbol') {\n          return ReflectAdapter.get(target, prop, receiver)\n        }\n\n        const lowercased = prop.toLowerCase()\n\n        // Let's find the original casing of the key. This assumes that there is\n        // no mixed case keys (e.g. \"Content-Type\" and \"content-type\") in the\n        // headers object.\n        const original = Object.keys(headers).find(\n          (o) => o.toLowerCase() === lowercased\n        )\n\n        // If the original casing doesn't exist, return undefined.\n        if (typeof original === 'undefined') return\n\n        // If the original casing exists, return the value.\n        return ReflectAdapter.get(target, original, receiver)\n      },\n      set(target, prop, value, receiver) {\n        if (typeof prop === 'symbol') {\n          return ReflectAdapter.set(target, prop, value, receiver)\n        }\n\n        const lowercased = prop.toLowerCase()\n\n        // Let's find the original casing of the key. This assumes that there is\n        // no mixed case keys (e.g. \"Content-Type\" and \"content-type\") in the\n        // headers object.\n        const original = Object.keys(headers).find(\n          (o) => o.toLowerCase() === lowercased\n        )\n\n        // If the original casing doesn't exist, use the prop as the key.\n        return ReflectAdapter.set(target, original ?? prop, value, receiver)\n      },\n      has(target, prop) {\n        if (typeof prop === 'symbol') return ReflectAdapter.has(target, prop)\n\n        const lowercased = prop.toLowerCase()\n\n        // Let's find the original casing of the key. This assumes that there is\n        // no mixed case keys (e.g. \"Content-Type\" and \"content-type\") in the\n        // headers object.\n        const original = Object.keys(headers).find(\n          (o) => o.toLowerCase() === lowercased\n        )\n\n        // If the original casing doesn't exist, return false.\n        if (typeof original === 'undefined') return false\n\n        // If the original casing exists, return true.\n        return ReflectAdapter.has(target, original)\n      },\n      deleteProperty(target, prop) {\n        if (typeof prop === 'symbol')\n          return ReflectAdapter.deleteProperty(target, prop)\n\n        const lowercased = prop.toLowerCase()\n\n        // Let's find the original casing of the key. This assumes that there is\n        // no mixed case keys (e.g. \"Content-Type\" and \"content-type\") in the\n        // headers object.\n        const original = Object.keys(headers).find(\n          (o) => o.toLowerCase() === lowercased\n        )\n\n        // If the original casing doesn't exist, return true.\n        if (typeof original === 'undefined') return true\n\n        // If the original casing exists, delete the property.\n        return ReflectAdapter.deleteProperty(target, original)\n      },\n    })\n  }\n\n  /**\n   * Seals a Headers instance to prevent modification by throwing an error when\n   * any mutating method is called.\n   */\n  public static seal(headers: Headers): ReadonlyHeaders {\n    return new Proxy<ReadonlyHeaders>(headers, {\n      get(target, prop, receiver) {\n        switch (prop) {\n          case 'append':\n          case 'delete':\n          case 'set':\n            return ReadonlyHeadersError.callable\n          default:\n            return ReflectAdapter.get(target, prop, receiver)\n        }\n      },\n    })\n  }\n\n  /**\n   * Merges a header value into a string. This stores multiple values as an\n   * array, so we need to merge them into a string.\n   *\n   * @param value a header value\n   * @returns a merged header value (a string)\n   */\n  private merge(value: string | string[]): string {\n    if (Array.isArray(value)) return value.join(', ')\n\n    return value\n  }\n\n  /**\n   * Creates a Headers instance from a plain object or a Headers instance.\n   *\n   * @param headers a plain object or a Headers instance\n   * @returns a headers instance\n   */\n  public static from(headers: IncomingHttpHeaders | Headers): Headers {\n    if (headers instanceof Headers) return headers\n\n    return new HeadersAdapter(headers)\n  }\n\n  public append(name: string, value: string): void {\n    const existing = this.headers[name]\n    if (typeof existing === 'string') {\n      this.headers[name] = [existing, value]\n    } else if (Array.isArray(existing)) {\n      existing.push(value)\n    } else {\n      this.headers[name] = value\n    }\n  }\n\n  public delete(name: string): void {\n    delete this.headers[name]\n  }\n\n  public get(name: string): string | null {\n    const value = this.headers[name]\n    if (typeof value !== 'undefined') return this.merge(value)\n\n    return null\n  }\n\n  public has(name: string): boolean {\n    return typeof this.headers[name] !== 'undefined'\n  }\n\n  public set(name: string, value: string): void {\n    this.headers[name] = value\n  }\n\n  public forEach(\n    callbackfn: (value: string, name: string, parent: Headers) => void,\n    thisArg?: any\n  ): void {\n    for (const [name, value] of this.entries()) {\n      callbackfn.call(thisArg, value, name, this)\n    }\n  }\n\n  public *entries(): HeadersIterator<[string, string]> {\n    for (const key of Object.keys(this.headers)) {\n      const name = key.toLowerCase()\n      // We assert here that this is a string because we got it from the\n      // Object.keys() call above.\n      const value = this.get(name) as string\n\n      yield [name, value] as [string, string]\n    }\n  }\n\n  public *keys(): HeadersIterator<string> {\n    for (const key of Object.keys(this.headers)) {\n      const name = key.toLowerCase()\n      yield name\n    }\n  }\n\n  public *values(): HeadersIterator<string> {\n    for (const key of Object.keys(this.headers)) {\n      // We assert here that this is a string because we got it from the\n      // Object.keys() call above.\n      const value = this.get(key) as string\n\n      yield value\n    }\n  }\n\n  public [Symbol.iterator](): HeadersIterator<[string, string]> {\n    return this.entries()\n  }\n}\n","import {\n  HeadersAdapter,\n  type ReadonlyHeaders,\n} from '../web/spec-extension/adapters/headers'\nimport {\n  workAsyncStorage,\n  type WorkStore,\n} from '../app-render/work-async-storage.external'\nimport {\n  throwForMissingRequestStore,\n  workUnitAsyncStorage,\n  type PrerenderStoreModern,\n  type RequestStore,\n} from '../app-render/work-unit-async-storage.external'\nimport {\n  delayUntilRuntimeStage,\n  postponeWithTracking,\n  throwToInterruptStaticGeneration,\n  trackDynamicDataInDynamicRender,\n} from '../app-render/dynamic-rendering'\nimport { StaticGenBailoutError } from '../../client/components/static-generation-bailout'\nimport {\n  makeDevtoolsIOAwarePromise,\n  makeHangingPromise,\n} from '../dynamic-rendering-utils'\nimport { createDedupedByCallsiteServerErrorLoggerDev } from '../create-deduped-by-callsite-server-error-logger'\nimport { isRequestAPICallableInsideAfter } from './utils'\nimport { InvariantError } from '../../shared/lib/invariant-error'\nimport { RenderStage } from '../app-render/staged-rendering'\n\n/**\n * This function allows you to read the HTTP incoming request headers in\n * [Server Components](https://nextjs.org/docs/app/building-your-application/rendering/server-components),\n * [Server Actions](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations),\n * [Route Handlers](https://nextjs.org/docs/app/building-your-application/routing/route-handlers) and\n * [Middleware](https://nextjs.org/docs/app/building-your-application/routing/middleware).\n *\n * Read more: [Next.js Docs: `headers`](https://nextjs.org/docs/app/api-reference/functions/headers)\n */\nexport function headers(): Promise<ReadonlyHeaders> {\n  const callingExpression = 'headers'\n  const workStore = workAsyncStorage.getStore()\n  const workUnitStore = workUnitAsyncStorage.getStore()\n\n  if (workStore) {\n    if (\n      workUnitStore &&\n      workUnitStore.phase === 'after' &&\n      !isRequestAPICallableInsideAfter()\n    ) {\n      throw new Error(\n        `Route ${workStore.route} used \\`headers()\\` inside \\`after()\\`. This is not supported. If you need this data inside an \\`after()\\` callback, use \\`headers()\\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`\n      )\n    }\n\n    if (workStore.forceStatic) {\n      // When using forceStatic we override all other logic and always just return an empty\n      // headers object without tracking\n      const underlyingHeaders = HeadersAdapter.seal(new Headers({}))\n      return makeUntrackedHeaders(underlyingHeaders)\n    }\n\n    if (workUnitStore) {\n      switch (workUnitStore.type) {\n        case 'cache': {\n          const error = new Error(\n            `Route ${workStore.route} used \\`headers()\\` inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`headers()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`\n          )\n          Error.captureStackTrace(error, headers)\n          workStore.invalidDynamicUsageError ??= error\n          throw error\n        }\n        case 'unstable-cache':\n          throw new Error(\n            `Route ${workStore.route} used \\`headers()\\` inside a function cached with \\`unstable_cache()\\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \\`headers()\\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`\n          )\n        case 'prerender':\n        case 'prerender-client':\n        case 'private-cache':\n        case 'prerender-runtime':\n        case 'prerender-ppr':\n        case 'prerender-legacy':\n        case 'request':\n          break\n        default:\n          workUnitStore satisfies never\n      }\n    }\n\n    if (workStore.dynamicShouldError) {\n      throw new StaticGenBailoutError(\n        `Route ${workStore.route} with \\`dynamic = \"error\"\\` couldn't be rendered statically because it used \\`headers()\\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`\n      )\n    }\n\n    if (workUnitStore) {\n      switch (workUnitStore.type) {\n        case 'prerender':\n          return makeHangingHeaders(workStore, workUnitStore)\n        case 'prerender-client':\n          const exportName = '`headers`'\n          throw new InvariantError(\n            `${exportName} must not be used within a client component. Next.js should be preventing ${exportName} from being included in client components statically, but did not in this case.`\n          )\n        case 'prerender-ppr':\n          // PPR Prerender (no cacheComponents)\n          // We are prerendering with PPR. We need track dynamic access here eagerly\n          // to keep continuity with how headers has worked in PPR without cacheComponents.\n          // TODO consider switching the semantic to throw on property access instead\n          return postponeWithTracking(\n            workStore.route,\n            callingExpression,\n            workUnitStore.dynamicTracking\n          )\n        case 'prerender-legacy':\n          // Legacy Prerender\n          // We are in a legacy static generation mode while prerendering\n          // We track dynamic access here so we don't need to wrap the headers in\n          // individual property access tracking.\n          return throwToInterruptStaticGeneration(\n            callingExpression,\n            workStore,\n            workUnitStore\n          )\n        case 'prerender-runtime':\n          return delayUntilRuntimeStage(\n            workUnitStore,\n            makeUntrackedHeaders(workUnitStore.headers)\n          )\n        case 'private-cache':\n          // Private caches are delayed until the runtime stage in use-cache-wrapper,\n          // so we don't need an additional delay here.\n          return makeUntrackedHeaders(workUnitStore.headers)\n        case 'request':\n          trackDynamicDataInDynamicRender(workUnitStore)\n\n          if (process.env.NODE_ENV === 'development') {\n            // Semantically we only need the dev tracking when running in `next dev`\n            // but since you would never use next dev with production NODE_ENV we use this\n            // as a proxy so we can statically exclude this code from production builds.\n            return makeUntrackedHeadersWithDevWarnings(\n              workUnitStore.headers,\n              workStore?.route,\n              workUnitStore\n            )\n          } else {\n            return makeUntrackedHeaders(workUnitStore.headers)\n          }\n          break\n        default:\n          workUnitStore satisfies never\n      }\n    }\n  }\n\n  // If we end up here, there was no work store or work unit store present.\n  throwForMissingRequestStore(callingExpression)\n}\n\ninterface CacheLifetime {}\nconst CachedHeaders = new WeakMap<CacheLifetime, Promise<ReadonlyHeaders>>()\n\nfunction makeHangingHeaders(\n  workStore: WorkStore,\n  prerenderStore: PrerenderStoreModern\n): Promise<ReadonlyHeaders> {\n  const cachedHeaders = CachedHeaders.get(prerenderStore)\n  if (cachedHeaders) {\n    return cachedHeaders\n  }\n\n  const promise = makeHangingPromise<ReadonlyHeaders>(\n    prerenderStore.renderSignal,\n    workStore.route,\n    '`headers()`'\n  )\n  CachedHeaders.set(prerenderStore, promise)\n\n  return promise\n}\n\nfunction makeUntrackedHeaders(\n  underlyingHeaders: ReadonlyHeaders\n): Promise<ReadonlyHeaders> {\n  const cachedHeaders = CachedHeaders.get(underlyingHeaders)\n  if (cachedHeaders) {\n    return cachedHeaders\n  }\n\n  const promise = Promise.resolve(underlyingHeaders)\n  CachedHeaders.set(underlyingHeaders, promise)\n\n  return promise\n}\n\nfunction makeUntrackedHeadersWithDevWarnings(\n  underlyingHeaders: ReadonlyHeaders,\n  route: string | undefined,\n  requestStore: RequestStore\n): Promise<ReadonlyHeaders> {\n  if (requestStore.asyncApiPromises) {\n    const promise = requestStore.asyncApiPromises.headers\n    return instrumentHeadersPromiseWithDevWarnings(promise, route)\n  }\n\n  const cachedHeaders = CachedHeaders.get(underlyingHeaders)\n  if (cachedHeaders) {\n    return cachedHeaders\n  }\n\n  const promise = makeDevtoolsIOAwarePromise(\n    underlyingHeaders,\n    requestStore,\n    RenderStage.Runtime\n  )\n\n  const proxiedPromise = instrumentHeadersPromiseWithDevWarnings(promise, route)\n\n  CachedHeaders.set(underlyingHeaders, proxiedPromise)\n\n  return proxiedPromise\n}\n\nconst warnForSyncAccess = createDedupedByCallsiteServerErrorLoggerDev(\n  createHeadersAccessError\n)\n\nfunction instrumentHeadersPromiseWithDevWarnings(\n  promise: Promise<ReadonlyHeaders>,\n  route: string | undefined\n) {\n  Object.defineProperties(promise, {\n    [Symbol.iterator]: replaceableWarningDescriptorForSymbolIterator(\n      promise,\n      route\n    ),\n    append: replaceableWarningDescriptor(promise, 'append', route),\n    delete: replaceableWarningDescriptor(promise, 'delete', route),\n    get: replaceableWarningDescriptor(promise, 'get', route),\n    has: replaceableWarningDescriptor(promise, 'has', route),\n    set: replaceableWarningDescriptor(promise, 'set', route),\n    getSetCookie: replaceableWarningDescriptor(promise, 'getSetCookie', route),\n    forEach: replaceableWarningDescriptor(promise, 'forEach', route),\n    keys: replaceableWarningDescriptor(promise, 'keys', route),\n    values: replaceableWarningDescriptor(promise, 'values', route),\n    entries: replaceableWarningDescriptor(promise, 'entries', route),\n  })\n  return promise\n}\n\nfunction replaceableWarningDescriptor(\n  target: unknown,\n  prop: string,\n  route: string | undefined\n) {\n  return {\n    enumerable: false,\n    get() {\n      warnForSyncAccess(route, `\\`headers().${prop}\\``)\n      return undefined\n    },\n    set(value: unknown) {\n      Object.defineProperty(target, prop, {\n        value,\n        writable: true,\n        configurable: true,\n      })\n    },\n    configurable: true,\n  }\n}\n\nfunction replaceableWarningDescriptorForSymbolIterator(\n  target: unknown,\n  route: string | undefined\n) {\n  return {\n    enumerable: false,\n    get() {\n      warnForSyncAccess(route, '`...headers()` or similar iteration')\n      return undefined\n    },\n    set(value: unknown) {\n      Object.defineProperty(target, Symbol.iterator, {\n        value,\n        writable: true,\n        enumerable: true,\n        configurable: true,\n      })\n    },\n    configurable: true,\n  }\n}\n\nfunction createHeadersAccessError(\n  route: string | undefined,\n  expression: string\n) {\n  const prefix = route ? `Route \"${route}\" ` : 'This route '\n  return new Error(\n    `${prefix}used ${expression}. ` +\n      `\\`headers()\\` returns a Promise and must be unwrapped with \\`await\\` or \\`React.use()\\` before accessing its properties. ` +\n      `Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`\n  )\n}\n","import {\n  getDraftModeProviderForCacheScope,\n  throwForMissingRequestStore,\n} from '../app-render/work-unit-async-storage.external'\n\nimport type { DraftModeProvider } from '../async-storage/draft-mode-provider'\n\nimport {\n  workAsyncStorage,\n  type WorkStore,\n} from '../app-render/work-async-storage.external'\nimport { workUnitAsyncStorage } from '../app-render/work-unit-async-storage.external'\nimport {\n  abortAndThrowOnSynchronousRequestDataAccess,\n  delayUntilRuntimeStage,\n  postponeWithTracking,\n  trackDynamicDataInDynamicRender,\n} from '../app-render/dynamic-rendering'\nimport { createDedupedByCallsiteServerErrorLoggerDev } from '../create-deduped-by-callsite-server-error-logger'\nimport { StaticGenBailoutError } from '../../client/components/static-generation-bailout'\nimport { DynamicServerError } from '../../client/components/hooks-server-context'\nimport { InvariantError } from '../../shared/lib/invariant-error'\nimport { ReflectAdapter } from '../web/spec-extension/adapters/reflect'\n\nexport function draftMode(): Promise<DraftMode> {\n  const callingExpression = 'draftMode'\n  const workStore = workAsyncStorage.getStore()\n  const workUnitStore = workUnitAsyncStorage.getStore()\n\n  if (!workStore || !workUnitStore) {\n    throwForMissingRequestStore(callingExpression)\n  }\n\n  switch (workUnitStore.type) {\n    case 'prerender-runtime':\n      // TODO(runtime-ppr): does it make sense to delay this? normally it's always microtasky\n      return delayUntilRuntimeStage(\n        workUnitStore,\n        createOrGetCachedDraftMode(workUnitStore.draftMode, workStore)\n      )\n    case 'request':\n      return createOrGetCachedDraftMode(workUnitStore.draftMode, workStore)\n\n    case 'cache':\n    case 'private-cache':\n    case 'unstable-cache':\n      // Inside of `\"use cache\"` or `unstable_cache`, draft mode is available if\n      // the outmost work unit store is a request store (or a runtime prerender),\n      // and if draft mode is enabled.\n      const draftModeProvider = getDraftModeProviderForCacheScope(\n        workStore,\n        workUnitStore\n      )\n\n      if (draftModeProvider) {\n        return createOrGetCachedDraftMode(draftModeProvider, workStore)\n      }\n\n    // Otherwise, we fall through to providing an empty draft mode.\n    // eslint-disable-next-line no-fallthrough\n    case 'prerender':\n    case 'prerender-client':\n    case 'prerender-ppr':\n    case 'prerender-legacy':\n      // Return empty draft mode\n      return createOrGetCachedDraftMode(null, workStore)\n\n    default:\n      return workUnitStore satisfies never\n  }\n}\n\nfunction createOrGetCachedDraftMode(\n  draftModeProvider: DraftModeProvider | null,\n  workStore: WorkStore | undefined\n): Promise<DraftMode> {\n  const cacheKey = draftModeProvider ?? NullDraftMode\n  const cachedDraftMode = CachedDraftModes.get(cacheKey)\n\n  if (cachedDraftMode) {\n    return cachedDraftMode\n  }\n\n  if (process.env.NODE_ENV === 'development' && !workStore?.isPrefetchRequest) {\n    const route = workStore?.route\n    return createDraftModeWithDevWarnings(draftModeProvider, route)\n  } else {\n    return Promise.resolve(new DraftMode(draftModeProvider))\n  }\n}\n\ninterface CacheLifetime {}\nconst NullDraftMode = {}\nconst CachedDraftModes = new WeakMap<CacheLifetime, Promise<DraftMode>>()\n\nfunction createDraftModeWithDevWarnings(\n  underlyingProvider: null | DraftModeProvider,\n  route: undefined | string\n): Promise<DraftMode> {\n  const instance = new DraftMode(underlyingProvider)\n  const promise = Promise.resolve(instance)\n\n  const proxiedPromise = new Proxy(promise, {\n    get(target, prop, receiver) {\n      switch (prop) {\n        case 'isEnabled':\n          warnForSyncAccess(route, `\\`draftMode().${prop}\\``)\n          break\n        case 'enable':\n        case 'disable': {\n          warnForSyncAccess(route, `\\`draftMode().${prop}()\\``)\n          break\n        }\n        default: {\n          // We only warn for well-defined properties of the draftMode object.\n        }\n      }\n\n      return ReflectAdapter.get(target, prop, receiver)\n    },\n  })\n\n  return proxiedPromise\n}\n\nclass DraftMode {\n  /**\n   * @internal - this declaration is stripped via `tsc --stripInternal`\n   */\n  private readonly _provider: null | DraftModeProvider\n\n  constructor(provider: null | DraftModeProvider) {\n    this._provider = provider\n  }\n  get isEnabled() {\n    if (this._provider !== null) {\n      return this._provider.isEnabled\n    }\n    return false\n  }\n  public enable() {\n    // We have a store we want to track dynamic data access to ensure we\n    // don't statically generate routes that manipulate draft mode.\n    trackDynamicDraftMode('draftMode().enable()', this.enable)\n    if (this._provider !== null) {\n      this._provider.enable()\n    }\n  }\n  public disable() {\n    trackDynamicDraftMode('draftMode().disable()', this.disable)\n    if (this._provider !== null) {\n      this._provider.disable()\n    }\n  }\n}\nconst warnForSyncAccess = createDedupedByCallsiteServerErrorLoggerDev(\n  createDraftModeAccessError\n)\n\nfunction createDraftModeAccessError(\n  route: string | undefined,\n  expression: string\n) {\n  const prefix = route ? `Route \"${route}\" ` : 'This route '\n  return new Error(\n    `${prefix}used ${expression}. ` +\n      `\\`draftMode()\\` returns a Promise and must be unwrapped with \\`await\\` or \\`React.use()\\` before accessing its properties. ` +\n      `Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`\n  )\n}\n\nfunction trackDynamicDraftMode(expression: string, constructorOpt: Function) {\n  const workStore = workAsyncStorage.getStore()\n  const workUnitStore = workUnitAsyncStorage.getStore()\n\n  if (workStore) {\n    // We have a store we want to track dynamic data access to ensure we\n    // don't statically generate routes that manipulate draft mode.\n    if (workUnitStore?.phase === 'after') {\n      throw new Error(\n        `Route ${workStore.route} used \"${expression}\" inside \\`after()\\`. The enabled status of \\`draftMode()\\` can be read inside \\`after()\\` but you cannot enable or disable \\`draftMode()\\`. See more info here: https://nextjs.org/docs/app/api-reference/functions/after`\n      )\n    }\n\n    if (workStore.dynamicShouldError) {\n      throw new StaticGenBailoutError(\n        `Route ${workStore.route} with \\`dynamic = \"error\"\\` couldn't be rendered statically because it used \\`${expression}\\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`\n      )\n    }\n\n    if (workUnitStore) {\n      switch (workUnitStore.type) {\n        case 'cache':\n        case 'private-cache': {\n          const error = new Error(\n            `Route ${workStore.route} used \"${expression}\" inside \"use cache\". The enabled status of \\`draftMode()\\` can be read in caches but you must not enable or disable \\`draftMode()\\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`\n          )\n          Error.captureStackTrace(error, constructorOpt)\n          workStore.invalidDynamicUsageError ??= error\n          throw error\n        }\n        case 'unstable-cache':\n          throw new Error(\n            `Route ${workStore.route} used \"${expression}\" inside a function cached with \\`unstable_cache()\\`. The enabled status of \\`draftMode()\\` can be read in caches but you must not enable or disable \\`draftMode()\\` inside a cache. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`\n          )\n\n        case 'prerender':\n        case 'prerender-runtime': {\n          const error = new Error(\n            `Route ${workStore.route} used ${expression} without first calling \\`await connection()\\`. See more info here: https://nextjs.org/docs/messages/next-prerender-sync-headers`\n          )\n          return abortAndThrowOnSynchronousRequestDataAccess(\n            workStore.route,\n            expression,\n            error,\n            workUnitStore\n          )\n        }\n        case 'prerender-client':\n          const exportName = '`draftMode`'\n          throw new InvariantError(\n            `${exportName} must not be used within a Client Component. Next.js should be preventing ${exportName} from being included in Client Components statically, but did not in this case.`\n          )\n        case 'prerender-ppr':\n          return postponeWithTracking(\n            workStore.route,\n            expression,\n            workUnitStore.dynamicTracking\n          )\n        case 'prerender-legacy':\n          workUnitStore.revalidate = 0\n\n          const err = new DynamicServerError(\n            `Route ${workStore.route} couldn't be rendered statically because it used \\`${expression}\\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`\n          )\n          workStore.dynamicUsageDescription = expression\n          workStore.dynamicUsageStack = err.stack\n\n          throw err\n        case 'request':\n          trackDynamicDataInDynamicRender(workUnitStore)\n          break\n        default:\n          workUnitStore satisfies never\n      }\n    }\n  }\n}\n","module.exports.cookies = require('./dist/server/request/cookies').cookies\nmodule.exports.headers = require('./dist/server/request/headers').headers\nmodule.exports.draftMode = require('./dist/server/request/draft-mode').draftMode\n","/**\n * RegExp to match cookie-name in RFC 6265 sec 4.1.1\n * This refers out to the obsoleted definition of token in RFC 2616 sec 2.2\n * which has been replaced by the token definition in RFC 7230 appendix B.\n *\n * cookie-name       = token\n * token             = 1*tchar\n * tchar             = \"!\" / \"#\" / \"$\" / \"%\" / \"&\" / \"'\" /\n *                     \"*\" / \"+\" / \"-\" / \".\" / \"^\" / \"_\" /\n *                     \"`\" / \"|\" / \"~\" / DIGIT / ALPHA\n *\n * Note: Allowing more characters - https://github.com/jshttp/cookie/issues/191\n * Allow same range as cookie value, except `=`, which delimits end of name.\n */\nconst cookieNameRegExp = /^[\\u0021-\\u003A\\u003C\\u003E-\\u007E]+$/;\n\n/**\n * RegExp to match cookie-value in RFC 6265 sec 4.1.1\n *\n * cookie-value      = *cookie-octet / ( DQUOTE *cookie-octet DQUOTE )\n * cookie-octet      = %x21 / %x23-2B / %x2D-3A / %x3C-5B / %x5D-7E\n *                     ; US-ASCII characters excluding CTLs,\n *                     ; whitespace DQUOTE, comma, semicolon,\n *                     ; and backslash\n *\n * Allowing more characters: https://github.com/jshttp/cookie/issues/191\n * Comma, backslash, and DQUOTE are not part of the parsing algorithm.\n */\nconst cookieValueRegExp = /^[\\u0021-\\u003A\\u003C-\\u007E]*$/;\n\n/**\n * RegExp to match domain-value in RFC 6265 sec 4.1.1\n *\n * domain-value      = <subdomain>\n *                     ; defined in [RFC1034], Section 3.5, as\n *                     ; enhanced by [RFC1123], Section 2.1\n * <subdomain>       = <label> | <subdomain> \".\" <label>\n * <label>           = <let-dig> [ [ <ldh-str> ] <let-dig> ]\n *                     Labels must be 63 characters or less.\n *                     'let-dig' not 'letter' in the first char, per RFC1123\n * <ldh-str>         = <let-dig-hyp> | <let-dig-hyp> <ldh-str>\n * <let-dig-hyp>     = <let-dig> | \"-\"\n * <let-dig>         = <letter> | <digit>\n * <letter>          = any one of the 52 alphabetic characters A through Z in\n *                     upper case and a through z in lower case\n * <digit>           = any one of the ten digits 0 through 9\n *\n * Keep support for leading dot: https://github.com/jshttp/cookie/issues/173\n *\n * > (Note that a leading %x2E (\".\"), if present, is ignored even though that\n * character is not permitted, but a trailing %x2E (\".\"), if present, will\n * cause the user agent to ignore the attribute.)\n */\nconst domainValueRegExp =\n  /^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i;\n\n/**\n * RegExp to match path-value in RFC 6265 sec 4.1.1\n *\n * path-value        = <any CHAR except CTLs or \";\">\n * CHAR              = %x01-7F\n *                     ; defined in RFC 5234 appendix B.1\n */\nconst pathValueRegExp = /^[\\u0020-\\u003A\\u003D-\\u007E]*$/;\n\n/**\n * RegExp to match max-age-value in RFC 6265 sec 5.6.2\n */\nconst maxAgeRegExp = /^-?\\d+$/;\n\nconst __toString = Object.prototype.toString;\n\nconst NullObject = /* @__PURE__ */ (() => {\n  const C = function () {};\n  C.prototype = Object.create(null);\n  return C;\n})() as unknown as { new (): any };\n\n/**\n * Parse options.\n */\nexport interface ParseOptions {\n  /**\n   * Specifies a function that will be used to decode a [cookie-value](https://datatracker.ietf.org/doc/html/rfc6265#section-4.1.1).\n   * Since the value of a cookie has a limited character set (and must be a simple string), this function can be used to decode\n   * a previously-encoded cookie value into a JavaScript string.\n   *\n   * The default function is the global `decodeURIComponent`, wrapped in a `try..catch`. If an error\n   * is thrown it will return the cookie's original value. If you provide your own encode/decode\n   * scheme you must ensure errors are appropriately handled.\n   *\n   * @default decode\n   */\n  decode?: (str: string) => string | undefined;\n}\n\n/**\n * Cookies object.\n */\nexport type Cookies = Record<string, string | undefined>;\n\n/**\n * Parse a `Cookie` header.\n *\n * Parse the given cookie header string into an object\n * The object has the various cookies as keys(names) => values\n */\nexport function parseCookie(str: string, options?: ParseOptions): Cookies {\n  const obj: Cookies = new NullObject();\n  const len = str.length;\n  // RFC 6265 sec 4.1.1, RFC 2616 2.2 defines a cookie name consists of one char minimum, plus '='.\n  if (len < 2) return obj;\n\n  const dec = options?.decode || decode;\n  let index = 0;\n\n  do {\n    const eqIdx = eqIndex(str, index, len);\n    if (eqIdx === -1) break; // No more cookie pairs.\n\n    const endIdx = endIndex(str, index, len);\n\n    if (eqIdx > endIdx) {\n      // backtrack on prior semicolon\n      index = str.lastIndexOf(\";\", eqIdx - 1) + 1;\n      continue;\n    }\n\n    const key = valueSlice(str, index, eqIdx);\n\n    // only assign once\n    if (obj[key] === undefined) {\n      obj[key] = dec(valueSlice(str, eqIdx + 1, endIdx));\n    }\n\n    index = endIdx + 1;\n  } while (index < len);\n\n  return obj;\n}\n\nexport interface StringifyOptions {\n  /**\n   * Specifies a function that will be used to encode a [cookie-value](https://datatracker.ietf.org/doc/html/rfc6265#section-4.1.1).\n   * Since value of a cookie has a limited character set (and must be a simple string), this function can be used to encode\n   * a value into a string suited for a cookie's value, and should mirror `decode` when parsing.\n   *\n   * @default encodeURIComponent\n   */\n  encode?: (str: string) => string;\n}\n\n/**\n * Stringifies an object into an HTTP `Cookie` header.\n */\nexport function stringifyCookie(\n  cookie: Cookies,\n  options?: StringifyOptions,\n): string {\n  const enc = options?.encode || encodeURIComponent;\n  const cookieStrings: string[] = [];\n\n  for (const name of Object.keys(cookie)) {\n    const val = cookie[name];\n    if (val === undefined) continue;\n\n    if (!cookieNameRegExp.test(name)) {\n      throw new TypeError(`cookie name is invalid: ${name}`);\n    }\n\n    const value = enc(val);\n\n    if (!cookieValueRegExp.test(value)) {\n      throw new TypeError(`cookie val is invalid: ${val}`);\n    }\n\n    cookieStrings.push(`${name}=${value}`);\n  }\n\n  return cookieStrings.join(\"; \");\n}\n\n/**\n * Set-Cookie object.\n */\nexport interface SetCookie {\n  /**\n   * Specifies the name of the cookie.\n   */\n  name: string;\n  /**\n   * Specifies the string to be the value for the cookie.\n   */\n  value: string | undefined;\n  /**\n   * Specifies the `number` (in seconds) to be the value for the [`Max-Age` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.2).\n   *\n   * The [cookie storage model specification](https://tools.ietf.org/html/rfc6265#section-5.3) states that if both `expires` and\n   * `maxAge` are set, then `maxAge` takes precedence, but it is possible not all clients by obey this,\n   * so if both are set, they should point to the same date and time.\n   */\n  maxAge?: number;\n  /**\n   * Specifies the `Date` object to be the value for the [`Expires` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.1).\n   * When no expiration is set, clients consider this a \"non-persistent cookie\" and delete it when the current session is over.\n   *\n   * The [cookie storage model specification](https://tools.ietf.org/html/rfc6265#section-5.3) states that if both `expires` and\n   * `maxAge` are set, then `maxAge` takes precedence, but it is possible not all clients by obey this,\n   * so if both are set, they should point to the same date and time.\n   */\n  expires?: Date;\n  /**\n   * Specifies the value for the [`Domain` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.3).\n   * When no domain is set, clients consider the cookie to apply to the current domain only.\n   */\n  domain?: string;\n  /**\n   * Specifies the value for the [`Path` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.4).\n   * When no path is set, the path is considered the [\"default path\"](https://tools.ietf.org/html/rfc6265#section-5.1.4).\n   */\n  path?: string;\n  /**\n   * Enables the [`HttpOnly` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.6).\n   * When enabled, clients will not allow client-side JavaScript to see the cookie in `document.cookie`.\n   */\n  httpOnly?: boolean;\n  /**\n   * Enables the [`Secure` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.5).\n   * When enabled, clients will only send the cookie back if the browser has an HTTPS connection.\n   */\n  secure?: boolean;\n  /**\n   * Enables the [`Partitioned` `Set-Cookie` attribute](https://tools.ietf.org/html/draft-cutler-httpbis-partitioned-cookies/).\n   * When enabled, clients will only send the cookie back when the current domain _and_ top-level domain matches.\n   *\n   * This is an attribute that has not yet been fully standardized, and may change in the future.\n   * This also means clients may ignore this attribute until they understand it. More information\n   * about can be found in [the proposal](https://github.com/privacycg/CHIPS).\n   */\n  partitioned?: boolean;\n  /**\n   * Specifies the value for the [`Priority` `Set-Cookie` attribute](https://tools.ietf.org/html/draft-west-cookie-priority-00#section-4.1).\n   *\n   * - `'low'` will set the `Priority` attribute to `Low`.\n   * - `'medium'` will set the `Priority` attribute to `Medium`, the default priority when not set.\n   * - `'high'` will set the `Priority` attribute to `High`.\n   *\n   * More information about priority levels can be found in [the specification](https://tools.ietf.org/html/draft-west-cookie-priority-00#section-4.1).\n   */\n  priority?: \"low\" | \"medium\" | \"high\";\n  /**\n   * Specifies the value for the [`SameSite` `Set-Cookie` attribute](https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-09#section-5.4.7).\n   *\n   * - `true` will set the `SameSite` attribute to `Strict` for strict same site enforcement.\n   * - `'lax'` will set the `SameSite` attribute to `Lax` for lax same site enforcement.\n   * - `'none'` will set the `SameSite` attribute to `None` for an explicit cross-site cookie.\n   * - `'strict'` will set the `SameSite` attribute to `Strict` for strict same site enforcement.\n   *\n   * More information about enforcement levels can be found in [the specification](https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-09#section-5.4.7).\n   */\n  sameSite?: boolean | \"lax\" | \"strict\" | \"none\";\n}\n\n/**\n * Backward compatibility serialize options.\n */\nexport type SerializeOptions = StringifyOptions &\n  Omit<SetCookie, \"name\" | \"value\">;\n\n/**\n * Serialize data into a cookie header.\n *\n * Serialize a name value pair into a cookie string suitable for\n * http headers. An optional options object specifies cookie parameters.\n *\n * serialize('foo', 'bar', { httpOnly: true })\n *   => \"foo=bar; httpOnly\"\n */\nexport function stringifySetCookie(\n  cookie: SetCookie,\n  options?: StringifyOptions,\n): string;\nexport function stringifySetCookie(\n  name: string,\n  val: string,\n  options?: SerializeOptions,\n): string;\nexport function stringifySetCookie(\n  _name: string | SetCookie,\n  _val?: string | StringifyOptions,\n  _opts?: SerializeOptions,\n): string {\n  const cookie =\n    typeof _name === \"object\"\n      ? _name\n      : { ..._opts, name: _name, value: String(_val) };\n  const options = typeof _val === \"object\" ? _val : _opts;\n  const enc = options?.encode || encodeURIComponent;\n\n  if (!cookieNameRegExp.test(cookie.name)) {\n    throw new TypeError(`argument name is invalid: ${cookie.name}`);\n  }\n\n  const value = cookie.value ? enc(cookie.value) : \"\";\n\n  if (!cookieValueRegExp.test(value)) {\n    throw new TypeError(`argument val is invalid: ${cookie.value}`);\n  }\n\n  let str = cookie.name + \"=\" + value;\n\n  if (cookie.maxAge !== undefined) {\n    if (!Number.isInteger(cookie.maxAge)) {\n      throw new TypeError(`option maxAge is invalid: ${cookie.maxAge}`);\n    }\n\n    str += \"; Max-Age=\" + cookie.maxAge;\n  }\n\n  if (cookie.domain) {\n    if (!domainValueRegExp.test(cookie.domain)) {\n      throw new TypeError(`option domain is invalid: ${cookie.domain}`);\n    }\n\n    str += \"; Domain=\" + cookie.domain;\n  }\n\n  if (cookie.path) {\n    if (!pathValueRegExp.test(cookie.path)) {\n      throw new TypeError(`option path is invalid: ${cookie.path}`);\n    }\n\n    str += \"; Path=\" + cookie.path;\n  }\n\n  if (cookie.expires) {\n    if (!isDate(cookie.expires) || !Number.isFinite(cookie.expires.valueOf())) {\n      throw new TypeError(`option expires is invalid: ${cookie.expires}`);\n    }\n\n    str += \"; Expires=\" + cookie.expires.toUTCString();\n  }\n\n  if (cookie.httpOnly) {\n    str += \"; HttpOnly\";\n  }\n\n  if (cookie.secure) {\n    str += \"; Secure\";\n  }\n\n  if (cookie.partitioned) {\n    str += \"; Partitioned\";\n  }\n\n  if (cookie.priority) {\n    const priority =\n      typeof cookie.priority === \"string\"\n        ? cookie.priority.toLowerCase()\n        : undefined;\n    switch (priority) {\n      case \"low\":\n        str += \"; Priority=Low\";\n        break;\n      case \"medium\":\n        str += \"; Priority=Medium\";\n        break;\n      case \"high\":\n        str += \"; Priority=High\";\n        break;\n      default:\n        throw new TypeError(`option priority is invalid: ${cookie.priority}`);\n    }\n  }\n\n  if (cookie.sameSite) {\n    const sameSite =\n      typeof cookie.sameSite === \"string\"\n        ? cookie.sameSite.toLowerCase()\n        : cookie.sameSite;\n    switch (sameSite) {\n      case true:\n      case \"strict\":\n        str += \"; SameSite=Strict\";\n        break;\n      case \"lax\":\n        str += \"; SameSite=Lax\";\n        break;\n      case \"none\":\n        str += \"; SameSite=None\";\n        break;\n      default:\n        throw new TypeError(`option sameSite is invalid: ${cookie.sameSite}`);\n    }\n  }\n\n  return str;\n}\n\n/**\n * Deserialize a `Set-Cookie` header into an object.\n *\n * deserialize('foo=bar; httpOnly')\n *   => { name: 'foo', value: 'bar', httpOnly: true }\n */\nexport function parseSetCookie(str: string, options?: ParseOptions): SetCookie {\n  const dec = options?.decode || decode;\n  const len = str.length;\n  const endIdx = endIndex(str, 0, len);\n  const eqIdx = eqIndex(str, 0, endIdx);\n  const setCookie: SetCookie =\n    eqIdx === -1\n      ? { name: \"\", value: dec(valueSlice(str, 0, endIdx)) }\n      : {\n          name: valueSlice(str, 0, eqIdx),\n          value: dec(valueSlice(str, eqIdx + 1, endIdx)),\n        };\n\n  let index = endIdx + 1;\n  while (index < len) {\n    const endIdx = endIndex(str, index, len);\n    const eqIdx = eqIndex(str, index, endIdx);\n    const attr =\n      eqIdx === -1\n        ? valueSlice(str, index, endIdx)\n        : valueSlice(str, index, eqIdx);\n    const val = eqIdx === -1 ? undefined : valueSlice(str, eqIdx + 1, endIdx);\n\n    switch (attr.toLowerCase()) {\n      case \"httponly\":\n        setCookie.httpOnly = true;\n        break;\n      case \"secure\":\n        setCookie.secure = true;\n        break;\n      case \"partitioned\":\n        setCookie.partitioned = true;\n        break;\n      case \"domain\":\n        setCookie.domain = val;\n        break;\n      case \"path\":\n        setCookie.path = val;\n        break;\n      case \"max-age\":\n        if (val && maxAgeRegExp.test(val)) setCookie.maxAge = Number(val);\n        break;\n      case \"expires\":\n        if (!val) break;\n        const date = new Date(val);\n        if (Number.isFinite(date.valueOf())) setCookie.expires = date;\n        break;\n      case \"priority\":\n        if (!val) break;\n        const priority = val.toLowerCase();\n        if (\n          priority === \"low\" ||\n          priority === \"medium\" ||\n          priority === \"high\"\n        ) {\n          setCookie.priority = priority;\n        }\n        break;\n      case \"samesite\":\n        if (!val) break;\n        const sameSite = val.toLowerCase();\n        if (\n          sameSite === \"lax\" ||\n          sameSite === \"strict\" ||\n          sameSite === \"none\"\n        ) {\n          setCookie.sameSite = sameSite;\n        }\n        break;\n    }\n\n    index = endIdx + 1;\n  }\n\n  return setCookie;\n}\n\n/**\n * Find the `;` character between `min` and `len` in str.\n */\nfunction endIndex(str: string, min: number, len: number) {\n  const index = str.indexOf(\";\", min);\n  return index === -1 ? len : index;\n}\n\n/**\n * Find the `=` character between `min` and `max` in str.\n */\nfunction eqIndex(str: string, min: number, max: number) {\n  const index = str.indexOf(\"=\", min);\n  return index < max ? index : -1;\n}\n\n/**\n * Slice out a value between startPod to max.\n */\nfunction valueSlice(str: string, min: number, max: number) {\n  let start = min;\n  let end = max;\n\n  do {\n    const code = str.charCodeAt(start);\n    if (code !== 0x20 /*   */ && code !== 0x09 /* \\t */) break;\n  } while (++start < end);\n\n  while (end > start) {\n    const code = str.charCodeAt(end - 1);\n    if (code !== 0x20 /*   */ && code !== 0x09 /* \\t */) break;\n    end--;\n  }\n\n  return str.slice(start, end);\n}\n\n/**\n * URL-decode string value. Optimized to skip native call when no %.\n */\nfunction decode(str: string): string {\n  if (str.indexOf(\"%\") === -1) return str;\n\n  try {\n    return decodeURIComponent(str);\n  } catch (e) {\n    return str;\n  }\n}\n\n/**\n * Determine if value is a Date.\n */\nfunction isDate(val: any): val is Date {\n  return __toString.call(val) === \"[object Date]\";\n}\n\n/**\n * Backward compatibility exports.\n */\nexport { stringifySetCookie as serialize, parseCookie as parse };\n","//# sourceMappingURL=types.js.map","import { cookies } from 'next/headers';\r\nimport { createServerClient, type CookieOptions } from '@supabase/ssr';\r\n\r\nexport async function getUserId(request: Request): Promise<string | null> {\r\n  console.log(\"[FRIENDREQ] getUserId called\");\r\n  \r\n  // Check if Supabase is enabled\r\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n  \r\n  if (supabaseUrl && supabaseAnonKey) {\r\n    console.log(\"[FRIENDREQ] Supabase enabled, checking session\");\r\n    try {\r\n      // Get cookies from the request\r\n      const cookieStore = await cookies();\r\n      \r\n      // Create Supabase server client\r\n      const supabase = createServerClient(\r\n        supabaseUrl,\r\n        supabaseAnonKey,\r\n        {\r\n          cookies: {\r\n            get(name: string) {\r\n              return cookieStore.get(name)?.value;\r\n            },\r\n          },\r\n        }\r\n      );\r\n\r\n      const { data: { session }, error } = await supabase.auth.getSession();\r\n      \r\n      if (error) {\r\n        console.log(\"[FRIENDREQ] Supabase session error:\", error.message);\r\n        return null;\r\n      }\r\n      \r\n      if (!session?.user) {\r\n        console.log(\"[FRIENDREQ] No Supabase session user found\");\r\n        return null;\r\n      }\r\n      \r\n      console.log(\"[FRIENDREQ] Found Supabase user:\", session.user.id);\r\n      return session.user.id;\r\n    } catch (error) {\r\n      console.log(\"[FRIENDREQ] Supabase auth error:\", error);\r\n      return null;\r\n    }\r\n  }\r\n  \r\n  // Local auth fallback - check headers and cookies\r\n  console.log(\"[FRIENDREQ] Using local auth fallback\");\r\n  \r\n  // Check x-user-id header\r\n  const userIdHeader = request.headers.get('x-user-id');\r\n  if (userIdHeader) {\r\n    console.log(\"[FRIENDREQ] Found user ID in header:\", userIdHeader);\r\n    return userIdHeader;\r\n  }\r\n  \r\n  // Check user_id cookie\r\n  const cookieStore = await cookies();\r\n  const userIdCookie = cookieStore.get('user_id')?.value;\r\n  if (userIdCookie) {\r\n    console.log(\"[FRIENDREQ] Found user ID in cookie:\", userIdCookie);\r\n    return userIdCookie;\r\n  }\r\n  \r\n  console.log(\"[FRIENDREQ] No user ID found in any source\");\r\n  return null;\r\n}","interface Chunk {\n  name: string;\n  value: string;\n}\n\nexport const MAX_CHUNK_SIZE = 3180;\n\nconst CHUNK_LIKE_REGEX = /^(.*)[.](0|[1-9][0-9]*)$/;\nexport function isChunkLike(cookieName: string, key: string) {\n  if (cookieName === key) {\n    return true;\n  }\n\n  const chunkLike = cookieName.match(CHUNK_LIKE_REGEX);\n  if (chunkLike && chunkLike[1] === key) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * create chunks from a string and return an array of object\n */\nexport function createChunks(\n  key: string,\n  value: string,\n  chunkSize?: number,\n): Chunk[] {\n  const resolvedChunkSize = chunkSize ?? MAX_CHUNK_SIZE;\n\n  let encodedValue = encodeURIComponent(value);\n\n  if (encodedValue.length <= resolvedChunkSize) {\n    return [{ name: key, value }];\n  }\n\n  const chunks: string[] = [];\n\n  while (encodedValue.length > 0) {\n    let encodedChunkHead = encodedValue.slice(0, resolvedChunkSize);\n\n    const lastEscapePos = encodedChunkHead.lastIndexOf(\"%\");\n\n    // Check if the last escaped character is truncated.\n    if (lastEscapePos > resolvedChunkSize - 3) {\n      // If so, reslice the string to exclude the whole escape sequence.\n      // We only reduce the size of the string as the chunk must\n      // be smaller than the chunk size.\n      encodedChunkHead = encodedChunkHead.slice(0, lastEscapePos);\n    }\n\n    let valueHead: string = \"\";\n\n    // Check if the chunk was split along a valid unicode boundary.\n    while (encodedChunkHead.length > 0) {\n      try {\n        // Try to decode the chunk back and see if it is valid.\n        // Stop when the chunk is valid.\n        valueHead = decodeURIComponent(encodedChunkHead);\n        break;\n      } catch (error) {\n        if (\n          error instanceof URIError &&\n          encodedChunkHead.at(-3) === \"%\" &&\n          encodedChunkHead.length > 3\n        ) {\n          encodedChunkHead = encodedChunkHead.slice(\n            0,\n            encodedChunkHead.length - 3,\n          );\n        } else {\n          throw error;\n        }\n      }\n    }\n\n    chunks.push(valueHead);\n    encodedValue = encodedValue.slice(encodedChunkHead.length);\n  }\n\n  return chunks.map((value, i) => ({ name: `${key}.${i}`, value }));\n}\n\n// Get fully constructed chunks\nexport async function combineChunks(\n  key: string,\n  retrieveChunk: (\n    name: string,\n  ) => Promise<string | null | undefined> | string | null | undefined,\n) {\n  const value = await retrieveChunk(key);\n\n  if (value) {\n    return value;\n  }\n\n  let values: string[] = [];\n\n  for (let i = 0; ; i++) {\n    const chunkName = `${key}.${i}`;\n    const chunk = await retrieveChunk(chunkName);\n\n    if (!chunk) {\n      break;\n    }\n\n    values.push(chunk);\n  }\n\n  if (values.length > 0) {\n    return values.join(\"\");\n  }\n\n  return null;\n}\n\nexport async function deleteChunks(\n  key: string,\n  retrieveChunk: (\n    name: string,\n  ) => Promise<string | null | undefined> | string | null | undefined,\n  removeChunk: (name: string) => Promise<void> | void,\n) {\n  const value = await retrieveChunk(key);\n\n  if (value) {\n    await removeChunk(key);\n  }\n\n  for (let i = 0; ; i++) {\n    const chunkName = `${key}.${i}`;\n    const chunk = await retrieveChunk(chunkName);\n\n    if (!chunk) {\n      break;\n    }\n\n    await removeChunk(chunkName);\n  }\n}\n","import { parse, serialize } from \"cookie\";\n\nimport {\n  DEFAULT_COOKIE_OPTIONS,\n  combineChunks,\n  createChunks,\n  isBrowser,\n  isChunkLike,\n  stringFromBase64URL,\n  stringToBase64URL,\n} from \"./utils\";\n\nimport type {\n  CookieMethodsServer,\n  CookieMethodsServerDeprecated,\n  CookieMethodsBrowser,\n  CookieMethodsBrowserDeprecated,\n  CookieOptions,\n  CookieOptionsWithName,\n  GetAllCookies,\n  SetAllCookies,\n} from \"./types\";\n\nconst BASE64_PREFIX = \"base64-\";\n\n/**\n * Creates a storage client that handles cookies correctly for browser and\n * server clients with or without properly provided cookie methods.\n *\n * @param options The options passed to createBrowserClient or createServer client.\n *\n * @param isServerClient Whether it's called from createServerClient.\n */\nexport function createStorageFromOptions(\n  options: {\n    cookieEncoding: \"raw\" | \"base64url\";\n    cookies?:\n      | CookieMethodsBrowser\n      | CookieMethodsBrowserDeprecated\n      | CookieMethodsServer\n      | CookieMethodsServerDeprecated;\n    cookieOptions?: CookieOptionsWithName;\n  },\n  isServerClient: boolean,\n) {\n  const cookies = options.cookies ?? null;\n  const cookieEncoding = options.cookieEncoding;\n\n  const setItems: { [key: string]: string } = {};\n  const removedItems: { [key: string]: boolean } = {};\n\n  let getAll: (keyHints: string[]) => ReturnType<GetAllCookies>;\n  let setAll: SetAllCookies;\n\n  if (cookies) {\n    if (\"get\" in cookies) {\n      // Just get is not enough, because the client needs to see what cookies\n      // are already set and unset them if necessary. To attempt to fix this\n      // behavior for most use cases, we pass \"hints\" which is the keys of the\n      // storage items. They are then converted to their corresponding cookie\n      // chunk names and are fetched with get. Only 5 chunks are fetched, which\n      // should be enough for the majority of use cases, but does not solve\n      // those with very large sessions.\n\n      const getWithHints = async (keyHints: string[]) => {\n        // optimistically find the first 5 potential chunks for the specified key\n        const chunkNames = keyHints.flatMap((keyHint) => [\n          keyHint,\n          ...Array.from({ length: 5 }).map((_, i) => `${keyHint}.${i}`),\n        ]);\n\n        const chunks: ReturnType<GetAllCookies> = [];\n\n        for (let i = 0; i < chunkNames.length; i += 1) {\n          const value = await cookies.get(chunkNames[i]);\n\n          if (!value && typeof value !== \"string\") {\n            continue;\n          }\n\n          chunks.push({ name: chunkNames[i], value });\n        }\n\n        // TODO: detect and log stale chunks error\n\n        return chunks;\n      };\n\n      getAll = async (keyHints: string[]) => await getWithHints(keyHints);\n\n      if (\"set\" in cookies && \"remove\" in cookies) {\n        setAll = async (setCookies) => {\n          for (let i = 0; i < setCookies.length; i += 1) {\n            const { name, value, options } = setCookies[i];\n\n            if (value) {\n              await cookies.set!(name, value, options);\n            } else {\n              await cookies.remove!(name, options);\n            }\n          }\n        };\n      } else if (isServerClient) {\n        setAll = async () => {\n          console.warn(\n            \"@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.\",\n          );\n        };\n      } else {\n        throw new Error(\n          \"@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)\",\n        );\n      }\n    } else if (\"getAll\" in cookies) {\n      getAll = async () => await cookies.getAll!();\n\n      if (\"setAll\" in cookies) {\n        setAll = cookies.setAll!;\n      } else if (isServerClient) {\n        setAll = async () => {\n          console.warn(\n            \"@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.\",\n          );\n        };\n      } else {\n        throw new Error(\n          \"@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)\",\n        );\n      }\n    } else {\n      // neither get nor getAll is present on cookies, only will occur if pure JavaScript is used, but cookies is an object\n      throw new Error(\n        `@supabase/ssr: ${isServerClient ? \"createServerClient\" : \"createBrowserClient\"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).${isBrowser() ? \" As this is called in a browser runtime, consider removing the cookies option object to use the document.cookie API automatically.\" : \"\"}`,\n      );\n    }\n  } else if (!isServerClient && isBrowser()) {\n    // The environment is browser, so use the document.cookie API to implement getAll and setAll.\n\n    const noHintGetAll = () => {\n      const parsed = parse(document.cookie);\n\n      return Object.keys(parsed).map((name) => ({\n        name,\n        value: parsed[name] ?? \"\",\n      }));\n    };\n\n    getAll = () => noHintGetAll();\n\n    setAll = (setCookies) => {\n      setCookies.forEach(({ name, value, options }) => {\n        document.cookie = serialize(name, value, options);\n      });\n    };\n  } else if (isServerClient) {\n    throw new Error(\n      \"@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)\",\n    );\n  } else {\n    // getting cookies when there's no window but we're in browser mode can be OK, because the developer probably is not using auth functions\n    getAll = () => {\n      return [];\n    };\n\n    // this is NOT OK because the developer is using auth functions that require setting some state, so that must error out\n    setAll = () => {\n      throw new Error(\n        \"@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed\",\n      );\n    };\n  }\n\n  if (!isServerClient) {\n    // This is the storage client to be used in browsers. It only\n    // works on the cookies abstraction, unlike the server client\n    // which only uses cookies to read the initial state. When an\n    // item is set, cookies are both cleared and set to values so\n    // that stale chunks are not left remaining.\n    return {\n      getAll, // for type consistency\n      setAll, // for type consistency\n      setItems, // for type consistency\n      removedItems, // for type consistency\n      storage: {\n        isServer: false,\n        getItem: async (key: string) => {\n          const allCookies = await getAll([key]);\n          const chunkedCookie = await combineChunks(\n            key,\n            async (chunkName: string) => {\n              const cookie =\n                allCookies?.find(({ name }) => name === chunkName) || null;\n\n              if (!cookie) {\n                return null;\n              }\n\n              return cookie.value;\n            },\n          );\n\n          if (!chunkedCookie) {\n            return null;\n          }\n\n          let decoded = chunkedCookie;\n\n          if (chunkedCookie.startsWith(BASE64_PREFIX)) {\n            decoded = stringFromBase64URL(\n              chunkedCookie.substring(BASE64_PREFIX.length),\n            );\n          }\n\n          return decoded;\n        },\n        setItem: async (key: string, value: string) => {\n          const allCookies = await getAll([key]);\n          const cookieNames = allCookies?.map(({ name }) => name) || [];\n\n          const removeCookies = new Set(\n            cookieNames.filter((name) => isChunkLike(name, key)),\n          );\n\n          let encoded = value;\n\n          if (cookieEncoding === \"base64url\") {\n            encoded = BASE64_PREFIX + stringToBase64URL(value);\n          }\n\n          const setCookies = createChunks(key, encoded);\n\n          setCookies.forEach(({ name }) => {\n            removeCookies.delete(name);\n          });\n\n          const removeCookieOptions = {\n            ...DEFAULT_COOKIE_OPTIONS,\n            ...options?.cookieOptions,\n            maxAge: 0,\n          };\n          const setCookieOptions = {\n            ...DEFAULT_COOKIE_OPTIONS,\n            ...options?.cookieOptions,\n            maxAge: DEFAULT_COOKIE_OPTIONS.maxAge,\n          };\n\n          // the NextJS cookieStore API can get confused if the `name` from\n          // options.cookieOptions leaks\n          delete removeCookieOptions.name;\n          delete setCookieOptions.name;\n\n          const allToSet = [\n            ...[...removeCookies].map((name) => ({\n              name,\n              value: \"\",\n              options: removeCookieOptions,\n            })),\n            ...setCookies.map(({ name, value }) => ({\n              name,\n              value,\n              options: setCookieOptions,\n            })),\n          ];\n\n          if (allToSet.length > 0) {\n            await setAll(allToSet);\n          }\n        },\n        removeItem: async (key: string) => {\n          const allCookies = await getAll([key]);\n          const cookieNames = allCookies?.map(({ name }) => name) || [];\n          const removeCookies = cookieNames.filter((name) =>\n            isChunkLike(name, key),\n          );\n\n          const removeCookieOptions = {\n            ...DEFAULT_COOKIE_OPTIONS,\n            ...options?.cookieOptions,\n            maxAge: 0,\n          };\n\n          // the NextJS cookieStore API can get confused if the `name` from\n          // options.cookieOptions leaks\n          delete removeCookieOptions.name;\n\n          if (removeCookies.length > 0) {\n            await setAll(\n              removeCookies.map((name) => ({\n                name,\n                value: \"\",\n                options: removeCookieOptions,\n              })),\n            );\n          }\n        },\n      },\n    };\n  }\n\n  // This is the server client. It only uses getAll to read the initial\n  // state. Any subsequent changes to the items is persisted in the\n  // setItems and removedItems objects. createServerClient *must* use\n  // getAll, setAll and the values in setItems and removedItems to\n  // persist the changes *at once* when appropriate (usually only when\n  // the TOKEN_REFRESHED, USER_UPDATED or SIGNED_OUT events are fired by\n  // the Supabase Auth client).\n  return {\n    getAll,\n    setAll,\n    setItems,\n    removedItems,\n    storage: {\n      // to signal to the libraries that these cookies are\n      // coming from a server environment and their value\n      // should not be trusted\n      isServer: true,\n      getItem: async (key: string) => {\n        if (typeof setItems[key] === \"string\") {\n          return setItems[key];\n        }\n\n        if (removedItems[key]) {\n          return null;\n        }\n\n        const allCookies = await getAll([key]);\n        const chunkedCookie = await combineChunks(\n          key,\n          async (chunkName: string) => {\n            const cookie =\n              allCookies?.find(({ name }) => name === chunkName) || null;\n\n            if (!cookie) {\n              return null;\n            }\n\n            return cookie.value;\n          },\n        );\n\n        if (!chunkedCookie) {\n          return null;\n        }\n\n        let decoded = chunkedCookie;\n\n        if (\n          typeof chunkedCookie === \"string\" &&\n          chunkedCookie.startsWith(BASE64_PREFIX)\n        ) {\n          decoded = stringFromBase64URL(\n            chunkedCookie.substring(BASE64_PREFIX.length),\n          );\n        }\n\n        return decoded;\n      },\n      setItem: async (key: string, value: string) => {\n        // We don't have an `onAuthStateChange` event that can let us know that\n        // the PKCE code verifier is being set. Therefore, if we see it being\n        // set, we need to apply the storage (call `setAll` so the cookie is\n        // set properly).\n        if (key.endsWith(\"-code-verifier\")) {\n          await applyServerStorage(\n            {\n              getAll,\n              setAll,\n              // pretend only that the code verifier was set\n              setItems: { [key]: value },\n              // pretend that nothing was removed\n              removedItems: {},\n            },\n            {\n              cookieOptions: options?.cookieOptions ?? null,\n              cookieEncoding,\n            },\n          );\n        }\n\n        setItems[key] = value;\n        delete removedItems[key];\n      },\n      removeItem: async (key: string) => {\n        // Intentionally not applying the storage when the key is the PKCE code\n        // verifier, as usually right after it's removed other items are set,\n        // so application of the storage will be handled by the\n        // `onAuthStateChange` callback that follows removal -- usually as part\n        // of the `exchangeCodeForSession` call.\n        delete setItems[key];\n        removedItems[key] = true;\n      },\n    },\n  };\n}\n\n/**\n * When createServerClient needs to apply the created storage to cookies, it\n * should call this function which handles correcly setting cookies for stored\n * and removed items in the storage.\n */\nexport async function applyServerStorage(\n  {\n    getAll,\n    setAll,\n    setItems,\n    removedItems,\n  }: {\n    getAll: (keyHints: string[]) => ReturnType<GetAllCookies>;\n    setAll: SetAllCookies;\n    setItems: { [name: string]: string };\n    removedItems: { [name: string]: boolean };\n  },\n  options: {\n    cookieEncoding: \"raw\" | \"base64url\";\n    cookieOptions?: CookieOptions | null;\n  },\n) {\n  const cookieEncoding = options.cookieEncoding;\n  const cookieOptions = options.cookieOptions ?? null;\n\n  const allCookies = await getAll([\n    ...(setItems ? (Object.keys(setItems) as string[]) : []),\n    ...(removedItems ? (Object.keys(removedItems) as string[]) : []),\n  ]);\n  const cookieNames = allCookies?.map(({ name }) => name) || [];\n\n  const removeCookies: string[] = Object.keys(removedItems).flatMap(\n    (itemName) => {\n      return cookieNames.filter((name) => isChunkLike(name, itemName));\n    },\n  );\n\n  const setCookies = Object.keys(setItems).flatMap((itemName) => {\n    const removeExistingCookiesForItem = new Set(\n      cookieNames.filter((name) => isChunkLike(name, itemName)),\n    );\n\n    let encoded = setItems[itemName];\n\n    if (cookieEncoding === \"base64url\") {\n      encoded = BASE64_PREFIX + stringToBase64URL(encoded);\n    }\n\n    const chunks = createChunks(itemName, encoded);\n\n    chunks.forEach((chunk) => {\n      removeExistingCookiesForItem.delete(chunk.name);\n    });\n\n    removeCookies.push(...removeExistingCookiesForItem);\n\n    return chunks;\n  });\n\n  const removeCookieOptions = {\n    ...DEFAULT_COOKIE_OPTIONS,\n    ...cookieOptions,\n    maxAge: 0,\n  };\n  const setCookieOptions = {\n    ...DEFAULT_COOKIE_OPTIONS,\n    ...cookieOptions,\n    maxAge: DEFAULT_COOKIE_OPTIONS.maxAge,\n  };\n\n  // the NextJS cookieStore API can get confused if the `name` from\n  // options.cookieOptions leaks\n  delete (removeCookieOptions as any).name;\n  delete (setCookieOptions as any).name;\n\n  await setAll([\n    ...removeCookies.map((name) => ({\n      name,\n      value: \"\",\n      options: removeCookieOptions,\n    })),\n    ...setCookies.map(({ name, value }) => ({\n      name,\n      value,\n      options: setCookieOptions,\n    })),\n  ]);\n}\n","import {\n  createClient,\n  SupabaseClient,\n  SupabaseClientOptions,\n} from \"@supabase/supabase-js\";\n\nimport { VERSION } from \"./version\";\nimport { isBrowser } from \"./utils\";\n\nimport type {\n  CookieMethodsBrowser,\n  CookieMethodsBrowserDeprecated,\n  CookieOptionsWithName,\n} from \"./types\";\n\nimport { createStorageFromOptions } from \"./cookies\";\n\nlet cachedBrowserClient: SupabaseClient<any, any, any> | undefined;\n\n/**\n * Creates a Supabase Client for use in a browser environment.\n *\n * In most cases you should not configure the `options.cookies` object, as this\n * is automatically handled for you. If you do customize this, prefer using the\n * `getAll` and `setAll` functions over `get`, `set` and `remove`. The latter\n * are deprecated due to being difficult to correctly implement and not\n * supporting some edge-cases. Both `getAll` and `setAll` (or both `get`, `set`\n * and `remove`) must be provided. Failing to provide the methods for setting\n * will throw an exception, and in previous versions of the library will result\n * in difficult to debug authentication issues such as random logouts, early\n * session termination or problems with inconsistent state.\n *\n * @param supabaseUrl The URL of the Supabase project.\n * @param supabaseKey The `anon` API key of the Supabase project.\n * @param options Various configuration options.\n */\nexport function createBrowserClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options?: SupabaseClientOptions<SchemaName> & {\n    cookies?: CookieMethodsBrowser;\n    cookieOptions?: CookieOptionsWithName;\n    cookieEncoding?: \"raw\" | \"base64url\";\n    isSingleton?: boolean;\n  },\n): SupabaseClient<Database, SchemaName>;\n\n/**\n * @deprecated Please specify `getAll` and `setAll` cookie methods instead of\n * the `get`, `set` and `remove`. These will not be supported in the next major\n * version.\n */\nexport function createBrowserClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options?: SupabaseClientOptions<SchemaName> & {\n    cookies: CookieMethodsBrowserDeprecated;\n    cookieOptions?: CookieOptionsWithName;\n    cookieEncoding?: \"raw\" | \"base64url\";\n    isSingleton?: boolean;\n  },\n): SupabaseClient<Database, SchemaName>;\n\nexport function createBrowserClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options?: SupabaseClientOptions<SchemaName> & {\n    cookies?: CookieMethodsBrowser | CookieMethodsBrowserDeprecated;\n    cookieOptions?: CookieOptionsWithName;\n    cookieEncoding?: \"raw\" | \"base64url\";\n    isSingleton?: boolean;\n  },\n): SupabaseClient<Database, SchemaName> {\n  // singleton client is created only if isSingleton is set to true, or if isSingleton is not defined and we detect a browser\n  const shouldUseSingleton =\n    options?.isSingleton === true ||\n    ((!options || !(\"isSingleton\" in options)) && isBrowser());\n\n  if (shouldUseSingleton && cachedBrowserClient) {\n    return cachedBrowserClient;\n  }\n\n  if (!supabaseUrl || !supabaseKey) {\n    throw new Error(\n      `@supabase/ssr: Your project's URL and API key are required to create a Supabase client!\\n\\nCheck your Supabase project's API settings to find these values\\n\\nhttps://supabase.com/dashboard/project/_/settings/api`,\n    );\n  }\n\n  const { storage } = createStorageFromOptions(\n    {\n      ...options,\n      cookieEncoding: options?.cookieEncoding ?? \"base64url\",\n    },\n    false,\n  );\n\n  const client = createClient<Database, SchemaName>(supabaseUrl, supabaseKey, {\n    // TODO: resolve type error\n    ...(options as any),\n    global: {\n      ...options?.global,\n      headers: {\n        ...options?.global?.headers,\n        \"X-Client-Info\": `supabase-ssr/${VERSION} createBrowserClient`,\n      },\n    },\n    auth: {\n      ...options?.auth,\n      ...(options?.cookieOptions?.name\n        ? { storageKey: options.cookieOptions.name }\n        : null),\n      flowType: \"pkce\",\n      autoRefreshToken: isBrowser(),\n      detectSessionInUrl: isBrowser(),\n      persistSession: true,\n      storage,\n      ...(options?.cookies &&\n      \"encode\" in options.cookies &&\n      options.cookies.encode === \"tokens-only\"\n        ? {\n            userStorage: options?.auth?.userStorage ?? window.localStorage,\n          }\n        : null),\n    },\n  });\n\n  if (shouldUseSingleton) {\n    cachedBrowserClient = client;\n  }\n\n  return client;\n}\n","import {\n  AuthChangeEvent,\n  createClient,\n  SupabaseClient,\n  SupabaseClientOptions,\n} from \"@supabase/supabase-js\";\n\nimport { VERSION } from \"./version\";\nimport { createStorageFromOptions, applyServerStorage } from \"./cookies\";\nimport type {\n  CookieOptionsWithName,\n  CookieMethodsServer,\n  CookieMethodsServerDeprecated,\n} from \"./types\";\nimport { memoryLocalStorageAdapter } from \"./utils/helpers\";\n\n/**\n * @deprecated Please specify `getAll` and `setAll` cookie methods instead of\n * the `get`, `set` and `remove`. These will not be supported in the next major\n * version.\n */\nexport function createServerClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options: SupabaseClientOptions<SchemaName> & {\n    cookieOptions?: CookieOptionsWithName;\n    cookies: CookieMethodsServerDeprecated;\n    cookieEncoding?: \"raw\" | \"base64url\";\n  },\n): SupabaseClient<Database, SchemaName>;\n\n/**\n * Creates a Supabase Client for use on the server-side of a server-side\n * rendering (SSR) framework.\n *\n * There are two categories of uses for this function: use in middlewares and\n * use in pages, components or routes.\n *\n * **Use in middlewares.**\n *\n * Middlewares are functions that run before any rendering logic is executed on\n * the server-side. They typically have access to request headers (cookies) and\n * can modify both the request and response headers.\n *\n * In most SSR frameworks, to use Supabase correctly you *must set up a\n * middleware* and use this function in it.\n *\n * When using this in a middleware, the `cookie` option must be configured to\n * use both `getAll` and `setAll`. Alternatively you can use the `get`, `set`\n * and `remove` functions. The latter are deprecated **and not recommended**\n * for most use cases due to being difficult to use properly and they do not\n * cover important edge cases. In future major versions of the library, the\n * option to configure `get`, `set` and `remove` will be removed.\n *\n * **IMPORTANT:** Failing to implement `getAll` and `setAll` correctly (or the\n * deprecated `get`, `set` and `remove`) including omitting them **will cause\n * significant and difficult to debug authentication issues**. They will\n * manifest as: random logouts, early session termination, JSON parsing errors,\n * increased number of refresh token requests, or relying on garbage state.\n *\n * **Use in pages, components or routes.**\n *\n * To use Supabase features server-side rendered in pages, components or routes\n * (a.k.a. actions / APIs) you must create a client with this function. Not all\n * frameworks allow the ability to set cookies or response headers when pages\n * or components are rendered. In those cases you _can omit `setAll` (or the\n * deprecated `set`, `remove`) cookie option methods_. **It is strongly\n * recommended that if the ability to set cookies and response headers is\n * present, you should configure the `setAll` (or the deprecated `set` and\n * `remove`) cookie access methods.**\n *\n * **IMPORTANT:** If the ability to set cookies or response headers is not\n * available **middleware or an equivalent must be used.** Failing to do this\n * will cause significant and difficult to debug authentication issues.\n *\n * When `setAll` (or the deprecated `set`, `remove`) cookie methods are not\n * configured, the Supabase Client will emit a warning if it is used in a way\n * that requires setting cookies. If you see this warning, it usually means\n * that you are using the Supabase Client in a wrong way:\n *\n * - You should have, but did not configure a middleware client.\n * - There is a bug in your middleware function.\n * - You are using features of the Supabase Client that change the User, e.g.\n *   by calling `supabase.auth.updateUser()` on the server.\n *\n * Please consult the latest Supabase guides for advice on how to avoid common\n * pitfalls depending on SSR framework.\n *\n * @param supabaseUrl The URL of the Supabase project.\n * @param supabaseKey The `anon` API key of the Supabase project.\n * @param options Various configuration options.\n */\nexport function createServerClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options: SupabaseClientOptions<SchemaName> & {\n    cookieOptions?: CookieOptionsWithName;\n    cookies: CookieMethodsServer;\n    cookieEncoding?: \"raw\" | \"base64url\";\n  },\n): SupabaseClient<Database, SchemaName>;\n\nexport function createServerClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options: SupabaseClientOptions<SchemaName> & {\n    cookieOptions?: CookieOptionsWithName;\n    cookies: CookieMethodsServer | CookieMethodsServerDeprecated;\n    cookieEncoding?: \"raw\" | \"base64url\";\n  },\n): SupabaseClient<Database, SchemaName> {\n  if (!supabaseUrl || !supabaseKey) {\n    throw new Error(\n      `Your project's URL and Key are required to create a Supabase client!\\n\\nCheck your Supabase project's API settings to find these values\\n\\nhttps://supabase.com/dashboard/project/_/settings/api`,\n    );\n  }\n\n  const { storage, getAll, setAll, setItems, removedItems } =\n    createStorageFromOptions(\n      {\n        ...options,\n        cookieEncoding: options?.cookieEncoding ?? \"base64url\",\n      },\n      true,\n    );\n\n  const client = createClient<Database, SchemaName>(supabaseUrl, supabaseKey, {\n    // TODO: resolve type error\n    ...(options as any),\n    global: {\n      ...options?.global,\n      headers: {\n        ...options?.global?.headers,\n        \"X-Client-Info\": `supabase-ssr/${VERSION} createServerClient`,\n      },\n    },\n    auth: {\n      ...(options?.cookieOptions?.name\n        ? { storageKey: options.cookieOptions.name }\n        : null),\n      ...options?.auth,\n      flowType: \"pkce\",\n      autoRefreshToken: false,\n      detectSessionInUrl: false,\n      persistSession: true,\n      storage,\n      ...(options?.cookies &&\n      \"encode\" in options.cookies &&\n      options.cookies.encode === \"tokens-only\"\n        ? {\n            userStorage:\n              options?.auth?.userStorage ?? memoryLocalStorageAdapter(),\n          }\n        : null),\n    },\n  });\n\n  client.auth.onAuthStateChange(async (event: AuthChangeEvent) => {\n    // The SIGNED_IN event is fired very often, but we don't need to\n    // apply the storage each time it fires, only if there are changes\n    // that need to be set -- which is if setItems / removeItems have\n    // data.\n    const hasStorageChanges =\n      Object.keys(setItems).length > 0 || Object.keys(removedItems).length > 0;\n\n    if (\n      hasStorageChanges &&\n      (event === \"SIGNED_IN\" ||\n        event === \"TOKEN_REFRESHED\" ||\n        event === \"USER_UPDATED\" ||\n        event === \"PASSWORD_RECOVERY\" ||\n        event === \"SIGNED_OUT\" ||\n        event === \"MFA_CHALLENGE_VERIFIED\")\n    ) {\n      await applyServerStorage(\n        { getAll, setAll, setItems, removedItems },\n        {\n          cookieOptions: options?.cookieOptions ?? null,\n          cookieEncoding: options?.cookieEncoding ?? \"base64url\",\n        },\n      );\n    }\n  });\n\n  return client;\n}\n","import type { SerializeOptions } from \"cookie\";\nimport * as cookie from \"cookie\";\n\n/**\n * @deprecated Since v0.4.0: Please use {@link parseCookieHeader}. `parse` will\n * not be available for import starting v1.0.0 of `@supabase/ssr`.\n */\nexport const parse = cookie.parse;\n\n/**\n * @deprecated Since v0.4.0: Please use {@link serializeCookieHeader}.\n * `serialize` will not be available for import starting v1.0.0 of\n * `@supabase/ssr`.\n */\nexport const serialize = cookie.serialize;\n\n/**\n * Parses the `Cookie` HTTP header into an array of cookie name-value objects.\n *\n * @param header The `Cookie` HTTP header. Decodes cookie names and values from\n * URI encoding first.\n */\nexport function parseCookieHeader(\n  header: string,\n): { name: string; value?: string }[] {\n  const parsed = cookie.parse(header);\n\n  return Object.keys(parsed ?? {}).map((name) => ({\n    name,\n    value: parsed[name],\n  }));\n}\n\n/**\n * Converts the arguments to a valid `Set-Cookie` header. Non US-ASCII chars\n * and other forbidden cookie chars will be URI encoded.\n *\n * @param name Name of cookie.\n * @param value Value of cookie.\n */\nexport function serializeCookieHeader(\n  name: string,\n  value: string,\n  options: SerializeOptions,\n): string {\n  return cookie.serialize(name, value, options);\n}\n\nexport function isBrowser() {\n  return (\n    typeof window !== \"undefined\" && typeof window.document !== \"undefined\"\n  );\n}\n\n/**\n * Returns a localStorage-like object that stores the key-value pairs in\n * memory.\n */\nexport function memoryLocalStorageAdapter(\n  store: { [key: string]: string } = {},\n) {\n  return {\n    getItem: (key: string) => {\n      return store[key] || null;\n    },\n\n    setItem: (key: string, value: string) => {\n      store[key] = value;\n    },\n\n    removeItem: (key: string) => {\n      delete store[key];\n    },\n  };\n}\n","export * from \"./helpers\";\nexport * from \"./constants\";\nexport * from \"./chunker\";\nexport * from \"./base64url\";\n","export const VERSION = '0.8.0';\n","import { CookieOptions } from \"../types\";\n\nexport const DEFAULT_COOKIE_OPTIONS: CookieOptions = {\n  path: \"/\",\n  sameSite: \"lax\",\n  httpOnly: false,\n  // https://developer.chrome.com/blog/cookie-max-age-expires\n  // https://httpwg.org/http-extensions/draft-ietf-httpbis-rfc6265bis.html#name-cookie-lifetime-limits\n  maxAge: 400 * 24 * 60 * 60,\n};\n","// Check if this package is being used as one of the deprecated auth-helpers packages\nif (typeof process !== \"undefined\" && process.env?.npm_package_name) {\n  const packageName = process.env.npm_package_name;\n  const deprecatedPackages = [\n    \"@supabase/auth-helpers-nextjs\",\n    \"@supabase/auth-helpers-react\",\n    \"@supabase/auth-helpers-remix\",\n    \"@supabase/auth-helpers-sveltekit\",\n  ];\n\n  if (deprecatedPackages.includes(packageName)) {\n    console.warn(`\n\n   IMPORTANT: Package Consolidation Notice                                \n                                                                            \n The ${packageName.padEnd(35)} package name is deprecated.  \n                                                                            \n You are now using @supabase/ssr - a unified solution for all frameworks.  \n                                                                            \n The auth-helpers packages have been consolidated into @supabase/ssr       \n to provide better maintenance and consistent APIs across frameworks.      \n                                                                            \n Please update your package.json to use @supabase/ssr directly:            \n   npm uninstall ${packageName.padEnd(42)} \n   npm install @supabase/ssr                                               \n                                                                            \n For more information, visit:                                              \n https://supabase.com/docs/guides/auth/server-side                         \n\n    `);\n  }\n}\n\nexport * from \"./createBrowserClient\";\nexport * from \"./createServerClient\";\nexport * from \"./types\";\nexport * from \"./utils\";\n","import { CommunityDB, Profile, FriendRequest, Friend, Conversation, ConversationMember, Message, Block, Report } from './types';\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\nexport class SupabaseDB implements CommunityDB {\r\n  private supabase;\r\n  private DEBUG_COMMUNITY = process.env.DEBUG_COMMUNITY === 'true';\r\n\r\n  constructor() {\r\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n    const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n    \r\n    if (!supabaseUrl || !supabaseAnonKey) {\r\n      throw new Error('Supabase URL and Anon Key are required');\r\n    }\r\n    \r\n    this.supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n  }\r\n\r\n  // Profiles\r\n  async getProfile(userId: string): Promise<Profile | null> {\r\n    const { data, error } = await this.supabase\r\n      .from('profiles')\r\n      .select('*')\r\n      .eq('id', userId)\r\n      .single();\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] getProfile error', error);\r\n      }\r\n      return null;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] getProfile', { userId, profile: data ? 'found' : 'not found' });\r\n    }\r\n    return data as Profile;\r\n  }\r\n\r\n  async updateProfile(userId: string, data: Partial<Omit<Profile, 'id' | 'created_at'>>): Promise<Profile> {\r\n    const { data: updatedData, error } = await this.supabase\r\n      .from('profiles')\r\n      .update({\r\n        ...data,\r\n        last_seen_at: new Date().toISOString(),\r\n      })\r\n      .eq('id', userId)\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] updateProfile error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] updateProfile', { userId, data });\r\n    }\r\n    return updatedData as Profile;\r\n  }\r\n\r\n  async searchProfiles(query: string): Promise<Profile[]> {\r\n    const { data, error } = await this.supabase\r\n      .from('profiles')\r\n      .select('*')\r\n      .or(`username.ilike.%${query}%,display_name.ilike.%${query}%`);\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] searchProfiles error', error);\r\n      }\r\n      return [];\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] searchProfiles', { query, results: data?.length || 0 });\r\n    }\r\n    return data as Profile[];\r\n  }\r\n\r\n  // Friend Requests\r\n  async createFriendRequest(requesterId: string, addresseeId: string): Promise<FriendRequest> {\r\n    const newRequest = {\r\n      id: crypto.randomUUID(),\r\n      requester_id: requesterId,\r\n      addressee_id: addresseeId,\r\n      status: 'pending',\r\n      created_at: new Date().toISOString(),\r\n      updated_at: new Date().toISOString(),\r\n    };\r\n\r\n    const { data, error } = await this.supabase\r\n      .from('friend_requests')\r\n      .insert([newRequest])\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] createFriendRequest error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] createFriendRequest', { requesterId, addresseeId, requestId: data.id });\r\n    }\r\n    return data as FriendRequest;\r\n  }\r\n\r\n  async updateFriendRequest(requestId: string, status: 'accepted' | 'declined' | 'cancelled'): Promise<FriendRequest> {\r\n    const { data, error } = await this.supabase\r\n      .from('friend_requests')\r\n      .update({ \r\n        status,\r\n        updated_at: new Date().toISOString()\r\n      })\r\n      .eq('id', requestId)\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] updateFriendRequest error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    // If accepted, create friendship entries\r\n    if (status === 'accepted' && data) {\r\n      const request = data as FriendRequest;\r\n      const friendEntry1 = {\r\n        user_id: request.requester_id,\r\n        friend_id: request.addressee_id,\r\n        created_at: new Date().toISOString(),\r\n      };\r\n      const friendEntry2 = {\r\n        user_id: request.addressee_id,\r\n        friend_id: request.requester_id,\r\n        created_at: new Date().toISOString(),\r\n      };\r\n\r\n      await this.supabase.from('friends').insert([friendEntry1, friendEntry2]);\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] updateFriendRequest', { requestId, status });\r\n    }\r\n    return data as FriendRequest;\r\n  }\r\n\r\n  async getFriendRequests(userId: string): Promise<FriendRequest[]> {\r\n    const { data, error } = await this.supabase\r\n      .from('friend_requests')\r\n      .select('*')\r\n      .or(`requester_id.eq.${userId},addressee_id.eq.${userId}`);\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] getFriendRequests error', error);\r\n      }\r\n      return [];\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] getFriendRequests', { userId, count: data?.length || 0 });\r\n    }\r\n    return data as FriendRequest[];\r\n  }\r\n\r\n  // Friends\r\n  async getFriends(userId: string): Promise<Friend[]> {\r\n    const { data, error } = await this.supabase\r\n      .from('friends')\r\n      .select('*')\r\n      .eq('user_id', userId);\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] getFriends error', error);\r\n      }\r\n      return [];\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] getFriends', { userId, count: data?.length || 0 });\r\n    }\r\n    return data as Friend[];\r\n  }\r\n\r\n  async unfriend(userId: string, friendId: string): Promise<void> {\r\n    await this.supabase\r\n      .from('friends')\r\n      .delete()\r\n      .or(`(user_id.eq.${userId},friend_id.eq.${friendId}),(user_id.eq.${friendId},friend_id.eq.${userId})`);\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] unfriend', { userId, friendId });\r\n    }\r\n  }\r\n\r\n  // Conversations\r\n  async createConversation(isGroup: boolean, createdBy: string, title?: string, userIds?: string[]): Promise<Conversation> {\r\n    const newConversation = {\r\n      id: crypto.randomUUID(),\r\n      is_group: isGroup,\r\n      title: title || (isGroup ? 'Group Chat' : undefined),\r\n      created_by: createdBy,\r\n      created_at: new Date().toISOString(),\r\n      updated_at: new Date().toISOString(),\r\n    };\r\n\r\n    const { data, error } = await this.supabase\r\n      .from('conversations')\r\n      .insert([newConversation])\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] createConversation error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    // Add creator as member\r\n    await this.supabase.from('conversation_members').insert([\r\n      {\r\n        conversation_id: data.id,\r\n        user_id: createdBy,\r\n        role: 'owner',\r\n        joined_at: new Date().toISOString(),\r\n      }\r\n    ]);\r\n\r\n    // Add other users if provided\r\n    if (userIds) {\r\n      for (const userId of userIds) {\r\n        if (userId !== createdBy) {\r\n          await this.supabase.from('conversation_members').insert([\r\n            {\r\n              conversation_id: data.id,\r\n              user_id: userId,\r\n              role: 'member',\r\n              joined_at: new Date().toISOString(),\r\n            }\r\n          ]);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] createConversation', { isGroup, createdBy, title, userIds, conversationId: data.id });\r\n    }\r\n    return data as Conversation;\r\n  }\r\n\r\n  async getConversations(userId: string): Promise<Conversation[]> {\r\n    const { data, error } = await this.supabase\r\n      .from('conversation_members')\r\n      .select('conversation_id')\r\n      .eq('user_id', userId);\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] getConversations error', error);\r\n      }\r\n      return [];\r\n    }\r\n\r\n    const conversationIds = data.map(cm => cm.conversation_id);\r\n\r\n    const { data: conversations, error: convError } = await this.supabase\r\n      .from('conversations')\r\n      .select('*')\r\n      .in('id', conversationIds);\r\n\r\n    if (convError) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] getConversations error fetching conversations', convError);\r\n      }\r\n      return [];\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] getConversations', { userId, count: conversations?.length || 0 });\r\n    }\r\n    return conversations as Conversation[];\r\n  }\r\n\r\n  async getConversation(conversationId: string): Promise<Conversation | null> {\r\n    const { data, error } = await this.supabase\r\n      .from('conversations')\r\n      .select('*')\r\n      .eq('id', conversationId)\r\n      .single();\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] getConversation error', error);\r\n      }\r\n      return null;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] getConversation', { conversationId, found: !!data });\r\n    }\r\n    return data as Conversation;\r\n  }\r\n\r\n  async addConversationMember(conversationId: string, userId: string, role: 'owner' | 'admin' | 'member' = 'member'): Promise<void> {\r\n    const { error } = await this.supabase\r\n      .from('conversation_members')\r\n      .insert([\r\n        {\r\n          conversation_id: conversationId,\r\n          user_id: userId,\r\n          role,\r\n          joined_at: new Date().toISOString(),\r\n        }\r\n      ]);\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] addConversationMember error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] addConversationMember', { conversationId, userId, role });\r\n    }\r\n  }\r\n\r\n  async removeConversationMember(conversationId: string, userId: string): Promise<void> {\r\n    const { error } = await this.supabase\r\n      .from('conversation_members')\r\n      .delete()\r\n      .match({ conversation_id: conversationId, user_id: userId });\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] removeConversationMember error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] removeConversationMember', { conversationId, userId });\r\n    }\r\n  }\r\n\r\n  async updateConversation(conversationId: string, data: Partial<Omit<Conversation, 'id' | 'created_by' | 'created_at'>>): Promise<void> {\r\n    const { error } = await this.supabase\r\n      .from('conversations')\r\n      .update({\r\n        ...data,\r\n        updated_at: new Date().toISOString(),\r\n      })\r\n      .eq('id', conversationId);\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] updateConversation error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] updateConversation', { conversationId, data });\r\n    }\r\n  }\r\n\r\n  // Messages\r\n  async createMessage(message: Omit<Message, 'id' | 'created_at'>): Promise<Message> {\r\n    const newMessage = {\r\n      ...message,\r\n      id: crypto.randomUUID(),\r\n      created_at: new Date().toISOString(),\r\n    };\r\n\r\n    const { data, error } = await this.supabase\r\n      .from('messages')\r\n      .insert([newMessage])\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] createMessage error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] createMessage', { conversationId: message.conversation_id, senderId: message.sender_id, messageId: data.id });\r\n    }\r\n    return data as Message;\r\n  }\r\n\r\n  async getMessages(conversationId: string, offset: number = 0, limit: number = 50): Promise<Message[]> {\r\n    const { data, error } = await this.supabase\r\n      .from('messages')\r\n      .select('*')\r\n      .eq('conversation_id', conversationId)\r\n      .is('deleted_at', null)\r\n      .order('created_at', { ascending: true })\r\n      .range(offset, offset + limit - 1);\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] getMessages error', error);\r\n      }\r\n      return [];\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] getMessages', { conversationId, offset, limit, count: data?.length || 0 });\r\n    }\r\n    return data as Message[];\r\n  }\r\n\r\n  async updateMessage(messageId: string, body: string): Promise<Message> {\r\n    const { data, error } = await this.supabase\r\n      .from('messages')\r\n      .update({ \r\n        body,\r\n        edited_at: new Date().toISOString(),\r\n      })\r\n      .eq('id', messageId)\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] updateMessage error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] updateMessage', { messageId, body });\r\n    }\r\n    return data as Message;\r\n  }\r\n\r\n  async deleteMessage(messageId: string): Promise<void> {\r\n    const { error } = await this.supabase\r\n      .from('messages')\r\n      .update({ deleted_at: new Date().toISOString() })\r\n      .eq('id', messageId);\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] deleteMessage error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] deleteMessage', { messageId });\r\n    }\r\n  }\r\n\r\n  // Blocks\r\n  async blockUser(blockerId: string, blockedId: string): Promise<void> {\r\n    const block = {\r\n      blocker_id: blockerId,\r\n      blocked_id: blockedId,\r\n      created_at: new Date().toISOString(),\r\n    };\r\n\r\n    const { error } = await this.supabase\r\n      .from('blocks')\r\n      .insert([block]);\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] blockUser error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] blockUser', { blockerId, blockedId });\r\n    }\r\n  }\r\n\r\n  async unblockUser(blockerId: string, blockedId: string): Promise<void> {\r\n    const { error } = await this.supabase\r\n      .from('blocks')\r\n      .delete()\r\n      .match({ blocker_id: blockerId, blocked_id: blockedId });\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] unblockUser error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] unblockUser', { blockerId, blockedId });\r\n    }\r\n  }\r\n\r\n  async isBlocked(blockerId: string, blockedId: string): Promise<boolean> {\r\n    const { data, error } = await this.supabase\r\n      .from('blocks')\r\n      .select('id')\r\n      .match({ blocker_id: blockerId, blocked_id: blockedId })\r\n      .single();\r\n\r\n    if (error && error.code !== 'PGRST116') { // PGRST116 means no rows returned\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] isBlocked error', error);\r\n      }\r\n      return false;\r\n    }\r\n\r\n    const isBlocked = !!data;\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] isBlocked', { blockerId, blockedId, isBlocked });\r\n    }\r\n    return isBlocked;\r\n  }\r\n\r\n  // Reports\r\n  async reportUser(reporterId: string, reportedUserId: string, reason: string): Promise<Report> {\r\n    const newReport = {\r\n      id: crypto.randomUUID(),\r\n      reporter_id: reporterId,\r\n      reported_user_id: reportedUserId,\r\n      reason,\r\n      created_at: new Date().toISOString(),\r\n    };\r\n\r\n    const { data, error } = await this.supabase\r\n      .from('reports')\r\n      .insert([newReport])\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] reportUser error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] reportUser', { reporterId, reportedUserId, reason });\r\n    }\r\n    return data as Report;\r\n  }\r\n\r\n  async reportMessage(reporterId: string, messageId: string, reason: string): Promise<Report> {\r\n    const newReport = {\r\n      id: crypto.randomUUID(),\r\n      reporter_id: reporterId,\r\n      message_id: messageId,\r\n      reason,\r\n      created_at: new Date().toISOString(),\r\n    };\r\n\r\n    const { data, error } = await this.supabase\r\n      .from('reports')\r\n      .insert([newReport])\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] reportMessage error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] reportMessage', { reporterId, messageId, reason });\r\n    }\r\n    return data as Report;\r\n  }\r\n\r\n  // Typing Indicators (ephemeral, not stored long term)\r\n  setTypingStatus(conversationId: string, userId: string, isTyping: boolean): void {\r\n    // In Supabase mode, we'll use Supabase Realtime for typing indicators\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] setTypingStatus', { conversationId, userId, isTyping });\r\n    }\r\n  }\r\n\r\n  async getTypingUsers(conversationId: string): Promise<string[]> {\r\n    // In Supabase mode, typing indicators would be handled via Realtime subscriptions\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] getTypingUsers', { conversationId });\r\n    }\r\n    return [];\r\n  }\r\n\r\n  // Read Receipts\r\n  async markAsRead(conversationId: string, userId: string, lastReadAt: string): Promise<void> {\r\n    const { error } = await this.supabase\r\n      .from('conversation_members')\r\n      .update({ last_read_at: lastReadAt })\r\n      .match({ conversation_id: conversationId, user_id: userId });\r\n\r\n    if (error) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] markAsRead error', error);\r\n      }\r\n      throw error;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] markAsRead', { conversationId, userId, lastReadAt });\r\n    }\r\n  }\r\n\r\n  async getUnreadCount(conversationId: string, userId: string): Promise<number> {\r\n    // Get the last read time for this user in this conversation\r\n    const { data: member, error: memberError } = await this.supabase\r\n      .from('conversation_members')\r\n      .select('last_read_at')\r\n      .match({ conversation_id: conversationId, user_id: userId })\r\n      .single();\r\n\r\n    if (memberError) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] getUnreadCount error getting member', memberError);\r\n      }\r\n      return 0;\r\n    }\r\n\r\n    const lastReadAt = member?.last_read_at ? new Date(member.last_read_at) : new Date(0);\r\n\r\n    // Count messages sent after last read time by other users\r\n    const { count, error: countError } = await this.supabase\r\n      .from('messages')\r\n      .select('*', { count: 'exact', head: true })\r\n      .eq('conversation_id', conversationId)\r\n      .gt('created_at', lastReadAt.toISOString())\r\n      .neq('sender_id', userId) // Don't count own messages as unread\r\n      .is('deleted_at', null);\r\n\r\n    if (countError) {\r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.error('[COMMUNITY][SupabaseDB] getUnreadCount error getting count', countError);\r\n      }\r\n      return 0;\r\n    }\r\n\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][SupabaseDB] getUnreadCount', { conversationId, userId, unreadCount: count });\r\n    }\r\n    return count || 0;\r\n  }\r\n}","import { LocalDB } from './LocalDB';\r\nimport { SupabaseDB } from './SupabaseDB';\r\nimport { Profile, FriendRequest, Friend, Conversation, ConversationMember, Message, Block, Report, CommunityDB } from './types';\r\n\r\n// Ensure the classes are imported before being used in the factory function\r\nexport { LocalDB, SupabaseDB };\r\nexport type { Profile, FriendRequest, Friend, Conversation, ConversationMember, Message, Block, Report, CommunityDB };\r\n\r\nlet dbInstance: CommunityDB | null = null;\r\n\r\nexport const getCommunityDB = async (): Promise<CommunityDB> => {\r\n  if (dbInstance) {\r\n    return dbInstance;\r\n  }\r\n\r\n  const DEBUG_COMMUNITY = process.env.DEBUG_COMMUNITY === 'true';\r\n  \r\n  // Check if Supabase is available\r\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n  \r\n  if (supabaseUrl) {\r\n    try {\r\n      const response = await fetch(`${supabaseUrl}/auth/v1/health`);\r\n      if (response.ok) {\r\n        if (DEBUG_COMMUNITY) {\r\n          console.log('[COMMUNITY] Using SupabaseDB backend');\r\n        }\r\n        dbInstance = new SupabaseDB();\r\n        return dbInstance as CommunityDB;\r\n      }\r\n    } catch (error) {\r\n      if (DEBUG_COMMUNITY) {\r\n        console.log('[COMMUNITY] Supabase not reachable, using LocalDB backend');\r\n      }\r\n    }\r\n  }\r\n  \r\n  if (DEBUG_COMMUNITY) {\r\n    console.log('[COMMUNITY] Using LocalDB backend');\r\n  }\r\n  dbInstance = new LocalDB();\r\n  return dbInstance!;\r\n};","/**\n * Avoid modifying this file. It's part of\n * https://github.com/supabase-community/base64url-js.  Submit all fixes on\n * that repo!\n */\n\n/**\n * An array of characters that encode 6 bits into a Base64-URL alphabet\n * character.\n */\nconst TO_BASE64URL =\n  \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\".split(\"\");\n\n/**\n * An array of characters that can appear in a Base64-URL encoded string but\n * should be ignored.\n */\nconst IGNORE_BASE64URL = \" \\t\\n\\r=\".split(\"\");\n\n/**\n * An array of 128 numbers that map a Base64-URL character to 6 bits, or if -2\n * used to skip the character, or if -1 used to error out.\n */\nconst FROM_BASE64URL = (() => {\n  const charMap: number[] = new Array(128);\n\n  for (let i = 0; i < charMap.length; i += 1) {\n    charMap[i] = -1;\n  }\n\n  for (let i = 0; i < IGNORE_BASE64URL.length; i += 1) {\n    charMap[IGNORE_BASE64URL[i].charCodeAt(0)] = -2;\n  }\n\n  for (let i = 0; i < TO_BASE64URL.length; i += 1) {\n    charMap[TO_BASE64URL[i].charCodeAt(0)] = i;\n  }\n\n  return charMap;\n})();\n\n/**\n * Converts a JavaScript string (which may include any valid character) into a\n * Base64-URL encoded string. The string is first encoded in UTF-8 which is\n * then encoded as Base64-URL.\n *\n * @param str The string to convert.\n */\nexport function stringToBase64URL(str: string) {\n  const base64: string[] = [];\n\n  let queue = 0;\n  let queuedBits = 0;\n\n  const emitter = (byte: number) => {\n    queue = (queue << 8) | byte;\n    queuedBits += 8;\n\n    while (queuedBits >= 6) {\n      const pos = (queue >> (queuedBits - 6)) & 63;\n      base64.push(TO_BASE64URL[pos]);\n      queuedBits -= 6;\n    }\n  };\n\n  stringToUTF8(str, emitter);\n\n  if (queuedBits > 0) {\n    queue = queue << (6 - queuedBits);\n    queuedBits = 6;\n\n    while (queuedBits >= 6) {\n      const pos = (queue >> (queuedBits - 6)) & 63;\n      base64.push(TO_BASE64URL[pos]);\n      queuedBits -= 6;\n    }\n  }\n\n  return base64.join(\"\");\n}\n\n/**\n * Converts a Base64-URL encoded string into a JavaScript string. It is assumed\n * that the underlying string has been encoded as UTF-8.\n *\n * @param str The Base64-URL encoded string.\n */\nexport function stringFromBase64URL(str: string) {\n  const conv: string[] = [];\n\n  const emit = (codepoint: number) => {\n    conv.push(String.fromCodePoint(codepoint));\n  };\n\n  const state = {\n    utf8seq: 0,\n    codepoint: 0,\n  };\n\n  let queue = 0;\n  let queuedBits = 0;\n\n  for (let i = 0; i < str.length; i += 1) {\n    const codepoint = str.charCodeAt(i);\n    const bits = FROM_BASE64URL[codepoint];\n\n    if (bits > -1) {\n      // valid Base64-URL character\n      queue = (queue << 6) | bits;\n      queuedBits += 6;\n\n      while (queuedBits >= 8) {\n        stringFromUTF8((queue >> (queuedBits - 8)) & 0xff, state, emit);\n        queuedBits -= 8;\n      }\n    } else if (bits === -2) {\n      // ignore spaces, tabs, newlines, =\n      continue;\n    } else {\n      throw new Error(\n        `Invalid Base64-URL character \"${str.at(i)}\" at position ${i}`,\n      );\n    }\n  }\n\n  return conv.join(\"\");\n}\n\n/**\n * Converts a Unicode codepoint to a multi-byte UTF-8 sequence.\n *\n * @param codepoint The Unicode codepoint.\n * @param emit      Function which will be called for each UTF-8 byte that represents the codepoint.\n */\nexport function codepointToUTF8(\n  codepoint: number,\n  emit: (byte: number) => void,\n) {\n  if (codepoint <= 0x7f) {\n    emit(codepoint);\n    return;\n  } else if (codepoint <= 0x7ff) {\n    emit(0xc0 | (codepoint >> 6));\n    emit(0x80 | (codepoint & 0x3f));\n    return;\n  } else if (codepoint <= 0xffff) {\n    emit(0xe0 | (codepoint >> 12));\n    emit(0x80 | ((codepoint >> 6) & 0x3f));\n    emit(0x80 | (codepoint & 0x3f));\n    return;\n  } else if (codepoint <= 0x10ffff) {\n    emit(0xf0 | (codepoint >> 18));\n    emit(0x80 | ((codepoint >> 12) & 0x3f));\n    emit(0x80 | ((codepoint >> 6) & 0x3f));\n    emit(0x80 | (codepoint & 0x3f));\n    return;\n  }\n\n  throw new Error(`Unrecognized Unicode codepoint: ${codepoint.toString(16)}`);\n}\n\n/**\n * Converts a JavaScript string to a sequence of UTF-8 bytes.\n *\n * @param str  The string to convert to UTF-8.\n * @param emit Function which will be called for each UTF-8 byte of the string.\n */\nexport function stringToUTF8(str: string, emit: (byte: number) => void) {\n  for (let i = 0; i < str.length; i += 1) {\n    let codepoint = str.charCodeAt(i);\n\n    if (codepoint > 0xd7ff && codepoint <= 0xdbff) {\n      // most UTF-16 codepoints are Unicode codepoints, except values in this\n      // range where the next UTF-16 codepoint needs to be combined with the\n      // current one to get the Unicode codepoint\n      const highSurrogate = ((codepoint - 0xd800) * 0x400) & 0xffff;\n      const lowSurrogate = (str.charCodeAt(i + 1) - 0xdc00) & 0xffff;\n      codepoint = (lowSurrogate | highSurrogate) + 0x10000;\n      i += 1;\n    }\n\n    codepointToUTF8(codepoint, emit);\n  }\n}\n\n/**\n * Converts a UTF-8 byte to a Unicode codepoint.\n *\n * @param byte  The UTF-8 byte next in the sequence.\n * @param state The shared state between consecutive UTF-8 bytes in the\n *              sequence, an object with the shape `{ utf8seq: 0, codepoint: 0 }`.\n * @param emit  Function which will be called for each codepoint.\n */\nexport function stringFromUTF8(\n  byte: number,\n  state: { utf8seq: number; codepoint: number },\n  emit: (codepoint: number) => void,\n) {\n  if (state.utf8seq === 0) {\n    if (byte <= 0x7f) {\n      emit(byte);\n      return;\n    }\n\n    // count the number of 1 leading bits until you reach 0\n    for (let leadingBit = 1; leadingBit < 6; leadingBit += 1) {\n      if (((byte >> (7 - leadingBit)) & 1) === 0) {\n        state.utf8seq = leadingBit;\n        break;\n      }\n    }\n\n    if (state.utf8seq === 2) {\n      state.codepoint = byte & 31;\n    } else if (state.utf8seq === 3) {\n      state.codepoint = byte & 15;\n    } else if (state.utf8seq === 4) {\n      state.codepoint = byte & 7;\n    } else {\n      throw new Error(\"Invalid UTF-8 sequence\");\n    }\n\n    state.utf8seq -= 1;\n  } else if (state.utf8seq > 0) {\n    if (byte <= 0x7f) {\n      throw new Error(\"Invalid UTF-8 sequence\");\n    }\n\n    state.codepoint = (state.codepoint << 6) | (byte & 63);\n    state.utf8seq -= 1;\n\n    if (state.utf8seq === 0) {\n      emit(state.codepoint);\n    }\n  }\n}\n","import { CommunityDB, Profile, FriendRequest, Friend, Conversation, ConversationMember, Message, Block, Report } from './types';\r\n\r\ninterface Data {\r\n  profiles: Profile[];\r\n  friendRequests: FriendRequest[];\r\n  friends: Friend[];\r\n  conversations: Conversation[];\r\n  conversationMembers: ConversationMember[];\r\n  messages: Message[];\r\n  blocks: Block[];\r\n  reports: Report[];\r\n  typingIndicators: Record<string, { userId: string; timestamp: number }[]>;\r\n}\r\n\r\nexport class LocalDB implements CommunityDB {\r\n  private storageKey = 'vibeschool-community-data';\r\n  private DEBUG_COMMUNITY = process.env.DEBUG_COMMUNITY === 'true';\r\n\r\n  constructor() {\r\n    // Initialize with default data if not exists\r\n    this.initStorage();\r\n  }\r\n\r\n  private initStorage() {\r\n    if (typeof window !== 'undefined') {\r\n      if (!localStorage.getItem(this.storageKey)) {\r\n        const defaultData: Data = {\r\n          profiles: [],\r\n          friendRequests: [],\r\n          friends: [],\r\n          conversations: [],\r\n          conversationMembers: [],\r\n          messages: [],\r\n          blocks: [],\r\n          reports: [],\r\n          typingIndicators: {},\r\n        };\r\n        localStorage.setItem(this.storageKey, JSON.stringify(defaultData));\r\n      }\r\n    }\r\n  }\r\n\r\n  private getData(): Data {\r\n    if (typeof window === 'undefined') {\r\n      return {\r\n        profiles: [],\r\n        friendRequests: [],\r\n        friends: [],\r\n        conversations: [],\r\n        conversationMembers: [],\r\n        messages: [],\r\n        blocks: [],\r\n        reports: [],\r\n        typingIndicators: {},\r\n      };\r\n    }\r\n    \r\n    const dataStr = localStorage.getItem(this.storageKey);\r\n    if (!dataStr) {\r\n      this.initStorage();\r\n      return this.getData();\r\n    }\r\n    \r\n    try {\r\n      return JSON.parse(dataStr) as Data;\r\n    } catch (error) {\r\n      console.error('[COMMUNITY][LocalDB] Error parsing data:', error);\r\n      this.initStorage();\r\n      return this.getData();\r\n    }\r\n  }\r\n\r\n  private setData(data: Data) {\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.setItem(this.storageKey, JSON.stringify(data));\r\n    }\r\n  }\r\n\r\n  // Profiles\r\n  async getProfile(userId: string): Promise<Profile | null> {\r\n    const data = this.getData();\r\n    const profile = data.profiles.find(p => p.id === userId) || null;\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] getProfile', { userId, profile: profile ? 'found' : 'not found' });\r\n    }\r\n    \r\n    return profile;\r\n  }\r\n\r\n  async updateProfile(userId: string, data: Partial<Omit<Profile, 'id' | 'created_at'>>): Promise<Profile> {\r\n    const currentData = this.getData();\r\n    const existingIndex = currentData.profiles.findIndex(p => p.id === userId);\r\n    \r\n    if (existingIndex !== -1) {\r\n      currentData.profiles[existingIndex] = {\r\n        ...currentData.profiles[existingIndex],\r\n        ...data,\r\n        last_seen_at: new Date().toISOString(),\r\n      };\r\n    } else {\r\n      const newProfile: Profile = {\r\n        id: userId,\r\n        username: data.username || '',\r\n        display_name: data.display_name || '',\r\n        avatar_url: data.avatar_url,\r\n        role: data.role || 'student',\r\n        created_at: new Date().toISOString(),\r\n        last_seen_at: new Date().toISOString(),\r\n        is_online: false,\r\n      };\r\n      currentData.profiles.push(newProfile);\r\n    }\r\n    \r\n    this.setData(currentData);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] updateProfile', { userId, data });\r\n    }\r\n    \r\n    return currentData.profiles.find(p => p.id === userId)!;\r\n  }\r\n\r\n  async searchProfiles(query: string): Promise<Profile[]> {\r\n    const data = this.getData();\r\n    const lowerQuery = query.toLowerCase();\r\n    const results = data.profiles.filter(p => \r\n      p.username.toLowerCase().includes(lowerQuery) || \r\n      p.display_name.toLowerCase().includes(lowerQuery)\r\n    );\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] searchProfiles', { query, results: results.length });\r\n    }\r\n    \r\n    return results;\r\n  }\r\n\r\n  // Friend Requests\r\n  async createFriendRequest(requesterId: string, addresseeId: string): Promise<FriendRequest> {\r\n    const currentData = this.getData();\r\n    const newRequest: FriendRequest = {\r\n      id: crypto.randomUUID(),\r\n      requester_id: requesterId,\r\n      addressee_id: addresseeId,\r\n      status: 'pending',\r\n      created_at: new Date().toISOString(),\r\n      updated_at: new Date().toISOString(),\r\n    };\r\n    \r\n    currentData.friendRequests.push(newRequest);\r\n    this.setData(currentData);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] createFriendRequest', { requesterId, addresseeId, requestId: newRequest.id });\r\n    }\r\n    \r\n    return newRequest;\r\n  }\r\n\r\n  async updateFriendRequest(requestId: string, status: 'accepted' | 'declined' | 'cancelled'): Promise<FriendRequest> {\r\n    const currentData = this.getData();\r\n    const index = currentData.friendRequests.findIndex(r => r.id === requestId);\r\n    \r\n    if (index !== -1) {\r\n      currentData.friendRequests[index].status = status;\r\n      currentData.friendRequests[index].updated_at = new Date().toISOString();\r\n      \r\n      // If accepted, create friendship entries\r\n      if (status === 'accepted') {\r\n        const request = currentData.friendRequests[index];\r\n        const friendEntry1: Friend = {\r\n          user_id: request.requester_id,\r\n          friend_id: request.addressee_id,\r\n          created_at: new Date().toISOString(),\r\n        };\r\n        const friendEntry2: Friend = {\r\n          user_id: request.addressee_id,\r\n          friend_id: request.requester_id,\r\n          created_at: new Date().toISOString(),\r\n        };\r\n        currentData.friends.push(friendEntry1, friendEntry2);\r\n      }\r\n      \r\n      this.setData(currentData);\r\n      \r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.log('[COMMUNITY][LocalDB] updateFriendRequest', { requestId, status });\r\n      }\r\n      \r\n      return currentData.friendRequests[index];\r\n    }\r\n    \r\n    throw new Error('Friend request not found');\r\n  }\r\n\r\n  async getFriendRequests(userId: string): Promise<FriendRequest[]> {\r\n    const data = this.getData();\r\n    const requests = data.friendRequests.filter(\r\n      r => r.addressee_id === userId || r.requester_id === userId\r\n    );\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] getFriendRequests', { userId, count: requests.length });\r\n    }\r\n    \r\n    return requests;\r\n  }\r\n\r\n  // Friends\r\n  async getFriends(userId: string): Promise<Friend[]> {\r\n    const data = this.getData();\r\n    const friends = data.friends.filter(f => f.user_id === userId);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] getFriends', { userId, count: friends.length });\r\n    }\r\n    \r\n    return friends;\r\n  }\r\n\r\n  async unfriend(userId: string, friendId: string): Promise<void> {\r\n    const currentData = this.getData();\r\n    currentData.friends = currentData.friends.filter(\r\n      f => !(f.user_id === userId && f.friend_id === friendId) ||\r\n           !(f.user_id === friendId && f.friend_id === userId)\r\n    );\r\n    this.setData(currentData);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] unfriend', { userId, friendId });\r\n    }\r\n  }\r\n\r\n  // Conversations\r\n  async createConversation(isGroup: boolean, createdBy: string, title?: string, userIds?: string[]): Promise<Conversation> {\r\n    const currentData = this.getData();\r\n    const newConversation: Conversation = {\r\n      id: crypto.randomUUID(),\r\n      is_group: isGroup,\r\n      title: title || (isGroup ? 'Group Chat' : undefined),\r\n      created_by: createdBy,\r\n      created_at: new Date().toISOString(),\r\n      updated_at: new Date().toISOString(),\r\n    };\r\n    \r\n    currentData.conversations.push(newConversation);\r\n    \r\n    // Add creator as member\r\n    const creatorMember: ConversationMember = {\r\n      conversation_id: newConversation.id,\r\n      user_id: createdBy,\r\n      role: 'owner',\r\n      joined_at: new Date().toISOString(),\r\n    };\r\n    currentData.conversationMembers.push(creatorMember);\r\n    \r\n    // Add other users if provided\r\n    if (userIds) {\r\n      for (const userId of userIds) {\r\n        if (userId !== createdBy) {\r\n          const member: ConversationMember = {\r\n            conversation_id: newConversation.id,\r\n            user_id: userId,\r\n            role: 'member',\r\n            joined_at: new Date().toISOString(),\r\n          };\r\n          currentData.conversationMembers.push(member);\r\n        }\r\n      }\r\n    }\r\n    \r\n    this.setData(currentData);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] createConversation', { isGroup, createdBy, title, userIds, conversationId: newConversation.id });\r\n    }\r\n    \r\n    return newConversation;\r\n  }\r\n\r\n  async getConversations(userId: string): Promise<Conversation[]> {\r\n    const data = this.getData();\r\n    const userConversations = data.conversationMembers\r\n      .filter(cm => cm.user_id === userId)\r\n      .map(cm => cm.conversation_id);\r\n    \r\n    const conversations = data.conversations.filter(c => \r\n      userConversations.includes(c.id)\r\n    );\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] getConversations', { userId, count: conversations.length });\r\n    }\r\n    \r\n    return conversations;\r\n  }\r\n\r\n  async getConversation(conversationId: string): Promise<Conversation | null> {\r\n    const data = this.getData();\r\n    const conversation = data.conversations.find(c => c.id === conversationId) || null;\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] getConversation', { conversationId, found: !!conversation });\r\n    }\r\n    \r\n    return conversation;\r\n  }\r\n\r\n  async addConversationMember(conversationId: string, userId: string, role: 'owner' | 'admin' | 'member' = 'member'): Promise<void> {\r\n    const currentData = this.getData();\r\n    const existingMember = currentData.conversationMembers.find(\r\n      cm => cm.conversation_id === conversationId && cm.user_id === userId\r\n    );\r\n    \r\n    if (!existingMember) {\r\n      const member: ConversationMember = {\r\n        conversation_id: conversationId,\r\n        user_id: userId,\r\n        role,\r\n        joined_at: new Date().toISOString(),\r\n      };\r\n      currentData.conversationMembers.push(member);\r\n      this.setData(currentData);\r\n      \r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.log('[COMMUNITY][LocalDB] addConversationMember', { conversationId, userId, role });\r\n      }\r\n    }\r\n  }\r\n\r\n  async removeConversationMember(conversationId: string, userId: string): Promise<void> {\r\n    const currentData = this.getData();\r\n    currentData.conversationMembers = currentData.conversationMembers.filter(\r\n      cm => !(cm.conversation_id === conversationId && cm.user_id === userId)\r\n    );\r\n    this.setData(currentData);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] removeConversationMember', { conversationId, userId });\r\n    }\r\n  }\r\n\r\n  async updateConversation(conversationId: string, data: Partial<Omit<Conversation, 'id' | 'created_by' | 'created_at'>>): Promise<void> {\r\n    const currentData = this.getData();\r\n    const index = currentData.conversations.findIndex(c => c.id === conversationId);\r\n    \r\n    if (index !== -1) {\r\n      currentData.conversations[index] = {\r\n        ...currentData.conversations[index],\r\n        ...data,\r\n        updated_at: new Date().toISOString(),\r\n      };\r\n      this.setData(currentData);\r\n      \r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.log('[COMMUNITY][LocalDB] updateConversation', { conversationId, data });\r\n      }\r\n    }\r\n  }\r\n\r\n  // Messages\r\n  async createMessage(message: Omit<Message, 'id' | 'created_at'>): Promise<Message> {\r\n    const currentData = this.getData();\r\n    const newMessage: Message = {\r\n      ...message,\r\n      id: crypto.randomUUID(),\r\n      created_at: new Date().toISOString(),\r\n    };\r\n    currentData.messages.push(newMessage);\r\n    this.setData(currentData);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] createMessage', { conversationId: message.conversation_id, senderId: message.sender_id, messageId: newMessage.id });\r\n    }\r\n    \r\n    return newMessage;\r\n  }\r\n\r\n  async getMessages(conversationId: string, offset: number = 0, limit: number = 50): Promise<Message[]> {\r\n    const data = this.getData();\r\n    const messages = data.messages\r\n      .filter(m => m.conversation_id === conversationId && !m.deleted_at)\r\n      .sort((a, b) => new Date(a.created_at).getTime() - new Date(b.created_at).getTime())\r\n      .slice(offset, offset + limit);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] getMessages', { conversationId, offset, limit, count: messages.length });\r\n    }\r\n    \r\n    return messages;\r\n  }\r\n\r\n  async updateMessage(messageId: string, body: string): Promise<Message> {\r\n    const currentData = this.getData();\r\n    const index = currentData.messages.findIndex(m => m.id === messageId);\r\n    \r\n    if (index !== -1) {\r\n      currentData.messages[index].body = body;\r\n      currentData.messages[index].edited_at = new Date().toISOString();\r\n      this.setData(currentData);\r\n      \r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.log('[COMMUNITY][LocalDB] updateMessage', { messageId, body });\r\n      }\r\n      \r\n      return currentData.messages[index];\r\n    }\r\n    \r\n    throw new Error('Message not found');\r\n  }\r\n\r\n  async deleteMessage(messageId: string): Promise<void> {\r\n    const currentData = this.getData();\r\n    const index = currentData.messages.findIndex(m => m.id === messageId);\r\n    \r\n    if (index !== -1) {\r\n      currentData.messages[index].deleted_at = new Date().toISOString();\r\n      this.setData(currentData);\r\n      \r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.log('[COMMUNITY][LocalDB] deleteMessage', { messageId });\r\n      }\r\n    }\r\n  }\r\n\r\n  // Blocks\r\n  async blockUser(blockerId: string, blockedId: string): Promise<void> {\r\n    const currentData = this.getData();\r\n    const existingBlock = currentData.blocks.find(\r\n      b => b.blocker_id === blockerId && b.blocked_id === blockedId\r\n    );\r\n    \r\n    if (!existingBlock) {\r\n      const block: Block = {\r\n        blocker_id: blockerId,\r\n        blocked_id: blockedId,\r\n        created_at: new Date().toISOString(),\r\n      };\r\n      currentData.blocks.push(block);\r\n      this.setData(currentData);\r\n      \r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.log('[COMMUNITY][LocalDB] blockUser', { blockerId, blockedId });\r\n      }\r\n    }\r\n  }\r\n\r\n  async unblockUser(blockerId: string, blockedId: string): Promise<void> {\r\n    const currentData = this.getData();\r\n    currentData.blocks = currentData.blocks.filter(\r\n      b => !(b.blocker_id === blockerId && b.blocked_id === blockedId)\r\n    );\r\n    this.setData(currentData);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] unblockUser', { blockerId, blockedId });\r\n    }\r\n  }\r\n\r\n  async isBlocked(blockerId: string, blockedId: string): Promise<boolean> {\r\n    const data = this.getData();\r\n    const isBlocked = data.blocks.some(\r\n      b => b.blocker_id === blockerId && b.blocked_id === blockedId\r\n    );\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] isBlocked', { blockerId, blockedId, isBlocked });\r\n    }\r\n    \r\n    return isBlocked;\r\n  }\r\n\r\n  // Reports\r\n  async reportUser(reporterId: string, reportedUserId: string, reason: string): Promise<Report> {\r\n    const currentData = this.getData();\r\n    const newReport: Report = {\r\n      id: crypto.randomUUID(),\r\n      reporter_id: reporterId,\r\n      reported_user_id: reportedUserId,\r\n      reason,\r\n      created_at: new Date().toISOString(),\r\n    };\r\n    currentData.reports.push(newReport);\r\n    this.setData(currentData);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] reportUser', { reporterId, reportedUserId, reason });\r\n    }\r\n    \r\n    return newReport;\r\n  }\r\n\r\n  async reportMessage(reporterId: string, messageId: string, reason: string): Promise<Report> {\r\n    const currentData = this.getData();\r\n    const newReport: Report = {\r\n      id: crypto.randomUUID(),\r\n      reporter_id: reporterId,\r\n      message_id: messageId,\r\n      reason,\r\n      created_at: new Date().toISOString(),\r\n    };\r\n    currentData.reports.push(newReport);\r\n    this.setData(currentData);\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] reportMessage', { reporterId, messageId, reason });\r\n    }\r\n    \r\n    return newReport;\r\n  }\r\n\r\n  // Typing Indicators\r\n  setTypingStatus(conversationId: string, userId: string, isTyping: boolean): void {\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] setTypingStatus', { conversationId, userId, isTyping });\r\n    }\r\n    \r\n    const data = this.getData();\r\n    const now = Date.now();\r\n    const conversationTyping = data.typingIndicators[conversationId] || [];\r\n    \r\n    if (isTyping) {\r\n      // Add user to typing list\r\n      const existingIndex = conversationTyping.findIndex(t => t.userId === userId);\r\n      if (existingIndex >= 0) {\r\n        conversationTyping[existingIndex].timestamp = now;\r\n      } else {\r\n        conversationTyping.push({ userId, timestamp: now });\r\n      }\r\n    } else {\r\n      // Remove user from typing list\r\n      const existingIndex = conversationTyping.findIndex(t => t.userId === userId);\r\n      if (existingIndex >= 0) {\r\n        conversationTyping.splice(existingIndex, 1);\r\n      }\r\n    }\r\n    \r\n    data.typingIndicators[conversationId] = conversationTyping;\r\n    this.setData(data);\r\n  }\r\n\r\n  async getTypingUsers(conversationId: string): Promise<string[]> {\r\n    const data = this.getData();\r\n    const now = Date.now();\r\n    const fiveSecondsAgo = now - 5000; // Clear typing indicators older than 5 seconds\r\n    \r\n    const conversationTyping = data.typingIndicators[conversationId] || [];\r\n    const recentTyping = conversationTyping.filter(t => t.timestamp > fiveSecondsAgo);\r\n    \r\n    // Update the typing indicators to remove stale entries\r\n    data.typingIndicators[conversationId] = recentTyping;\r\n    this.setData(data);\r\n    \r\n    const userIds = recentTyping.map(t => t.userId);\r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] getTypingUsers', { conversationId, userIds });\r\n    }\r\n    return userIds;\r\n  }\r\n\r\n  // Read Receipts\r\n  async markAsRead(conversationId: string, userId: string, lastReadAt: string): Promise<void> {\r\n    const currentData = this.getData();\r\n    const memberIndex = currentData.conversationMembers.findIndex(\r\n      cm => cm.conversation_id === conversationId && cm.user_id === userId\r\n    );\r\n    \r\n    if (memberIndex !== -1) {\r\n      currentData.conversationMembers[memberIndex].last_read_at = lastReadAt;\r\n      this.setData(currentData);\r\n      \r\n      if (this.DEBUG_COMMUNITY) {\r\n        console.log('[COMMUNITY][LocalDB] markAsRead', { conversationId, userId, lastReadAt });\r\n      }\r\n    }\r\n  }\r\n\r\n  async getUnreadCount(conversationId: string, userId: string): Promise<number> {\r\n    const data = this.getData();\r\n    const member = data.conversationMembers.find(\r\n      cm => cm.conversation_id === conversationId && cm.user_id === userId\r\n    );\r\n    \r\n    const lastReadAt = member?.last_read_at ? new Date(member.last_read_at) : new Date(0);\r\n    \r\n    const unreadCount = data.messages.filter(\r\n      m => m.conversation_id === conversationId &&\r\n           new Date(m.created_at) > lastReadAt &&\r\n           m.sender_id !== userId // Don't count own messages as unread\r\n    ).length;\r\n    \r\n    if (this.DEBUG_COMMUNITY) {\r\n      console.log('[COMMUNITY][LocalDB] getUnreadCount', { conversationId, userId, unreadCount });\r\n    }\r\n    return unreadCount;\r\n  }\r\n}"],"names":["ActionDidNotRevalidate","ActionDidRevalidateDynamicOnly","ActionDidRevalidateStaticAndDynamic","MutableRequestCookiesAdapter","ReadonlyRequestCookiesError","RequestCookiesAdapter","appendMutableCookies","areCookiesMutableInCurrentPhase","createCookiesWithMutableAccessCheck","getModifiedCookieValues","responseCookiesToRequestCookies","Error","constructor","callable","seal","cookies","Proxy","get","target","prop","receiver","ReflectAdapter","SYMBOL_MODIFY_COOKIE_VALUES","Symbol","for","modified","Array","isArray","length","headers","mutableCookies","modifiedCookieValues","resCookies","ResponseCookies","returnedCookies","getAll","cookie","set","wrap","onUpdateCookies","responseCookies","Headers","modifiedValues","modifiedCookies","Set","updateResponseCookies","workStore","workAsyncStorage","getStore","pathWasRevalidated","allCookies","filter","c","has","name","serializedCookies","tempCookies","push","toString","wrappedCookies","args","add","delete","requestStore","ensureCookiesAreStillMutable","phase","_callingExpression","requestCookies","RequestCookies","createDedupedByCallsiteServerErrorLoggerDev","errorRef","current","cache","React","fn","logErrorOrWarn","process","env","__NEXT_CACHE_COMPONENTS","console","error","warn","flushCurrentErrorIfNew","key","getMessage","logDedupedError","message","NODE_ENV","callStackFrames","stack","split","undefined","callingExpression","workUnitStore","workUnitAsyncStorage","isRequestAPICallableInsideAfter","route","forceStatic","underlyingCookies","createEmptyCookies","makeUntrackedCookies","dynamicShouldError","StaticGenBailoutError","type","captureStackTrace","invalidDynamicUsageError","makeHangingCookies","exportName","InvariantError","postponeWithTracking","dynamicTracking","throwToInterruptStaticGeneration","delayUntilRuntimeStage","trackDynamicDataInDynamicRender","userspaceMutableCookies","makeUntrackedCookiesWithDevWarnings","throwForMissingRequestStore","CachedCookies","WeakMap","prerenderStore","cachedPromise","promise","makeHangingPromise","renderSignal","cachedCookies","Promise","resolve","asyncApiPromises","instrumentCookiesPromiseWithDevWarnings","makeDevtoolsIOAwarePromise","RenderStage","Runtime","proxiedPromise","warnForSyncAccess","createCookiesAccessError","Object","defineProperties","iterator","replaceableWarningDescriptorForSymbolIterator","size","replaceableWarningDescriptor","clear","enumerable","value","defineProperty","writable","configurable","expression","prefix","HeadersAdapter","ReadonlyHeadersError","lowercased","toLowerCase","original","keys","find","o","deleteProperty","merge","join","from","append","existing","forEach","callbackfn","thisArg","entries","call","values","underlyingHeaders","makeUntrackedHeaders","makeHangingHeaders","makeUntrackedHeadersWithDevWarnings","CachedHeaders","cachedHeaders","instrumentHeadersPromiseWithDevWarnings","createHeadersAccessError","getSetCookie","draftMode","createOrGetCachedDraftMode","draftModeProvider","getDraftModeProviderForCacheScope","cacheKey","NullDraftMode","cachedDraftMode","CachedDraftModes","isPrefetchRequest","createDraftModeWithDevWarnings","DraftMode","underlyingProvider","instance","provider","_provider","isEnabled","enable","trackDynamicDraftMode","disable","createDraftModeAccessError","constructorOpt","abortAndThrowOnSynchronousRequestDataAccess","revalidate","err","DynamicServerError","dynamicUsageDescription","dynamicUsageStack"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,9,11,12,13,14,15,16,17,18,19,22]}