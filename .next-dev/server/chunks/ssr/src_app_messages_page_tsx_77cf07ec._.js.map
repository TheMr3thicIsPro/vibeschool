{"version":3,"sources":["../../../../src/app/messages/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { useAuthStore } from '@/context/AuthContext';\r\nimport { getCommunityDB, Conversation, Message, FriendRequest, Profile } from '@/community/db';\r\nimport { SendIcon, PaperclipIcon, MoreVerticalIcon, UsersIcon, UserIcon, UserPlusIcon, UserCheckIcon, UserXIcon, SearchIcon } from 'lucide-react';\r\nimport ProtectedRoute from '@/components/auth/ProtectedRoute';\r\nimport SkeletonLoader from '@/components/SkeletonLoader';\r\n\r\ninterface MessagesPageProps {\r\n  db?: any;\r\n  currentUser?: any;\r\n}\r\n\r\nconst MessagesPage: React.FC<MessagesPageProps> = ({ db: propDb, currentUser: propUser }) => {\r\n  const { state } = useAuthStore();\r\n  const user = propUser || state.user;\r\n  const [db, setDb] = useState(propDb);\r\n  const [activeTab, setActiveTab] = useState<'messages' | 'friends' | 'requests'>('messages');\r\n  const [conversations, setConversations] = useState<Conversation[]>([]);\r\n  const [activeConversation, setActiveConversation] = useState<Conversation | null>(null);\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [typingUsers, setTypingUsers] = useState<string[]>([]);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  \r\n  // Friend request related states\r\n  const [friends, setFriends] = useState<{ user_id: string; friend_id: string; created_at: string; profile?: Profile }[]>([]);\r\n  const [friendRequests, setFriendRequests] = useState<FriendRequest[]>([]);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchResults, setSearchResults] = useState<Profile[]>([]);\r\n  const [searchLoading, setSearchLoading] = useState(false);\r\n\r\n  // Initialize db if not passed as prop\r\n  useEffect(() => {\r\n    const init = async () => {\r\n      if (!propDb) {\r\n        try {\r\n          const communityDb = await getCommunityDB();\r\n          setDb(communityDb);\r\n        } catch (err) {\r\n          console.error('[COMMUNITY] Error initializing community DB:', err);\r\n          setError('Failed to initialize community system');\r\n        }\r\n      }\r\n    };\r\n\r\n    if (user && !propDb) {\r\n      init();\r\n    } else if (propDb) {\r\n      setDb(propDb);\r\n    }\r\n  }, [user, propDb]);\r\n\r\n  // Load conversations when db is ready\r\n  useEffect(() => {\r\n    if (db && user) {\r\n      loadConversations();\r\n    }\r\n  }, [db, user]);\r\n\r\n  // Load messages when active conversation changes\r\n  useEffect(() => {\r\n    if (activeConversation && db && user) {\r\n      loadMessages(activeConversation.id);\r\n    }\r\n  }, [activeConversation, db, user]);\r\n\r\n  // Scroll to bottom when messages change\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  // Load friends and requests when db is ready\r\n  useEffect(() => {\r\n    if (db && user) {\r\n      loadFriendsAndRequests();\r\n    }\r\n  }, [db, user, activeTab]);\r\n\r\n  const loadConversations = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const convs = await db.getConversations(user.id);\r\n      setConversations(convs);\r\n      setLoading(false);\r\n    } catch (err) {\r\n      console.error('[COMMUNITY] Error loading conversations:', err);\r\n      setError('Failed to load conversations');\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadMessages = async (conversationId: string) => {\r\n    try {\r\n      const msgs = await db.getMessages(conversationId);\r\n      setMessages(msgs);\r\n    } catch (err) {\r\n      console.error('[COMMUNITY] Error loading messages:', err);\r\n      setError('Failed to load messages');\r\n    }\r\n  };\r\n\r\n  const loadFriendsAndRequests = async () => {\r\n    if (!db || !user) return;\r\n    \r\n    try {\r\n      // Load friends\r\n      const friendsList = await db.getFriends(user.id);\r\n      const friendsWithProfiles = await Promise.all(\r\n        friendsList.map(async (friend: any) => {\r\n          const profile = await db.getProfile(friend.friend_id);\r\n          return {\r\n            ...friend,\r\n            profile\r\n          };\r\n        })\r\n      );\r\n      setFriends(friendsWithProfiles);\r\n\r\n      // Load friend requests\r\n      const requests = await db.getFriendRequests(user.id);\r\n      setFriendRequests(requests);\r\n    } catch (err) {\r\n      console.error('[COMMUNITY] Error loading friends/requests:', err);\r\n    }\r\n  };\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!newMessage.trim() || !activeConversation || !db) return;\r\n\r\n    try {\r\n      const message = await db.createMessage({\r\n        conversation_id: activeConversation.id,\r\n        sender_id: user.id,\r\n        body: newMessage.trim(),\r\n      });\r\n\r\n      // Add message to local state\r\n      setMessages(prev => [...prev, message]);\r\n      setNewMessage('');\r\n\r\n      // Update conversations list with latest message\r\n      setConversations(prev => prev.map(conv => \r\n        conv.id === activeConversation.id \r\n          ? { ...conv, updated_at: message.created_at } \r\n          : conv\r\n      ));\r\n    } catch (err) {\r\n      console.error('[COMMUNITY] Error sending message:', err);\r\n      setError('Failed to send message');\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendMessage();\r\n    }\r\n  };\r\n\r\n  const handleStartTyping = () => {\r\n    if (!isTyping && activeConversation) {\r\n      setIsTyping(true);\r\n      // In a real implementation, we would send typing indicator via socket\r\n      // For now, just simulate it locally\r\n    }\r\n  };\r\n\r\n  const handleStopTyping = () => {\r\n    if (isTyping) {\r\n      setIsTyping(false);\r\n      // In a real implementation, we would send typing stop indicator via socket\r\n    }\r\n  };\r\n\r\n  const formatTime = (dateString: string) => {\r\n    return new Date(dateString).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    const date = new Date(dateString);\r\n    const today = new Date();\r\n    const yesterday = new Date(today);\r\n    yesterday.setDate(yesterday.getDate() - 1);\r\n\r\n    if (date.toDateString() === today.toDateString()) {\r\n      return 'Today';\r\n    } else if (date.toDateString() === yesterday.toDateString()) {\r\n      return 'Yesterday';\r\n    } else {\r\n      return date.toLocaleDateString();\r\n    }\r\n  };\r\n\r\n  // Friend request functions\r\n  const handleSearchUsers = async (query: string) => {\r\n    if (!query.trim() || !db) return;\r\n    \r\n    try {\r\n      setSearchLoading(true);\r\n      const results = await db.searchProfiles(query);\r\n      setSearchResults(results.filter((profile: Profile) => profile.id !== user.id));\r\n    } catch (err) {\r\n      console.error('[COMMUNITY] Error searching users:', err);\r\n    } finally {\r\n      setSearchLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSendFriendRequest = async (userId: string) => {\r\n    try {\r\n      console.log(\"[FRIENDREQ] send to\", userId);\r\n      \r\n      const response = await fetch('/api/friends/requests', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ toUserId: userId })\r\n      });\r\n      \r\n      const data = await response.json();\r\n      console.log(\"[FRIENDREQ] response\", response.status, data);\r\n      \r\n      if (response.ok && data.ok) {\r\n        loadFriendsAndRequests();\r\n        setSearchResults([]); // Clear search results\r\n        setSearchQuery(''); // Clear search query\r\n        \r\n        // Show success toast\r\n        console.log(\"[FRIENDREQ] request sent successfully\");\r\n      } else {\r\n        console.error(\"[FRIENDREQ] Failed to send request:\", data.error);\r\n      }\r\n    } catch (err) {\r\n      console.error('[FRIENDREQ] Error sending friend request:', err);\r\n    }\r\n  };\r\n\r\n  const handleUpdateFriendRequest = async (requestId: string, status: 'accepted' | 'declined' | 'cancelled') => {\r\n    try {\r\n      console.log(\"[FRIENDREQ] update request\", { requestId, status });\r\n      \r\n      const response = await fetch(`/api/friends/requests/${requestId}`, {\r\n        method: 'PUT',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ status })\r\n      });\r\n      \r\n      const data = await response.json();\r\n      console.log(\"[FRIENDREQ] update response\", response.status, data);\r\n      \r\n      if (response.ok && data.ok) {\r\n        loadFriendsAndRequests();\r\n      } else {\r\n        console.error(\"[FRIENDREQ] Failed to update request:\", data.error);\r\n      }\r\n    } catch (err) {\r\n      console.error('[FRIENDREQ] Error updating friend request:', err);\r\n    }\r\n  };\r\n\r\n  // Group messages by date\r\n  const groupedMessages = messages.reduce((groups: Record<string, Message[]>, message) => {\r\n    const date = formatDate(message.created_at);\r\n    if (!groups[date]) {\r\n      groups[date] = [];\r\n    }\r\n    groups[date].push(message);\r\n    return groups;\r\n  }, {});\r\n\r\n  return (\r\n    <ProtectedRoute>\r\n      <div className=\"min-h-screen bg-gray-900 text-white flex\">\r\n        {/* Conversations List / Friends List / Requests List */}\r\n        <div className=\"w-1/3 border-r border-gray-700 flex flex-col\">\r\n          {/* Tab Navigation */}\r\n          <div className=\"p-4 border-b border-gray-700\">\r\n            <div className=\"flex space-x-1 bg-gray-800 rounded-lg p-1\">\r\n              <button\r\n                onClick={() => setActiveTab('messages')}\r\n                className={`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors ${\r\n                  activeTab === 'messages'\r\n                    ? 'bg-accent-primary text-white border border-accent-primary'\r\n                    : 'text-gray-300 hover:text-white hover:bg-gray-700'\r\n                }`}\r\n              >\r\n                Messages\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTab('friends')}\r\n                className={`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors ${\r\n                  activeTab === 'friends'\r\n                    ? 'bg-accent-primary text-white border border-accent-primary'\r\n                    : 'text-gray-300 hover:text-white hover:bg-gray-700'\r\n                }`}\r\n              >\r\n                Friends\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTab('requests')}\r\n                className={`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors relative ${\r\n                  activeTab === 'requests'\r\n                    ? 'bg-accent-primary text-white border border-accent-primary'\r\n                    : 'text-gray-300 hover:text-white hover:bg-gray-700'\r\n                }`}\r\n              >\r\n                Requests\r\n                {friendRequests.filter(req => req.addressee_id === user.id && req.status === 'pending').length > 0 && (\r\n                  <span className=\"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center\">\r\n                    {friendRequests.filter(req => req.addressee_id === user.id && req.status === 'pending').length}\r\n                  </span>\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Tab Content */}\r\n          {activeTab === 'messages' && (\r\n            <>\r\n              {loading && (\r\n                <div className=\"flex-1 overflow-y-auto p-4\">\r\n                  {/* Skeleton for conversation list */}\r\n                  <div className=\"space-y-4\">\r\n                    {[0, 1, 2, 3, 4].map((_, index) => (\r\n                      <div key={index} className=\"p-4 border-b border-gray-700\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <SkeletonLoader className=\"w-10 h-10 rounded-full\" />\r\n                          <div className=\"flex-1\">\r\n                            <SkeletonLoader className=\"h-4 w-3/4 mb-2\" />\r\n                            <SkeletonLoader className=\"h-3 w-1/2\" />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {!loading && (\r\n                <div className=\"flex-1 overflow-y-auto\">\r\n                  {conversations.map((conversation) => (\r\n                    <div\r\n                      key={conversation.id}\r\n                      className={`p-4 border-b border-gray-700 cursor-pointer hover:bg-gray-800 ${\r\n                        activeConversation?.id === conversation.id ? 'bg-gray-800' : ''\r\n                      }`}\r\n                      onClick={() => setActiveConversation(conversation)}\r\n                    >\r\n                      <div className=\"flex items-center space-x-3\">\r\n                        <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-accent-primary to-purple-600 flex items-center justify-center text-white font-bold\">\r\n                          {conversation.title || conversation.is_group ? (\r\n                            <UsersIcon className=\"w-4 h-4\" />\r\n                          ) : (\r\n                            <UserIcon className=\"w-4 h-4\" />\r\n                          )}\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <h3 className=\"font-medium truncate\">\r\n                            {conversation.title || 'Direct Message'}\r\n                          </h3>\r\n                          <p className=\"text-sm text-gray-400 truncate\">\r\n                            {'No messages yet'}\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                          <p className=\"text-xs text-gray-500\">\r\n                            {conversation.updated_at ? new Date(conversation.updated_at).toLocaleDateString() : ''}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n\r\n          {activeTab === 'friends' && (\r\n            <div className=\"flex-1 overflow-y-auto\">\r\n              {/* Search for friends */}\r\n              <div className=\"p-4 border-b border-gray-700\">\r\n                <div className=\"relative\">\r\n                  <SearchIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Search users...\"\r\n                    value={searchQuery}\r\n                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                    onKeyPress={(e) => e.key === 'Enter' && handleSearchUsers(searchQuery)}\r\n                    className=\"w-full bg-gray-800 text-white rounded-lg py-2 px-4 pl-10 focus:outline-none focus:ring-2 focus:ring-accent-primary\"\r\n                  />\r\n                </div>\r\n                {searchQuery && (\r\n                  <button\r\n                    onClick={() => handleSearchUsers(searchQuery)}\r\n                    disabled={searchLoading}\r\n                    className=\"mt-2 w-full py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 disabled:opacity-50 border border-accent-primary\"\r\n                  >\r\n                    {searchLoading ? 'Searching...' : 'Search'}\r\n                  </button>\r\n                )}\r\n              </div>\r\n\r\n              {/* Search results */}\r\n              {searchResults.length > 0 && (\r\n                <div className=\"p-4 border-b border-gray-700\">\r\n                  <h3 className=\"font-medium mb-2\">Search Results</h3>\r\n                  <div className=\"space-y-2\">\r\n                    {searchResults.map((profile) => (\r\n                      <div key={profile.id} className=\"flex items-center justify-between p-2 bg-gray-800 rounded-lg\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-accent-primary to-purple-600 flex items-center justify-center text-white text-sm font-bold\">\r\n                            {profile.username.charAt(0).toUpperCase()}\r\n                          </div>\r\n                          <div>\r\n                            <p className=\"font-medium\">{profile.username}</p>\r\n                            <p className=\"text-sm text-gray-400\">{profile.display_name}</p>\r\n                          </div>\r\n                        </div>\r\n                        <button\r\n                          onClick={() => handleSendFriendRequest(profile.id)}\r\n                          className=\"p-2 bg-accent-primary text-white rounded-full hover:bg-accent-primary/90 border border-accent-primary\"\r\n                        >\r\n                          <UserPlusIcon className=\"w-4 h-4\" />\r\n                        </button>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Friends list */}\r\n              <div className=\"p-4\">\r\n                <h3 className=\"font-medium mb-2\">Your Friends ({friends.length})</h3>\r\n                {friends.length === 0 ? (\r\n                  <p className=\"text-gray-500 text-sm\">No friends yet. Search for users to add friends!</p>\r\n                ) : (\r\n                  <div className=\"space-y-2\">\r\n                    {friends.map((friend) => (\r\n                      <div key={friend.friend_id} className=\"flex items-center justify-between p-2 bg-gray-800 rounded-lg\">\r\n                        <div className=\"flex items-center space-x-3\">\r\n                          <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-accent-primary to-purple-600 flex items-center justify-center text-white text-sm font-bold\">\r\n                            {friend.profile?.username.charAt(0).toUpperCase() || 'U'}\r\n                          </div>\r\n                          <div>\r\n                            <p className=\"font-medium\">{friend.profile?.username || 'Unknown User'}</p>\r\n                            <p className=\"text-sm text-gray-400\">{friend.profile?.display_name || 'No display name'}</p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"text-xs text-gray-500\">\r\n                          Friends since {new Date(friend.created_at).toLocaleDateString()}\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {activeTab === 'requests' && (\r\n            <div className=\"flex-1 overflow-y-auto\">\r\n              <div className=\"p-4\">\r\n                <h3 className=\"font-medium mb-2\">Friend Requests</h3>\r\n                \r\n                {/* Sent requests */}\r\n                <div className=\"mb-4\">\r\n                  <h4 className=\"text-sm font-medium text-gray-400 mb-2\">Sent Requests</h4>\r\n                  {friendRequests.filter(req => req.requester_id === user.id).length === 0 ? (\r\n                    <p className=\"text-gray-500 text-sm\">No sent requests</p>\r\n                  ) : (\r\n                    <div className=\"space-y-2\">\r\n                      {friendRequests\r\n                        .filter(req => req.requester_id === user.id)\r\n                        .map((request) => (\r\n                          <div key={request.id} className=\"p-2 bg-gray-800 rounded-lg\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <div className=\"flex items-center space-x-3\">\r\n                                <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-accent-primary to-purple-600 flex items-center justify-center text-white text-sm font-bold\">\r\n                                  {request.addressee_id.charAt(0).toUpperCase()}\r\n                                </div>\r\n                                <div>\r\n                                  <p className=\"font-medium\">User {request.addressee_id.substring(0, 8)}</p>\r\n                                  <p className=\"text-sm text-gray-400 capitalize\">Status: {request.status}</p>\r\n                                </div>\r\n                              </div>\r\n                              {request.status === 'pending' && (\r\n                                <button\r\n                                  onClick={() => handleUpdateFriendRequest(request.id, 'cancelled')}\r\n                                  className=\"p-1 text-red-500 hover:bg-red-500/20 rounded\"\r\n                                >\r\n                                  <UserXIcon className=\"w-4 h-4\" />\r\n                                </button>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Received requests */}\r\n                <div>\r\n                  <h4 className=\"text-sm font-medium text-gray-400 mb-2\">Received Requests</h4>\r\n                  {friendRequests.filter(req => req.addressee_id === user.id && req.status === 'pending').length === 0 ? (\r\n                    <p className=\"text-gray-500 text-sm\">No pending requests</p>\r\n                  ) : (\r\n                    <div className=\"space-y-2\">\r\n                      {friendRequests\r\n                        .filter(req => req.addressee_id === user.id && req.status === 'pending')\r\n                        .map((request) => (\r\n                          <div key={request.id} className=\"p-2 bg-gray-800 rounded-lg\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                              <div className=\"flex items-center space-x-3\">\r\n                                <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-accent-primary to-purple-600 flex items-center justify-center text-white text-sm font-bold\">\r\n                                  {request.requester_id.charAt(0).toUpperCase()}\r\n                                </div>\r\n                                <div>\r\n                                  <p className=\"font-medium\">User {request.requester_id.substring(0, 8)}</p>\r\n                                  <p className=\"text-sm text-gray-400\">Sent {new Date(request.created_at).toLocaleDateString()}</p>\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"flex space-x-1\">\r\n                                <button\r\n                                  onClick={() => handleUpdateFriendRequest(request.id, 'accepted')}\r\n                                  className=\"p-1 text-green-500 hover:bg-green-500/20 rounded\"\r\n                                >\r\n                                  <UserCheckIcon className=\"w-4 h-4\" />\r\n                                </button>\r\n                                <button\r\n                                  onClick={() => handleUpdateFriendRequest(request.id, 'declined')}\r\n                                  className=\"p-1 text-red-500 hover:bg-red-500/20 rounded\"\r\n                                >\r\n                                  <UserXIcon className=\"w-4 h-4\" />\r\n                                </button>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Main Content Area */}\r\n        <div className=\"flex-1 flex flex-col\">\r\n          {activeTab === 'messages' && activeConversation ? (\r\n            <>\r\n              {/* Chat Header */}\r\n              <div className=\"p-4 border-b border-gray-700 flex items-center justify-between\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-accent-primary to-purple-600 flex items-center justify-center text-white font-bold\">\r\n                    {activeConversation.title || activeConversation.is_group ? (\r\n                      <UsersIcon className=\"w-4 h-4\" />\r\n                    ) : (\r\n                      <UserIcon className=\"w-4 h-4\" />\r\n                    )}\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"font-medium\">\r\n                      {activeConversation.title || 'Direct Message'}\r\n                    </h3>\r\n                    <p className=\"text-sm text-gray-400\">\r\n                      {activeConversation.is_group ? 'Group chat' : 'Direct message'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <button className=\"p-2 rounded-full hover:bg-gray-700\">\r\n                  <MoreVerticalIcon className=\"w-5 h-5\" />\r\n                </button>\r\n              </div>\r\n\r\n              {/* Messages Container */}\r\n              <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n                {Object.entries(groupedMessages).map(([date, dateMessages]) => (\r\n                  <div key={date}>\r\n                    <div className=\"text-center my-4\">\r\n                      <span className=\"text-xs bg-gray-800 text-gray-400 px-3 py-1 rounded-full\">\r\n                        {date}\r\n                      </span>\r\n                    </div>\r\n                    \r\n                    {dateMessages.map((message) => (\r\n                      <div\r\n                        key={message.id}\r\n                        className={`flex ${message.sender_id === user.id ? 'justify-end' : 'justify-start'}`}\r\n                      >\r\n                        <div\r\n                          className={`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${\r\n                            message.sender_id === user.id\r\n                              ? 'bg-accent-primary text-white'\r\n                              : 'bg-gray-800 text-white'\r\n                          }`}\r\n                        >\r\n                          <p>{message.body}</p>\r\n                          <p\r\n                            className={`text-xs mt-1 ${\r\n                              message.sender_id === user.id ? 'text-black/70' : 'text-gray-400'\r\n                            }`}\r\n                          >\r\n                            {formatTime(message.created_at)}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                ))}\r\n                \r\n                <div ref={messagesEndRef} />\r\n              </div>\r\n\r\n              {/* Typing Indicator */}\r\n              {typingUsers.length > 0 && (\r\n                <div className=\"px-4 py-2 text-sm text-gray-500\">\r\n                  {typingUsers.length === 1 ? (\r\n                    <span>{typingUsers[0]} is typing...</span>\r\n                  ) : (\r\n                    <span>{typingUsers.length} people are typing...</span>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Message Input */}\r\n              <div className=\"p-4 border-t border-gray-700\">\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <button className=\"p-2 rounded-full hover:bg-gray-700\">\r\n                    <PaperclipIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                  <div className=\"flex-1 relative\">\r\n                    <textarea\r\n                      value={newMessage}\r\n                      onChange={(e) => {\r\n                        setNewMessage(e.target.value);\r\n                        handleStartTyping();\r\n                      }}\r\n                      onKeyDown={handleKeyPress}\r\n                      onBlur={handleStopTyping}\r\n                      placeholder=\"Type a message...\"\r\n                      className=\"w-full bg-gray-800 text-white rounded-lg py-2 px-4 pr-12 resize-none focus:outline-none focus:ring-2 focus:ring-accent-primary\"\r\n                      rows={1}\r\n                    />\r\n                    <button\r\n                      onClick={handleSendMessage}\r\n                      disabled={!newMessage.trim()}\r\n                      className={`absolute right-3 bottom-2 p-1 rounded-full ${\r\n                        newMessage.trim()\r\n                          ? 'text-accent-primary hover:bg-accent-primary/20'\r\n                          : 'text-gray-500'\r\n                      }`}\r\n                    >\r\n                      <SendIcon className=\"w-5 h-5\" />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </>\r\n          ) : activeTab === 'messages' ? (\r\n            <div className=\"flex-1 flex items-center justify-center\">\r\n              <div className=\"text-center\">\r\n                <div className=\"w-16 h-16 rounded-full bg-gray-800 flex items-center justify-center mx-auto mb-4\">\r\n                  <UsersIcon className=\"w-8 h-8 text-gray-600\" />\r\n                </div>\r\n                <h3 className=\"text-xl font-medium mb-2\">No Conversation Selected</h3>\r\n                <p className=\"text-gray-500\">\r\n                  Select a conversation from the list or start a new one\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"flex-1 flex items-center justify-center\">\r\n              <div className=\"text-center\">\r\n                <div className=\"w-16 h-16 rounded-full bg-gray-800 flex items-center justify-center mx-auto mb-4\">\r\n                  {activeTab === 'friends' ? (\r\n                    <UserIcon className=\"w-8 h-8 text-gray-600\" />\r\n                  ) : (\r\n                    <UserPlusIcon className=\"w-8 h-8 text-gray-600\" />\r\n                  )}\r\n                </div>\r\n                <h3 className=\"text-xl font-medium mb-2\">\r\n                  {activeTab === 'friends' ? 'Friends' : 'Friend Requests'}\r\n                </h3>\r\n                <p className=\"text-gray-500\">\r\n                  {activeTab === 'friends' \r\n                    ? 'Manage your friends and search for new ones' \r\n                    : 'Manage your friend requests'}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </ProtectedRoute>\r\n  );\r\n};\r\n\r\nexport default MessagesPage;"],"names":[],"mappings":"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"}