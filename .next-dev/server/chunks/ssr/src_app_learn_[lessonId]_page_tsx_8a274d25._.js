module.exports=[28571,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(56025);let f=(0,a.i(70106).default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var g=a.i(90925),h=a.i(48441),i=a.i(49731),j=a.i(43904),k=a.i(10849);let l=async a=>{console.log("getQuizByLessonId: Fetching quiz for lesson:",a);try{let{data:b,error:c}=await k.supabase.from("quizzes").select("*").eq("lesson_id",a).eq("is_active",!0).maybeSingle();if(c)throw console.error("getQuizByLessonId: Error fetching quiz:",{name:c.name,message:c.message,details:c.details}),c;if(!b)return null;console.log("getQuizByLessonId: Fetching questions for lesson:",a);let{data:d,error:e}=await k.supabase.from("quiz_questions").select("*").limit(10);d&&console.log("getQuizByLessonId: All questions in DB:",d.map(a=>({id:a.id,lesson_id:a.lesson_id,text:a.question_text?.substring(0,30)+"..."})));let{data:f,error:g}=await k.supabase.from("quiz_questions").select("*").eq("lesson_id",a).order("order_index",{ascending:!0});if(g)throw console.error("getQuizByLessonId: Error fetching questions:",g),g;console.log("getQuizByLessonId: Raw questions data:",f?.length||0,"questions found"),f&&console.log("getQuizByLessonId: Questions sample:",f.slice(0,2).map(a=>({id:a.id,text:a.question_text?.substring(0,50)+"..."})));let h=[...f||[]].sort((a,b)=>a.order_index-b.order_index);console.log("getQuizByLessonId: Sorted questions count:",h.length);let i=[];for(let[a,b]of(console.log("getQuizByLessonId: Processing",h.length,"questions"),h.entries())){console.log(`getQuizByLessonId: Processing question ${a+1}/${h.length}:`,{id:b.id,text:b.question_text?.substring(0,50)+"..."});let{data:c,error:d}=await k.supabase.from("quiz_options").select("*").eq("question_id",b.id).order("order_index",{ascending:!0});if(d)throw console.error("getQuizByLessonId: Error fetching options for question:",b.id,d),d;console.log(`getQuizByLessonId: Question ${b.id} has ${c?.length||0} options`),i.push({...b,options:c||[]})}console.log("getQuizByLessonId: Built questionsWithOptions array with",i.length,"questions");let j={...b,questions:i};return console.log("getQuizByLessonId: Final result structure:",{quizId:j.id,lessonId:j.lesson_id,title:j.title,questionsCount:j.questions?.length||0,questionsSample:j.questions?.slice(0,2).map(a=>({id:a.id,text:a.question_text?.substring(0,50)+"...",optionsCount:a.options?.length||0}))}),j}catch(a){if(console.error("getQuizByLessonId: Unhandled error:",{name:a?.name||"UnknownError",message:a?.message||"Unknown error occurred",stack:a?.stack}),a?.name==="TypeError"&&a?.message?.includes("Failed to fetch"))if("undefined"==typeof navigator||navigator.onLine)throw Error("Network error: Unable to connect to database server");else throw Error("Network error: You appear to be offline");throw a}},m=async(a,b,c)=>{console.log("submitQuizAnswers: Submitting answers for user:",a,"lesson:",b);let d=await l(b);if(!d)throw Error("Quiz not found for this lesson");let{data:e,error:f}=await k.supabase.from("quiz_submissions").insert({user_id:a,lesson_id:b,score:0,total_questions:d.questions.length}).select("id").single();if(f)throw console.error("submitQuizAnswers: Error creating submission:",f),f;let g=0;for(let a of c){let b=d.questions.find(b=>b.id===a.question_id);if(!b)continue;let c=!1;if("multiple_choice"===b.question_type){if(a.selected_option_id){let d=b.options?.find(b=>b.id===a.selected_option_id);d?.is_correct&&(c=!0,g++)}}else"short_answer"===b.question_type&&a.answer_text&&a.answer_text.trim().length>0&&(c=!0,g++);let{error:f}=await k.supabase.from("quiz_answers").insert({submission_id:e.id,question_id:a.question_id,selected_option_id:a.selected_option_id,answer_text:a.answer_text,is_correct:c});if(f)throw console.error("submitQuizAnswers: Error saving answer:",f),f}let h=Math.round(g/d.questions.length*100),{error:i}=await k.supabase.from("quiz_submissions").update({score:h,completed_at:new Date().toISOString()}).eq("id",e.id);if(i)throw console.error("submitQuizAnswers: Error updating score:",i),i;return console.log("submitQuizAnswers: Successfully submitted answers for user:",a,"lesson:",b,"score:",h),{score:h,total:d.questions.length}},n=async(a,b)=>{console.log("getUserQuizSubmission: Fetching submission for user:",a,"lesson:",b);let{data:c,error:d}=await k.supabase.from("quiz_submissions").select("*").eq("user_id",a).eq("lesson_id",b).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(d)throw console.error("getUserQuizSubmission: Error fetching submission:",d),d;return c},o=async(a,b)=>{console.log("getQuizSubmissionByLessonId: Fetching submission for user:",a,"lesson:",b);let{data:c,error:d}=await k.supabase.from("quiz_submissions").select("*").eq("user_id",a).eq("lesson_id",b).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(d)throw console.error("getQuizSubmissionByLessonId: Error fetching submission:",d),d;return c},p=({question:a,onAnswer:d,selectedAnswer:e,isSubmitted:f})=>{let[g,h]=(0,c.useState)("string"==typeof e?e:"");return(0,b.jsxs)("div",{className:"mb-8 p-6 bg-card-bg rounded-lg border border-card-border",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,b.jsx)("div",{className:"flex-shrink-0 mt-1",children:(0,b.jsx)("div",{className:"w-6 h-6 rounded-full bg-accent-primary/20 flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-xs font-bold text-accent-primary",children:a.order_index+1})})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-medium text-white text-lg mb-3",children:a.question_text}),"multiple_choice"===a.question_type?(0,b.jsx)("div",{className:"space-y-3",children:a.options?.map(c=>(0,b.jsx)("div",{className:`p-3 rounded-lg border cursor-pointer transition-all ${f?c.is_correct?"border-green-500 bg-green-900/20":e===c.id&&!c.is_correct?"border-red-500 bg-red-900/20":"border-card-border":e===c.id?"border-accent-primary bg-accent-primary/10":"border-card-border hover:border-accent-primary/50"}`,onClick:()=>{var b;return b=c.id,void(!f&&d(a.id,b))},children:(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsxs)("div",{className:`w-4 h-4 rounded-full border mr-3 flex items-center justify-center ${f?c.is_correct?"border-green-500 bg-green-500":e===c.id&&!c.is_correct?"border-red-500 bg-red-500":"border-gray-500":e===c.id?"border-accent-primary bg-accent-primary":"border-gray-500"}`,children:[f&&c.is_correct&&(0,b.jsx)("svg",{className:"w-2 h-2 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),f&&e===c.id&&!c.is_correct&&(0,b.jsx)("svg",{className:"w-2 h-2 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),(0,b.jsx)("span",{className:f&&c.is_correct?"text-green-400":f&&e===c.id&&!c.is_correct?"text-red-400":"text-gray-300",children:c.option_text})]})},c.id))}):(0,b.jsxs)("div",{children:[(0,b.jsx)("textarea",{value:f?e??"":g,onChange:b=>{if(!f){let c=b.target.value;h(c),d(a.id,c)}},disabled:f,placeholder:"Type your answer here...",className:`w-full p-3 rounded-lg border bg-card-bg text-white ${f?"border-gray-600 bg-gray-800/50":"border-card-border focus:border-accent-primary focus:ring-1 focus:ring-accent-primary"}`,rows:4}),f&&e&&(0,b.jsx)("div",{className:"mt-2 text-sm text-green-400",children:"✓ Your answer has been recorded"})]})]})]}),f&&"multiple_choice"===a.question_type&&(0,b.jsx)("div",{className:"mt-3 text-sm",children:e&&"string"==typeof e&&!a.options?.some(a=>a.id===e)&&(0,b.jsx)("div",{className:"text-yellow-400",children:"You didn't select an answer for this question."})})]})},q=({lessonId:a,quiz:d,onComplete:f})=>{let{state:g}=(0,e.useAuthStore)(),h=g.user,[i,j]=(0,c.useState)({}),[k,l]=(0,c.useState)(!1),[o,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(!0);(0,c.useEffect)(()=>{(async()=>{if(h)try{let b=await n(h.id,a);b&&(q(b.score),l(!0))}catch(a){console.error("Error checking existing submission:",a)}finally{s(!1)}})()},[h,a]);let t=(a,b)=>{let c="string"==typeof b?b:b[0]??"";j(b=>({...b,[a]:c}))},u=async()=>{if(!h)return void alert("Please log in to submit the quiz");for(let a of d.questions)if(a.is_required&&!i[a.id])return void alert(`Please answer the required question: "${a.question_text}"`);try{let b=d.questions.map(a=>({question_id:a.id,..."multiple_choice"===a.question_type?{selected_option_id:i[a.id]}:{answer_text:i[a.id]}})),c=await m(h.id,a,b);q(c.score),l(!0);let e=c.score>=70;f&&f(e)}catch(a){console.error("Error submitting quiz:",a),alert("Error submitting quiz. Please try again.")}};return r?(0,b.jsx)("div",{className:"mt-8 p-6 bg-card-bg rounded-lg border border-card-border",children:(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("div",{className:"text-lg text-gray-400",children:"Loading quiz..."})})}):k?(0,b.jsxs)("div",{className:"mt-8 p-6 bg-card-bg rounded-lg border border-card-border",children:[(0,b.jsxs)("div",{className:"text-center mb-6",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-white mb-2",children:"Quiz Complete!"}),(0,b.jsxs)("div",{className:"text-3xl font-bold text-accent-primary mb-2",children:["Score: ",o,"%"]}),(0,b.jsx)("div",{className:"text-gray-400",children:"You've completed this lesson's quiz."})]}),(0,b.jsx)("div",{className:"space-y-6",children:d.questions.map(a=>(0,b.jsx)(p,{question:a,onAnswer:t,selectedAnswer:i[a.id]??"",isSubmitted:!0},a.id))})]}):(0,b.jsxs)("div",{className:"mt-8 p-6 bg-card-bg rounded-lg border border-card-border",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:d.title}),(0,b.jsx)("p",{className:"text-gray-400",children:d.description})]}),(0,b.jsx)("div",{className:"space-y-6",children:d.questions.map(a=>(0,b.jsx)(p,{question:a,onAnswer:t,selectedAnswer:i[a.id]??"",isSubmitted:!1},a.id))}),(0,b.jsxs)("div",{className:"mt-8 flex flex-col sm:flex-row gap-4 justify-center",children:[(0,b.jsx)("button",{onClick:u,className:"px-8 py-3 bg-accent-primary text-white font-bold rounded-lg hover:bg-accent-primary/90 transition-colors text-lg hover-lift border border-accent-primary",children:"Submit Quiz"}),(0,b.jsx)("button",{onClick:()=>{l(!1),q(null)},className:"px-8 py-3 bg-gray-700 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors text-lg hover-lift",children:"Retake Quiz"})]})]})},r=a=>{if(a&&"function"==typeof a.destroy)try{console.log("YT: destroying player"),a.destroy()}catch(a){console.warn("YT: Error destroying player:",a)}},s=async(a,b,c)=>{console.log("lessonReviewService.upsertLessonReview: user",a,"lesson",b,"input",c);let{data:d,error:e}=await k.supabase.from("lesson_reviews").upsert({user_id:a,lesson_id:b,rating:c.rating,comment:c.comment??null,is_anonymous:!!c.is_anonymous,updated_at:new Date().toISOString()},{onConflict:"lesson_id,user_id"}).select().single();if(e)throw console.error("lessonReviewService.upsertLessonReview: error",e),e;return console.log("lessonReviewService.upsertLessonReview: ok",d?.id),d},t=async(a,b)=>{console.log("lessonReviewService.getMyLessonReview: user",a,"lesson",b);let{data:c,error:d}=await k.supabase.from("lesson_reviews").select("*").eq("user_id",a).eq("lesson_id",b).maybeSingle();if(d)throw console.error("lessonReviewService.getMyLessonReview: error",d),d;return c},u=({lessonId:a})=>{let{state:d}=(0,e.useAuthStore)(),f=d.user,[g,h]=(0,c.useState)(0),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)("");(0,c.useEffect)(()=>{(async()=>{if(f)try{n(!0);let b=await t(f.id,a);b&&(p(b),h(b.rating),j(b.comment||""),l(!!b.is_anonymous))}catch(a){console.error("LessonReviewForm: failed to load existing review",a)}finally{n(!1)}})()},[f,a]);let u=async b=>{if(b.preventDefault(),f){if(g<1||g>5)return void r("Please choose a rating between 1 and 5.");try{n(!0),await s(f.id,a,{rating:g,comment:i,is_anonymous:k}),r(o?"Your feedback has been updated. Thank you!":"Thanks for your feedback — it helps us improve!"),p({rating:g,comment:i,is_anonymous:k}),console.log("LessonReviewForm: review submitted",{lessonId:a,rating:g,isAnonymous:k})}catch(a){console.error("LessonReviewForm: submission error",a),r(a?.message||"Something went wrong. Please try again.")}finally{n(!1)}}};return(0,b.jsxs)("div",{className:"mt-8 p-6 bg-card-bg rounded-lg border border-card-border",children:[(0,b.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"Help us improve this lesson"}),(0,b.jsx)("p",{className:"text-gray-400 mb-4",children:"Your feedback is private and only visible to the VibeSchool team."}),(0,b.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-gray-300 mb-2",children:"Rate this lesson"}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>h(a),className:`p-2 rounded ${g>=a?"text-yellow-400":"text-gray-500"} hover:text-yellow-300`,"aria-label":`Rate ${a} star${a>1?"s":""}`,children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6",children:(0,b.jsx)("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.46 4.73L5.82 21z"})})},a))}),(0,b.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:"Choose between 1 and 5 stars."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-gray-300 mb-2",children:"What did you like or find confusing?"}),(0,b.jsx)("textarea",{value:i,onChange:a=>j(a.target.value),rows:4,placeholder:"Optional",className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-md text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-accent-primary"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{id:"anonymous",type:"checkbox",checked:k,onChange:a=>l(a.target.checked),className:"h-4 w-4 text-accent-primary focus:ring-accent-primary border-gray-700 bg-gray-800"}),(0,b.jsx)("label",{htmlFor:"anonymous",className:"text-gray-300",children:"Submit anonymously"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("button",{type:"submit",disabled:m||0===g,className:`px-4 py-2 rounded font-medium transition-colors hover-lift border ${m||0===g?"bg-gray-700 text-gray-400 border-gray-700":"bg-accent-primary text-white hover:bg-accent-primary/90 border-accent-primary"}`,children:o?"Update Feedback":"Submit Feedback"}),q&&(0,b.jsx)("span",{className:"text-gray-300 text-sm",children:q})]})]})]})};a.s(["default",0,()=>{let{lessonId:a}=(0,d.useParams)(),{state:k}=(0,e.useAuthStore)(),m=k.user,[n,p]=(0,c.useState)(null),[s,t]=(0,c.useState)(!0),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)({completed:!1,last_position_seconds:0}),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!0),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(!0),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(!1),R=(0,c.useRef)(null),S=(0,c.useRef)(null),[T,U]=(0,c.useState)(null),V=(0,c.useCallback)(a=>{console.log("YT DEBUG: playerElRef called with node:",!!a),U(a)},[]);(0,c.useEffect)(()=>{m&&a&&W()},[m,a]);let W=async()=>{try{t(!0);let b=await (0,i.checkLessonAccess)(m.id,a);if(E(b.hasAccess),G(!1),!b.hasAccess)return void w("You do not have access to this lesson. Please upgrade to a membership or access a preview lesson.");let c=await (0,i.getLessonById)(a);p(c);let d=await (0,j.getUserLessonProgress)(m.id,a);y(d);try{let b=await l(a);if(K(b),b){let b=await o(m.id,a);b&&(O(b),b.score>=70&&Q(!0))}}catch(a){console.error("Error loading quiz:",a)}finally{M(!1)}}catch(a){console.error("Error loading lesson:",a),w(a.message||"Failed to load lesson"),M(!1)}finally{t(!1)}},X=!!(n&&("youtube"===n.video_provider&&n.youtube_video_id||n.video_url&&(n.video_url.includes("youtube.com")||n.video_url.includes("youtu.be"))));(0,c.useEffect)(()=>{if(console.log("YT DEBUG: useEffect triggered, lesson:",!!n,"hasVideo:",X,"playerEl:",!!T),!n)return;let a=n.youtube_video_id;if(!a&&n.video_url){let b=n.video_url.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&\?\s]{11})/);b&&(a=b[1])}if(!a)return void console.log("YT DEBUG: No video ID found");if(!T)return void console.log("YT DEBUG: No player element, waiting for mount");console.log("YT DEBUG: Initializing player with video:",a);let b=!1;return(async()=>{if(!b)try{if(console.log("YT: loading API for video:",a),await function(a=15e3){return Promise.resolve()}(),b||!T)return;console.log("YT: creating player for video:",a),R.current&&r(R.current),R.current=new window.YT.Player(T,{videoId:a,width:"100%",height:"100%",playerVars:{autoplay:0,playsinline:1,modestbranding:1,rel:0,start:0},events:{onReady:a=>{console.log("YT: onReady fired"),b||(R.current=a.target,A(!0),setTimeout(()=>{x.last_position_seconds>0&&!b&&a.target.seekTo(x.last_position_seconds,!0)},1e3))},onStateChange:a=>{!b&&(a.data===window.YT.PlayerState.PLAYING?C(!0):(a.data===window.YT.PlayerState.PAUSED||a.data===window.YT.PlayerState.ENDED)&&(C(!1),a.data!==window.YT.PlayerState.ENDED||x.completed||Y()))},onError:a=>{console.error("YT: Player error:",a),b||w(`Video player error: ${a?.data||"Unknown error"}`)}}})}catch(a){console.error("YT: Failed to initialize player:",a),b||(w(`Failed to load video player: ${a?.message||"Unknown error"}`),A(!1))}})(),()=>{b=!0,R.current&&(r(R.current),R.current=null),A(!1)}},[n?.id,n?.youtube_video_id,T,x.last_position_seconds]),(0,c.useEffect)(()=>(B&&R.current&&(S.current&&clearInterval(S.current),S.current=setInterval(async()=>{try{let b=R.current?.getCurrentTime();void 0!==b&&await (0,j.updateUserLessonProgress)(m.id,a,{last_position_seconds:Math.floor(b)})}catch(a){console.error("Error updating progress:",a)}},5e3)),()=>{S.current&&clearInterval(S.current)}),[B,m,a]);let Y=async()=>{try{await (0,j.updateUserLessonProgress)(m.id,a,{completed:!0,completed_at:new Date().toISOString()}),y(a=>({...a,completed:!0}))}catch(a){console.error("Error marking lesson as complete:",a)}},Z=async()=>{if(n&&m)try{let a=n.modules?.course_id;if(!a)return void console.error("Could not find course ID for lesson");let b=await (0,j.getNextLesson)(m.id,a);b?window.location.href=`/learn/${b.id}`:(alert("Congratulations! You have completed all lessons in this course."),window.location.href=`/courses/${a}`)}catch(b){console.error("Error getting next lesson:",b);let a=n.modules?.course_id;a&&(window.location.href=`/courses/${a}`)}};return s||F?(0,b.jsx)(g.default,{children:(0,b.jsx)(h.default,{children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsx)("p",{className:"text-gray-400",children:"Loading lesson..."})})})}):v?(0,b.jsx)(g.default,{children:(0,b.jsx)(h.default,{children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"bg-red-900/20 border border-red-700 rounded-lg p-4",children:[(0,b.jsx)("h2",{className:"text-red-300 font-bold mb-2",children:"Error Loading Lesson"}),(0,b.jsx)("p",{className:"text-red-400",children:v}),(0,b.jsx)("button",{onClick:()=>window.history.back(),className:"mt-4 px-4 py-2 bg-red-700 text-white rounded hover:bg-red-600 hover-lift",children:"Go Back"})]})})})}):D?(0,b.jsx)(g.default,{children:(0,b.jsx)(h.default,{children:(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-white",children:n?.title}),(0,b.jsxs)("p",{className:"text-gray-400",children:[n?.modules?.courses?.title," • ",n?.modules?.title]})]}),(0,b.jsx)("div",{className:"mb-6 bg-blue-900/20 border border-blue-700 rounded-lg p-4",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,b.jsx)("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-blue-300 font-medium",children:"Video Loading Tip"}),(0,b.jsx)("p",{className:"text-blue-400 text-sm mt-1",children:"If the video doesn't load, please refresh the page. Some videos may take a moment to load or require a page refresh to display properly."})]})]})}),(0,b.jsxs)("div",{className:"bg-black rounded-lg overflow-hidden mb-6 relative",children:[(0,b.jsx)("div",{ref:V,"data-yt-container":!0,className:"w-full aspect-video rounded-lg overflow-hidden bg-black"}),!z&&X&&(0,b.jsx)("div",{className:"absolute inset-0 bg-black/80 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-primary mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-white",children:"Loading video player..."})]})}),!X&&(0,b.jsx)("div",{className:"absolute inset-0 w-full aspect-video bg-gray-900 flex items-center justify-center text-gray-400",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{children:"Video not configured"}),(0,b.jsxs)("p",{className:"text-sm mt-2",children:["Lesson ID: ",n?.id]}),(0,b.jsxs)("p",{className:"text-xs mt-1",children:["Video provider: ",n?.video_provider]}),(0,b.jsxs)("p",{className:"text-xs mt-1",children:["YouTube ID: ",n?.youtube_video_id]}),(0,b.jsxs)("p",{className:"text-xs mt-1",children:["Video URL: ",n?.video_url]})]})}),!1,(0,b.jsxs)("div",{className:"p-4 bg-gray-900 flex justify-between items-center",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("button",{onClick:()=>{R.current&&(R.current.seekTo(0,!0),R.current.playVideo())},className:"flex items-center gap-2 px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 hover-lift",children:[(0,b.jsx)(f,{size:16}),"Restart"]}),(0,b.jsx)("div",{className:"text-sm text-gray-300",children:x.completed?(0,b.jsx)("span",{className:"text-green-500",children:"✓ Completed"}):(0,b.jsxs)("span",{children:["Resume from ",Math.floor(x.last_position_seconds/60),":",String(Math.floor(x.last_position_seconds%60)).padStart(2,"0")]})})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:Y,disabled:x.completed,className:`px-4 py-2 rounded hover-lift ${x.completed?"bg-green-800 text-green-300":"bg-accent-primary text-white hover:bg-accent-primary/90 border border-accent-primary"}`,children:x.completed?"✓ Completed":"Mark as Complete"}),J&&!P&&(0,b.jsx)("button",{onClick:()=>{let a=document.querySelector("#quiz-section");a&&a.scrollIntoView({behavior:"smooth"})},className:"px-4 py-2 rounded hover-lift bg-purple-600 text-white hover:bg-purple-500",children:"Take Quiz"}),P&&(0,b.jsx)("button",{onClick:Z,className:"px-4 py-2 rounded hover-lift bg-blue-600 text-white hover:bg-blue-500",children:"Next Lesson →"})]})]})]}),(0,b.jsx)("div",{className:"prose prose-invert max-w-none",children:(0,b.jsx)("p",{className:"text-gray-300",children:n?.description})}),(0,b.jsx)(u,{lessonId:a}),!L&&J&&(0,b.jsxs)("div",{id:"quiz-section",children:[(0,b.jsx)(q,{lessonId:a,quiz:J,onComplete:a=>{Q(a),a&&Y()}}),!P&&(0,b.jsx)("div",{className:"mt-4 p-4 bg-yellow-900/20 border border-yellow-700 rounded-lg",children:(0,b.jsx)("p",{className:"text-yellow-300",children:"⚠️ Complete the quiz to unlock the next lesson."})})]}),L&&(0,b.jsx)("div",{className:"mt-8 p-6 bg-card-bg rounded-lg border border-card-border",children:(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("div",{className:"text-lg text-gray-400",children:"Loading quiz..."})})})]})})}):(0,b.jsx)(g.default,{children:(0,b.jsx)(h.default,{children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"bg-yellow-900/20 border border-yellow-700 rounded-lg p-4",children:[(0,b.jsx)("h2",{className:"text-yellow-300 font-bold mb-2",children:"Access Restricted"}),(0,b.jsx)("p",{className:"text-yellow-400",children:"You need a membership to access this lesson."}),(0,b.jsx)("p",{className:"text-yellow-400 mt-2",children:"Preview lessons are available for free, but full content requires a membership."}),(0,b.jsx)("button",{onClick:()=>window.location.href="/courses",className:"mt-4 px-4 py-2 bg-accent-primary text-white rounded hover:bg-accent-primary/90 hover-lift border border-accent-primary",children:"Browse Courses"})]})})})})}],28571)}];

//# sourceMappingURL=src_app_learn_%5BlessonId%5D_page_tsx_8a274d25._.js.map