{"version":3,"sources":["../../../../src/app/friendreq-test/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useAuthStore } from '@/context/AuthContext';\r\nimport { getCommunityDB } from '@/community/db';\r\n\r\nconst FriendRequestTestPage = () => {\r\n  const { state } = useAuthStore();\r\n  const user = state.user;\r\n  const [toUserId, setToUserId] = useState('');\r\n  const [response, setResponse] = useState<string>('');\r\n  const [requests, setRequests] = useState<any>(null);\r\n  const [friends, setFriends] = useState<any>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [db, setDb] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n    const init = async () => {\r\n      const communityDb = await getCommunityDB();\r\n      setDb(communityDb);\r\n    };\r\n    init();\r\n  }, []);\r\n\r\n  const handleSendRequest = async () => {\r\n    if (!toUserId || !user) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      console.log(\"[FRIENDREQ] send to\", toUserId);\r\n      \r\n      const response = await fetch('/api/friends/requests', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ toUserId })\r\n      });\r\n      \r\n      const data = await response.json();\r\n      console.log(\"[FRIENDREQ] response\", response.status, data);\r\n      \r\n      setResponse(JSON.stringify(data, null, 2));\r\n    } catch (error) {\r\n      console.error('[FRIENDREQ] Error sending friend request:', error);\r\n      setResponse(`Error: ${error}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleGetRequests = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await fetch('/api/friends/requests');\r\n      const data = await response.json();\r\n      setRequests(data);\r\n      setResponse(JSON.stringify(data, null, 2));\r\n    } catch (error) {\r\n      console.error('[FRIENDREQ] Error getting requests:', error);\r\n      setResponse(`Error: ${error}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleGetFriends = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await fetch('/api/friends');\r\n      const data = await response.json();\r\n      setFriends(data);\r\n      setResponse(JSON.stringify(data, null, 2));\r\n    } catch (error) {\r\n      console.error('[FRIENDREQ] Error getting friends:', error);\r\n      setResponse(`Error: ${error}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-900 text-white p-8\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        <h1 className=\"text-3xl font-bold mb-8 text-center\">Friend Request Test Page</h1>\r\n        \r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n          <div className=\"bg-gray-800 p-6 rounded-lg\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">User Info</h2>\r\n            <div className=\"mb-4\">\r\n              <p className=\"text-gray-300\"><strong>Current User ID:</strong> {user?.id || 'Not logged in'}</p>\r\n              <p className=\"text-gray-300\"><strong>Current Username:</strong> {user?.username || 'Not logged in'}</p>\r\n            </div>\r\n            \r\n            <div className=\"mb-6\">\r\n              <label className=\"block text-gray-300 mb-2\">To User ID:</label>\r\n              <input\r\n                type=\"text\"\r\n                value={toUserId}\r\n                onChange={(e) => setToUserId(e.target.value)}\r\n                placeholder=\"Enter user ID to send request to\"\r\n                className=\"w-full bg-gray-700 text-white rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-accent-primary\"\r\n              />\r\n            </div>\r\n            \r\n            <button\r\n              onClick={handleSendRequest}\r\n              disabled={loading || !toUserId || !user}\r\n              className=\"w-full py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 disabled:opacity-50 border border-accent-primary\"\r\n            >\r\n              {loading ? 'Sending...' : 'SEND REQUEST'}\r\n            </button>\r\n          </div>\r\n          \r\n          <div className=\"bg-gray-800 p-6 rounded-lg\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">Actions</h2>\r\n            <div className=\"space-y-3\">\r\n              <button\r\n                onClick={handleGetRequests}\r\n                disabled={loading}\r\n                className=\"w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-500 disabled:opacity-50\"\r\n              >\r\n                GET REQUESTS\r\n              </button>\r\n              <button\r\n                onClick={handleGetFriends}\r\n                disabled={loading}\r\n                className=\"w-full py-2 bg-green-600 text-white rounded-lg hover:bg-green-500 disabled:opacity-50\"\r\n              >\r\n                GET FRIENDS\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"mt-6\">\r\n              <h3 className=\"text-lg font-medium mb-2\">Last Response:</h3>\r\n              <pre className=\"bg-gray-900 p-4 rounded text-sm overflow-auto max-h-60\">\r\n                {response || 'No response yet'}\r\n              </pre>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        {requests && (\r\n          <div className=\"mt-8 bg-gray-800 p-6 rounded-lg\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">Recent Requests</h2>\r\n            <div className=\"overflow-auto\">\r\n              <pre className=\"text-sm\">\r\n                {JSON.stringify(requests, null, 2)}\r\n              </pre>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {friends && (\r\n          <div className=\"mt-8 bg-gray-800 p-6 rounded-lg\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">Friends List</h2>\r\n            <div className=\"overflow-auto\">\r\n              <pre className=\"text-sm\">\r\n                {JSON.stringify(friends, null, 2)}\r\n              </pre>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FriendRequestTestPage;"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,wBAE8B,KAC5B,GAAM,OAAE,CAAK,CAAE,CAAG,CAAA,EAAA,EAAA,YAAY,AAAZ,IACZ,EAAO,EAAM,IAAI,CACjB,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACnC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,IAC3C,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAM,MACxC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAM,MACtC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAI,EAAM,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAM,MAElC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAKR,CAJa,UAEX,EADoB,IACd,EADoB,CAAA,EAAA,EAAA,cAAA,AAAc,KAE1C,GAEF,EAAG,EAAE,EAEL,IAAM,EAAoB,UACxB,GAAI,AAAC,GAAa,EAElB,GAAI,CAFoB,AAGtB,GAHe,AAGJ,GACX,QAAQ,GAAG,CAAC,sBAAuB,GAEnC,IAAM,EAAW,MAAM,MAAM,wBAAyB,CACpD,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,UAAE,CAAS,EAClC,GAEM,EAAO,MAAM,EAAS,IAAI,GAChC,QAAQ,GAAG,CAAC,uBAAwB,EAAS,MAAM,CAAE,GAErD,EAAY,KAAK,SAAS,CAAC,EAAM,KAAM,GACzC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,4CAA6C,GAC3D,EAAY,CAAC,OAAO,EAAE,EAAA,CAAO,CAC/B,QAAU,CACR,GAAW,EACb,CACF,EAEM,EAAoB,UACxB,GAAI,CACF,GAAW,GACX,IAAM,EAAW,MAAM,MAAM,yBACvB,EAAO,MAAM,EAAS,IAAI,GAChC,EAAY,GACZ,EAAY,KAAK,SAAS,CAAC,EAAM,KAAM,GACzC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,sCAAuC,GACrD,EAAY,CAAC,OAAO,EAAE,EAAA,CAAO,CAC/B,QAAU,CACR,GAAW,EACb,CACF,EAEM,EAAmB,UACvB,GAAI,CACF,GAAW,GACX,IAAM,EAAW,MAAM,MAAM,gBACvB,EAAO,MAAM,EAAS,IAAI,GAChC,EAAW,GACX,EAAY,KAAK,SAAS,CAAC,EAAM,KAAM,GACzC,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,qCAAsC,GACpD,EAAY,CAAC,OAAO,EAAE,EAAA,CAAO,CAC/B,QAAU,CACR,GAAW,EACb,CACF,EAEA,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8BACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,+CAAsC,6BAEpD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uCACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sCAA6B,cAC3C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,0BAAgB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,qBAAyB,IAAE,GAAM,IAAM,mBAC5E,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,0BAAgB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,sBAA0B,IAAE,GAAM,UAAY,sBAGrF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,oCAA2B,gBAC5C,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,MAAO,EACP,SAAU,AAAC,GAAM,EAAY,EAAE,MAAM,CAAC,KAAK,EAC3C,YAAY,mCACZ,UAAU,8GAId,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,SAAU,GAAW,CAAC,GAAY,CAAC,EACnC,UAAU,2IAET,EAAU,aAAe,oBAI9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uCACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sCAA6B,YAC3C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,SAAU,EACV,UAAU,+FACX,iBAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,SAAU,EACV,UAAU,iGACX,mBAKH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oCAA2B,mBACzC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kEACZ,GAAY,6BAMpB,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4CACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sCAA6B,oBAC3C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mBACZ,KAAK,SAAS,CAAC,EAAU,KAAM,UAMvC,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4CACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sCAA6B,iBAC3C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mBACZ,KAAK,SAAS,CAAC,EAAS,KAAM,cAQ/C"}